<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "b59b477037dc1dd6b1740a0420f3be14",
  "translation_date": "2025-07-16T23:05:41+00:00",
  "source_file": "02-Security/mcp-security-controls-2025.md",
  "language_code": "ja"
}
-->
# 最新のMCPセキュリティコントロール - 2025年7月アップデート

Model Context Protocol（MCP）が進化を続ける中、セキュリティは依然として重要な課題です。本書では、2025年7月時点でのMCPを安全に実装するための最新のセキュリティコントロールとベストプラクティスをまとめています。

## 認証と認可

### OAuth 2.0の委任サポート

MCP仕様の最近の更新により、MCPサーバーはMicrosoft Entra IDなどの外部サービスにユーザー認証を委任できるようになりました。これにより、セキュリティ体制が大幅に向上します。

1. **カスタム認証実装の排除**：カスタム認証コードのセキュリティ欠陥リスクを低減
2. **確立されたIDプロバイダーの活用**：エンタープライズレベルのセキュリティ機能を享受
3. **アイデンティティ管理の集中化**：ユーザーライフサイクル管理とアクセス制御を簡素化


## トークンパススルーの防止

MCP Authorization Specificationでは、セキュリティコントロールの回避や責任問題を防ぐため、トークンのパススルーを明確に禁止しています。

### 主要要件

1. **MCPサーバーは自分たちに発行されていないトークンを受け入れてはならない**：すべてのトークンが正しいaudienceクレームを持っていることを検証する
2. **適切なトークン検証を実施する**：issuer、audience、有効期限、署名をチェック
3. **別のトークン発行を利用する**：既存のトークンをパススルーするのではなく、下流サービス向けに新しいトークンを発行する

## セキュアなセッション管理

セッションハイジャックやセッションフィクセーション攻撃を防ぐため、以下のコントロールを実装してください。

1. **安全で非決定論的なセッションIDを使用する**：暗号学的に安全な乱数生成器で生成
2. **セッションをユーザーのアイデンティティに紐づける**：セッションIDとユーザー固有情報を組み合わせる
3. **適切なセッションローテーションを実施する**：認証変更や権限昇格後に更新
4. **適切なセッションタイムアウトを設定する**：セキュリティとユーザー体験のバランスを考慮


## ツール実行のサンドボックス化

横方向の移動を防ぎ、潜在的な侵害を封じ込めるために：

1. **ツール実行環境を分離する**：コンテナや別プロセスを利用
2. **リソース制限を適用する**：リソース枯渇攻撃を防止
3. **最小権限アクセスを実装する**：必要最低限の権限のみ付与
4. **実行パターンを監視する**：異常な挙動を検知

## ツール定義の保護

ツールの改ざんを防ぐために：

1. **使用前にツール定義を検証する**：悪意のある命令や不適切なパターンをチェック
2. **整合性検証を利用する**：ツール定義のハッシュ化や署名で不正変更を検出
3. **変更監視を実装する**：予期しないメタデータの変更をアラート
4. **ツール定義のバージョン管理を行う**：変更履歴を追跡し、必要に応じてロールバック可能にする

これらのコントロールは連携して、AI駆動システム特有の課題に対応しつつ、従来の強固なセキュリティ慣行を維持するMCP実装の堅牢なセキュリティ体制を構築します。

**免責事項**：  
本書類はAI翻訳サービス「[Co-op Translator](https://github.com/Azure/co-op-translator)」を使用して翻訳されました。正確性には努めておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。原文の言語によるオリジナル文書が正式な情報源とみなされるべきです。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の利用により生じたいかなる誤解や誤訳についても、当方は一切の責任を負いかねます。
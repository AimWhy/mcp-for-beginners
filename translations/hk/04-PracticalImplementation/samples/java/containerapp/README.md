<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "e5ea5e7582f70008ea9bec3b3820f20a",
  "translation_date": "2025-05-17T14:23:01+00:00",
  "source_file": "04-PracticalImplementation/samples/java/containerapp/README.md",
  "language_code": "hk"
}
-->
## 系統架構

呢個項目示範咗一個網頁應用程式，係將用戶嘅提示傳送到計算器服務之前，會用內容安全檢查。

![系統架構圖](../../../../../../translated_images/plant.84b061907411570c4d69e747b3f5569a0783a9b3e7b81a8e0ffee5a0a459f312.hk.png)

### 運作方式

1. **用戶輸入**：用戶喺網頁介面入一個計算提示
2. **內容安全篩選（輸入）**：提示會由 Azure 內容安全 API 分析
3. **安全決策（輸入）**：
   - 如果內容安全（所有類別嘅嚴重程度 < 2），就會傳送到計算器
   - 如果內容被標記為潛在有害，過程會停止並返回警告
4. **計算器整合**：安全嘅內容會由 LangChain4j 處理，並與 MCP 計算器伺服器通訊
5. **內容安全篩選（輸出）**：機械人嘅回應會由 Azure 內容安全 API 分析
6. **安全決策（輸出）**：
   - 如果機械人回應安全，就會顯示畀用戶睇
   - 如果機械人回應被標記為潛在有害，就會被警告取代
7. **回應**：結果（如果安全）會連同兩個安全分析一齊顯示畀用戶

## 使用 Model Context Protocol (MCP) 與計算器服務

呢個項目示範咗點樣用 Model Context Protocol (MCP) 從 LangChain4j 呼叫計算器 MCP 服務。實現使用咗一個本地 MCP 伺服器喺 8080 埠運行提供計算器操作。

### 設置 Azure 內容安全服務

喺使用內容安全功能之前，你需要創建一個 Azure 內容安全服務資源：

1. 登入 [Azure Portal](https://portal.azure.com)
2. 點擊「創建資源」並搜索「內容安全」
3. 選擇「內容安全」並點擊「創建」
4. 輸入一個獨特嘅資源名稱
5. 選擇訂閱和資源組（或者創建一個新嘅）
6. 選擇支持嘅地區（查看[地區可用性](https://azure.microsoft.com/en-us/global-infrastructure/services/?products=cognitive-services)獲取詳情）
7. 選擇合適嘅定價層
8. 點擊「創建」部署資源
9. 部署完成後，點擊「前往資源」
10. 喺左側窗格，喺「資源管理」下，選擇「密鑰和端點」
11. 複製任意一個密鑰和端點 URL 用於下一步

### 配置環境變量

設置 `GITHUB_TOKEN` 環境變量用於 GitHub 模型身份驗證：
```sh
export GITHUB_TOKEN=<your_github_token>
```

對於內容安全功能，設置：
```sh
export CONTENT_SAFETY_ENDPOINT=<your_content_safety_endpoint>
export CONTENT_SAFETY_KEY=<your_content_safety_key>
```

呢啲環境變量會被應用程序用嚟同 Azure 內容安全服務進行身份驗證。如果冇設置呢啲變量，應用程序會用占位符值進行演示，但內容安全功能唔會正常運作。

### 啟動計算器 MCP 伺服器

喺運行客戶端之前，你需要喺 localhost:8080 以 SSE 模式啟動計算器 MCP 伺服器。

## 項目描述

呢個項目示範咗 Model Context Protocol (MCP) 與 LangChain4j 整合來呼叫計算器服務。主要功能包括：

- 使用 MCP 連接計算器服務進行基本數學運算
- 用戶提示同機械人回應雙層內容安全檢查
- 通過 LangChain4j 與 GitHub 嘅 gpt-4.1-nano 模型整合
- 使用伺服器發送事件 (SSE) 作為 MCP 傳輸

## 內容安全整合

項目包括全面嘅內容安全功能，確保用戶輸入同系統回應都冇有害內容：

1. **輸入篩選**：所有用戶提示喺處理之前會被分析是否有有害內容類別，如仇恨言論、暴力、自殘和色情內容。

2. **輸出篩選**：即使使用潛在未經審核嘅模型，系統會喺顯示之前檢查所有生成回應是否通過相同內容安全過濾。

呢個雙層方法確保無論使用邊個 AI 模型，系統都保持安全，保護用戶免受有害輸入同潛在問題嘅 AI 生成輸出。

## 網頁客戶端

應用程序包括一個用戶友好嘅網頁介面，允許用戶與內容安全計算器系統互動：

### 網頁介面功能

- 簡單直觀嘅表單用嚟輸入計算提示
- 雙層內容安全驗證（輸入同輸出）
- 實時提示同回應安全性反饋
- 易於解釋嘅色碼安全指標
- 干淨、響應式設計，適用於多種設備
- 提供安全提示示例以指導用戶

### 使用網頁客戶端

1. 啟動應用程序：
   ```sh
   mvn spring-boot:run
   ```

2. 打開瀏覽器並導航到 `http://localhost:8087`

3. 喺提供嘅文本區域輸入一個計算提示（例如，「計算 24.5 同 17.3 嘅和」）

4. 點擊「提交」處理請求

5. 查看結果，會包括：
   - 您嘅提示內容安全分析
   - 計算結果（如果提示安全）
   - 機械人回應內容安全分析
   - 如果輸入或輸出被標記，則有任何安全警告

網頁客戶端會自動處理兩個內容安全驗證過程，確保所有互動都係安全同合適，無論使用邊個 AI 模型。

**免責聲明**：
本文件是使用 AI 翻譯服務 [Co-op Translator](https://github.com/Azure/co-op-translator) 翻譯的。儘管我們力求準確，但請注意，自動翻譯可能包含錯誤或不準確之處。應將原始文件的母語版本視為權威來源。對於關鍵信息，建議使用專業人工翻譯。我們不對因使用此翻譯而引起的任何誤解或誤譯負責。
<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "7919ce2e537f0c435c7c23fa6775b613",
  "translation_date": "2025-06-11T17:59:07+00:00",
  "source_file": "04-PracticalImplementation/README.md",
  "language_code": "fa"
}
-->
# پیاده‌سازی عملی

پیاده‌سازی عملی جایی است که قدرت Model Context Protocol (MCP) به صورت ملموس دیده می‌شود. در حالی که درک نظریه و معماری پشت MCP اهمیت دارد، ارزش واقعی زمانی نمایان می‌شود که این مفاهیم را برای ساخت، آزمایش و استقرار راه‌حل‌هایی که مشکلات دنیای واقعی را حل می‌کنند، به کار ببرید. این فصل فاصله بین دانش مفهومی و توسعه عملی را پر می‌کند و شما را در فرآیند زنده کردن برنامه‌های مبتنی بر MCP راهنمایی می‌کند.

چه در حال توسعه دستیارهای هوشمند باشید، چه ادغام هوش مصنوعی در جریان‌های کاری کسب‌وکار، یا ساخت ابزارهای سفارشی برای پردازش داده، MCP پایه‌ای انعطاف‌پذیر فراهم می‌کند. طراحی مستقل از زبان و SDKهای رسمی برای زبان‌های برنامه‌نویسی محبوب، آن را برای طیف گسترده‌ای از توسعه‌دهندگان در دسترس می‌سازد. با استفاده از این SDKها، می‌توانید به سرعت نمونه اولیه بسازید، تکرار کنید و راه‌حل‌های خود را در پلتفرم‌ها و محیط‌های مختلف مقیاس دهید.

در بخش‌های بعدی، نمونه‌های عملی، کد نمونه و استراتژی‌های استقرار را خواهید یافت که نشان می‌دهند چگونه MCP را در C#، Java، TypeScript، JavaScript و Python پیاده‌سازی کنید. همچنین خواهید آموخت چگونه سرورهای MCP خود را اشکال‌زدایی و آزمایش کنید، APIها را مدیریت کنید و راه‌حل‌ها را با استفاده از Azure به ابر منتقل نمایید. این منابع عملی برای تسریع یادگیری شما و کمک به ساخت برنامه‌های MCP مقاوم و آماده تولید طراحی شده‌اند.

## مرور کلی

این درس بر جنبه‌های عملی پیاده‌سازی MCP در زبان‌های برنامه‌نویسی مختلف تمرکز دارد. ما بررسی می‌کنیم چگونه از SDKهای MCP در C#، Java، TypeScript، JavaScript و Python برای ساخت برنامه‌های مقاوم، اشکال‌زدایی و آزمایش سرورهای MCP و ایجاد منابع، پرامپت‌ها و ابزارهای قابل استفاده مجدد استفاده کنیم.

## اهداف یادگیری

تا پایان این درس، قادر خواهید بود:
- راه‌حل‌های MCP را با استفاده از SDKهای رسمی در زبان‌های برنامه‌نویسی مختلف پیاده‌سازی کنید
- سرورهای MCP را به صورت سیستماتیک اشکال‌زدایی و آزمایش کنید
- ویژگی‌های سرور (منابع، پرامپت‌ها و ابزارها) را ایجاد و استفاده کنید
- جریان‌های کاری موثر MCP را برای وظایف پیچیده طراحی کنید
- پیاده‌سازی‌های MCP را برای عملکرد و قابلیت اطمینان بهینه کنید

## منابع SDK رسمی

Model Context Protocol SDKهای رسمی برای چند زبان ارائه می‌دهد:

- [C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)
- [Java SDK](https://github.com/modelcontextprotocol/java-sdk)
- [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [Kotlin SDK](https://github.com/modelcontextprotocol/kotlin-sdk)

## کار با SDKهای MCP

این بخش نمونه‌های عملی از پیاده‌سازی MCP در زبان‌های برنامه‌نویسی مختلف را ارائه می‌دهد. می‌توانید کد نمونه را در پوشه `samples` به تفکیک زبان بیابید.

### نمونه‌های موجود

مخزن شامل نمونه‌های پیاده‌سازی در زبان‌های زیر است:

- C#
- Java
- TypeScript
- JavaScript
- Python

هر نمونه مفاهیم کلیدی MCP و الگوهای پیاده‌سازی مربوط به زبان و اکوسیستم خاص را نشان می‌دهد.

## ویژگی‌های اصلی سرور

سرورهای MCP می‌توانند هر ترکیبی از این ویژگی‌ها را پیاده‌سازی کنند:

### منابع
منابع زمینه و داده‌هایی را برای استفاده کاربر یا مدل هوش مصنوعی فراهم می‌کنند:
- مخازن اسناد
- پایگاه‌های دانش
- منابع داده ساختاریافته
- سیستم‌های فایل

### پرامپت‌ها
پرامپت‌ها پیام‌ها و جریان‌های کاری قالب‌بندی شده برای کاربران هستند:
- قالب‌های مکالمه از پیش تعریف شده
- الگوهای تعامل هدایت شده
- ساختارهای گفتگوی تخصصی

### ابزارها
ابزارها توابعی هستند که مدل هوش مصنوعی می‌تواند اجرا کند:
- ابزارهای پردازش داده
- ادغام‌های API خارجی
- قابلیت‌های محاسباتی
- عملکرد جستجو

## نمونه پیاده‌سازی: C#

مخزن رسمی C# SDK چندین نمونه پیاده‌سازی ارائه می‌دهد که جنبه‌های مختلف MCP را نشان می‌دهد:

- **کلاینت پایه MCP**: مثال ساده‌ای که نشان می‌دهد چگونه یک کلاینت MCP بسازید و ابزارها را فراخوانی کنید
- **سرور پایه MCP**: پیاده‌سازی سرور حداقلی با ثبت ابزارهای پایه
- **سرور پیشرفته MCP**: سرور کامل با ثبت ابزار، احراز هویت و مدیریت خطا
- **ادغام ASP.NET**: نمونه‌هایی که ادغام با ASP.NET Core را نشان می‌دهند
- **الگوهای پیاده‌سازی ابزار**: الگوهای مختلف برای پیاده‌سازی ابزارها با سطوح پیچیدگی متفاوت

SDK C# MCP در حالت پیش‌نمایش است و ممکن است APIها تغییر کنند. ما این بلاگ را همگام با پیشرفت SDK به‌روزرسانی خواهیم کرد.

### ویژگی‌های کلیدی
- [C# MCP Nuget ModelContextProtocol](https://www.nuget.org/packages/ModelContextProtocol)

- ساخت [اولین سرور MCP خود](https://devblogs.microsoft.com/dotnet/build-a-model-context-protocol-mcp-server-in-csharp/).

برای نمونه‌های کامل پیاده‌سازی C# به [مخزن نمونه‌های رسمی C# SDK](https://github.com/modelcontextprotocol/csharp-sdk) مراجعه کنید.

## نمونه پیاده‌سازی: Java

Java SDK گزینه‌های قدرتمند پیاده‌سازی MCP با ویژگی‌های سازمانی فراهم می‌کند.

### ویژگی‌های کلیدی

- ادغام با Spring Framework
- ایمنی نوع قوی
- پشتیبانی از برنامه‌نویسی واکنشی
- مدیریت جامع خطا

برای نمونه کامل پیاده‌سازی Java به [MCPSample.java](../../../04-PracticalImplementation/samples/java/MCPSample.java) در پوشه نمونه‌ها مراجعه کنید.

## نمونه پیاده‌سازی: JavaScript

JavaScript SDK رویکردی سبک و انعطاف‌پذیر برای پیاده‌سازی MCP ارائه می‌دهد.

### ویژگی‌های کلیدی

- پشتیبانی از Node.js و مرورگر
- API مبتنی بر Promise
- ادغام آسان با Express و سایر فریم‌ورک‌ها
- پشتیبانی از WebSocket برای استریمینگ

برای نمونه کامل پیاده‌سازی JavaScript به [mcp_sample.js](../../../04-PracticalImplementation/samples/javascript/mcp_sample.js) در پوشه نمونه‌ها مراجعه کنید.

## نمونه پیاده‌سازی: Python

Python SDK رویکردی پایتونیک برای پیاده‌سازی MCP با ادغام‌های عالی چارچوب‌های یادگیری ماشین ارائه می‌دهد.

### ویژگی‌های کلیدی

- پشتیبانی از async/await با asyncio
- ادغام با Flask و FastAPI
- ثبت ابزار ساده
- ادغام بومی با کتابخانه‌های محبوب ML

برای نمونه کامل پیاده‌سازی Python به [mcp_sample.py](../../../04-PracticalImplementation/samples/python/mcp_sample.py) در پوشه نمونه‌ها مراجعه کنید.

## مدیریت API

Azure API Management پاسخ مناسبی برای امنیت سرورهای MCP است. ایده این است که یک نمونه Azure API Management را جلوی سرور MCP خود قرار دهید و اجازه دهید ویژگی‌هایی که احتمالاً نیاز دارید مانند:

- محدودیت نرخ
- مدیریت توکن
- مانیتورینگ
- تعادل بار
- امنیت

را مدیریت کند.

### نمونه Azure

در اینجا یک نمونه Azure وجود دارد که دقیقاً همین کار را انجام می‌دهد، یعنی [ساخت سرور MCP و امن‌سازی آن با Azure API Management](https://github.com/Azure-Samples/remote-mcp-apim-functions-python).

نحوه جریان مجوزدهی را در تصویر زیر ببینید:

![APIM-MCP](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/mcp-client-authorization.gif?raw=true)

در تصویر بالا، موارد زیر اتفاق می‌افتد:

- احراز هویت/مجوزدهی با استفاده از Microsoft Entra انجام می‌شود.
- Azure API Management به عنوان دروازه عمل کرده و با استفاده از سیاست‌ها، ترافیک را هدایت و مدیریت می‌کند.
- Azure Monitor تمام درخواست‌ها را برای تحلیل‌های بعدی ثبت می‌کند.

#### جریان مجوزدهی

بیایید نگاهی دقیق‌تر به جریان مجوزدهی بیندازیم:

![Sequence Diagram](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/infra/app/apim-oauth/diagrams/images/mcp-client-auth.png?raw=true)

#### مشخصات مجوزدهی MCP

برای اطلاعات بیشتر درباره [مشخصات مجوزدهی MCP](https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization#2-10-third-party-authorization-flow) مراجعه کنید.

## استقرار سرور راه دور MCP در Azure

بیایید ببینیم آیا می‌توانیم نمونه‌ای که قبلاً اشاره کردیم را مستقر کنیم:

1. مخزن را کلون کنید

    ```bash
    git clone https://github.com/Azure-Samples/remote-mcp-apim-functions-python.git
    cd remote-mcp-apim-functions-python
    ```

2. ثبت `Microsoft.App` را انجام دهید و پس از مدتی وضعیت ثبت را بررسی کنید:

    `az provider register --namespace Microsoft.App --wait`  
    یا  
    `Register-AzResourceProvider -ProviderNamespace Microsoft.App`  
    و وضعیت را با  
    `(Get-AzResourceProvider -ProviderNamespace Microsoft.App).RegistrationState`  
    بررسی کنید.

3. این فرمان [azd](https://aka.ms/azd) را اجرا کنید تا سرویس مدیریت API، برنامه فانکشن (با کد) و سایر منابع لازم Azure فراهم شود:

    ```shell
    azd up
    ```

    این فرمان باید تمام منابع ابری را در Azure مستقر کند.

### آزمایش سرور با MCP Inspector

1. در **پنجره ترمینال جدید**، MCP Inspector را نصب و اجرا کنید:

    ```shell
    npx @modelcontextprotocol/inspector
    ```

    باید رابطی مشابه زیر ببینید:

    ![Connect to Node inspector](../../../translated_images/connect.141db0b2bd05f096fb1dd91273771fd8b2469d6507656c3b0c9df4b3c5473929.fa.png)

2. با کلیک CTRL، برنامه وب MCP Inspector را از URL نمایش داده شده توسط برنامه (مثلاً http://127.0.0.1:6274/#resources) بارگذاری کنید.
3. نوع انتقال را به `SSE` تنظیم کرده و **Connect** را بزنید:

    ```shell
    https://<apim-servicename-from-azd-output>.azure-api.net/mcp/sse
    ```

4. **فهرست ابزارها**. روی یک ابزار کلیک کرده و **Run Tool** را بزنید.

اگر همه مراحل درست انجام شده باشد، اکنون به سرور MCP متصل شده‌اید و توانسته‌اید یک ابزار را فراخوانی کنید.

## سرورهای MCP برای Azure

[Remote-mcp-functions](https://github.com/Azure-Samples/remote-mcp-functions-dotnet): این مجموعه مخازن قالب شروع سریع برای ساخت و استقرار سرورهای سفارشی راه دور MCP (Model Context Protocol) با استفاده از Azure Functions با Python، C# .NET یا Node/TypeScript است.

نمونه‌ها راه‌حلی کامل ارائه می‌دهند که به توسعه‌دهندگان اجازه می‌دهد:

- ساخت و اجرای محلی: توسعه و اشکال‌زدایی سرور MCP روی ماشین محلی
- استقرار در Azure: استقرار آسان در ابر با فرمان ساده azd up
- اتصال از کلاینت‌ها: اتصال به سرور MCP از کلاینت‌های مختلف از جمله حالت عامل Copilot در VS Code و ابزار MCP Inspector

### ویژگی‌های کلیدی:

- امنیت از طریق طراحی: سرور MCP با کلیدها و HTTPS ایمن شده است
- گزینه‌های احراز هویت: پشتیبانی از OAuth با استفاده از احراز هویت داخلی و/یا مدیریت API
- ایزوله‌سازی شبکه: امکان ایزوله‌سازی شبکه با استفاده از Azure Virtual Networks (VNET)
- معماری بدون سرور: استفاده از Azure Functions برای اجرای مقیاس‌پذیر و رویدادمحور
- توسعه محلی: پشتیبانی کامل از توسعه و اشکال‌زدایی محلی
- استقرار ساده: فرآیند استقرار ساده و روان به Azure

مخزن شامل تمام فایل‌های پیکربندی لازم، کد منبع و تعاریف زیرساخت برای شروع سریع با پیاده‌سازی سرور MCP آماده تولید است.

- [Azure Remote MCP Functions Python](https://github.com/Azure-Samples/remote-mcp-functions-python) - نمونه پیاده‌سازی MCP با استفاده از Azure Functions و Python

- [Azure Remote MCP Functions .NET](https://github.com/Azure-Samples/remote-mcp-functions-dotnet) - نمونه پیاده‌سازی MCP با استفاده از Azure Functions و C# .NET

- [Azure Remote MCP Functions Node/Typescript](https://github.com/Azure-Samples/remote-mcp-functions-typescript) - نمونه پیاده‌سازی MCP با استفاده از Azure Functions و Node/TypeScript

## نکات کلیدی

- SDKهای MCP ابزارهای خاص زبان برای پیاده‌سازی راه‌حل‌های مقاوم MCP ارائه می‌دهند
- فرآیند اشکال‌زدایی و آزمایش برای برنامه‌های قابل اطمینان MCP حیاتی است
- قالب‌های پرامپت قابل استفاده مجدد تعاملات یکنواخت AI را ممکن می‌سازند
- جریان‌های کاری خوب طراحی شده می‌توانند وظایف پیچیده را با استفاده از ابزارهای متعدد هماهنگ کنند
- پیاده‌سازی راه‌حل‌های MCP نیازمند توجه به امنیت، عملکرد و مدیریت خطا است

## تمرین

یک جریان کاری عملی MCP طراحی کنید که به یک مشکل واقعی در حوزه کاری شما پاسخ دهد:

1. 3 تا 4 ابزار که برای حل این مشکل مفید هستند را شناسایی کنید
2. نمودار جریان کاری ایجاد کنید که نشان دهد این ابزارها چگونه با هم تعامل دارند
3. نسخه پایه یکی از ابزارها را با زبان مورد علاقه خود پیاده‌سازی کنید
4. یک قالب پرامپت بسازید که به مدل کمک کند تا ابزار شما را به طور مؤثر استفاده کند

## منابع اضافی


---

بعدی: [موضوعات پیشرفته](../05-AdvancedTopics/README.md)

**سلب مسئولیت**:  
این سند با استفاده از سرویس ترجمه ماشینی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما در تلاش برای دقت هستیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است شامل خطاها یا نادرستی‌هایی باشند. سند اصلی به زبان بومی آن باید به عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حیاتی، ترجمه حرفه‌ای انسانی توصیه می‌شود. ما مسئول هیچ گونه سوءتفاهم یا برداشت نادرستی که از استفاده این ترجمه ناشی شود، نیستیم.
<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "98be664d3b19a81ee24fa3f920233864",
  "translation_date": "2025-05-17T07:10:41+00:00",
  "source_file": "02-Security/readme.md",
  "language_code": "fa"
}
-->
# بهترین شیوه‌های امنیتی

پذیرش پروتکل مدل کانتکست (MCP) قابلیت‌های جدید قدرتمندی را به برنامه‌های مبتنی بر هوش مصنوعی می‌آورد، اما همچنین چالش‌های امنیتی منحصر به فردی را معرفی می‌کند که فراتر از خطرات نرم‌افزاری سنتی است. علاوه بر نگرانی‌های موجود مانند کدنویسی امن، کمترین امتیاز و امنیت زنجیره تامین، بارهای کاری MCP و هوش مصنوعی با تهدیدات جدیدی مانند تزریق دستورات، مسمومیت ابزار و تغییرات پویا در ابزار مواجه می‌شوند. اگر این خطرات به درستی مدیریت نشوند، می‌توانند منجر به استخراج داده‌ها، نقض حریم خصوصی و رفتار ناخواسته سیستم شوند.

این درس به بررسی مهم‌ترین خطرات امنیتی مرتبط با MCP می‌پردازد - از جمله احراز هویت، مجوز، دسترسی‌های بیش از حد، تزریق دستورات غیرمستقیم و آسیب‌پذیری‌های زنجیره تامین - و کنترل‌های عملی و بهترین شیوه‌ها برای کاهش آن‌ها را ارائه می‌دهد. همچنین یاد می‌گیرید که چگونه از راه‌حل‌های مایکروسافت مانند Prompt Shields، Azure Content Safety و GitHub Advanced Security برای تقویت پیاده‌سازی MCP خود استفاده کنید. با درک و اعمال این کنترل‌ها، می‌توانید به طور قابل توجهی احتمال نقض امنیتی را کاهش دهید و اطمینان حاصل کنید که سیستم‌های هوش مصنوعی شما قوی و قابل اعتماد باقی می‌مانند.

# اهداف یادگیری

تا پایان این درس، قادر خواهید بود:

- شناسایی و توضیح خطرات امنیتی منحصر به فردی که توسط پروتکل مدل کانتکست (MCP) معرفی شده‌اند، از جمله تزریق دستورات، مسمومیت ابزار، دسترسی‌های بیش از حد و آسیب‌پذیری‌های زنجیره تامین.
- توصیف و اعمال کنترل‌های مؤثر برای کاهش خطرات امنیتی MCP، مانند احراز هویت قوی، کمترین امتیاز، مدیریت امن توکن و تأیید زنجیره تامین.
- درک و استفاده از راه‌حل‌های مایکروسافت مانند Prompt Shields، Azure Content Safety و GitHub Advanced Security برای حفاظت از MCP و بارهای کاری هوش مصنوعی.
- شناسایی اهمیت اعتبارسنجی متادیتای ابزار، نظارت بر تغییرات پویا و دفاع در برابر حملات تزریق دستورات غیرمستقیم.
- ادغام بهترین شیوه‌های امنیتی موجود - مانند کدنویسی امن، سخت‌سازی سرور و معماری اعتماد صفر - در پیاده‌سازی MCP خود برای کاهش احتمال و تأثیر نقض‌های امنیتی.

# کنترل‌های امنیتی MCP

هر سیستمی که به منابع مهم دسترسی دارد، چالش‌های امنیتی ضمنی دارد. چالش‌های امنیتی به طور کلی می‌توانند از طریق اعمال صحیح کنترل‌ها و مفاهیم امنیتی اساسی حل شوند. با توجه به اینکه MCP تازه تعریف شده است، مشخصات آن به سرعت در حال تغییر است و با تکامل پروتکل، کنترل‌های امنیتی در آن بالغ خواهند شد و امکان ادغام بهتر با معماری‌ها و بهترین شیوه‌های امنیتی سازمانی و موجود را فراهم می‌کنند.

تحقیقات منتشر شده در [گزارش دفاع دیجیتال مایکروسافت](https://aka.ms/mddr) بیان می‌کند که ۹۸٪ از نقض‌های گزارش شده با بهداشت امنیتی قوی و بهترین حفاظت در برابر هر نوع نقض جلوگیری می‌شود. این بهترین شیوه‌های کدنویسی امن و امنیت زنجیره تامین که امتحان شده و آزمون شده‌اند، همچنان بیشترین تأثیر را در کاهش خطرات امنیتی دارند.

بیایید به برخی از روش‌هایی که می‌توانید با پذیرش MCP به خطرات امنیتی پاسخ دهید، نگاه کنیم.

# احراز هویت سرور MCP (اگر پیاده‌سازی MCP شما قبل از ۲۶ آوریل ۲۰۲۵ بود)

> **توجه:** اطلاعات زیر تا ۲۶ آوریل ۲۰۲۵ صحیح است. پروتکل MCP به طور مداوم در حال تکامل است و پیاده‌سازی‌های آینده ممکن است الگوها و کنترل‌های احراز هویت جدیدی را معرفی کنند. برای آخرین به‌روزرسانی‌ها و راهنمایی‌ها، همیشه به [مشخصات MCP](https://spec.modelcontextprotocol.io/) و [مخزن رسمی MCP GitHub](https://github.com/modelcontextprotocol) مراجعه کنید.

### بیان مشکل
مشخصات اصلی MCP فرض می‌کرد که توسعه‌دهندگان سرور احراز هویت خود را می‌نویسند. این نیاز به دانش در مورد OAuth و محدودیت‌های امنیتی مرتبط داشت. سرورهای MCP به عنوان سرورهای مجوز OAuth 2.0 عمل می‌کردند و احراز هویت کاربر مورد نیاز را مستقیماً مدیریت می‌کردند، نه اینکه آن را به یک سرویس خارجی مانند Microsoft Entra ID واگذار کنند. از ۲۶ آوریل ۲۰۲۵، به‌روزرسانی به مشخصات MCP اجازه می‌دهد تا سرورهای MCP احراز هویت کاربر را به یک سرویس خارجی واگذار کنند.

### خطرات
- منطق مجوز نادرست پیکربندی شده در سرور MCP می‌تواند منجر به افشای داده‌های حساس و کنترل‌های دسترسی نادرست شود.
- سرقت توکن OAuth در سرور MCP محلی. اگر دزدیده شود، توکن می‌تواند برای جعل سرور MCP و دسترسی به منابع و داده‌ها از سرویسی که توکن OAuth برای آن است، استفاده شود.

### کنترل‌های کاهش‌دهنده
- **بازبینی و تقویت منطق مجوز:** به دقت پیاده‌سازی مجوز سرور MCP خود را بررسی کنید تا اطمینان حاصل کنید که فقط کاربران و مشتریان مورد نظر می‌توانند به منابع حساس دسترسی پیدا کنند. برای راهنمایی عملی، به [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) و [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/) مراجعه کنید.
- **اجرای شیوه‌های امن توکن:** از [بهترین شیوه‌های مایکروسافت برای اعتبارسنجی و عمر توکن](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens) پیروی کنید تا از سوء استفاده از توکن‌های دسترسی جلوگیری کنید و خطر تکرار یا سرقت توکن را کاهش دهید.
- **حفاظت از ذخیره‌سازی توکن:** همیشه توکن‌ها را به طور امن ذخیره کنید و از رمزگذاری برای حفاظت از آن‌ها در حالت استراحت و انتقال استفاده کنید. برای نکات پیاده‌سازی، به [Use secure token storage and encrypt tokens](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2) مراجعه کنید.

# دسترسی‌های بیش از حد برای سرورهای MCP

### بیان مشکل
ممکن است به سرورهای MCP دسترسی‌های بیش از حد به سرویس/منبعی که به آن دسترسی دارند داده شده باشد. به عنوان مثال، یک سرور MCP که بخشی از یک برنامه فروش مبتنی بر هوش مصنوعی است و به یک مخزن داده سازمانی متصل می‌شود، باید دسترسی به داده‌های فروش محدود شود و اجازه دسترسی به تمام فایل‌های موجود در مخزن داده نشود. با اشاره به اصل کمترین امتیاز (یکی از قدیمی‌ترین اصول امنیتی)، هیچ منبعی نباید دسترسی‌های بیش از حد به آنچه برای اجرای وظایف مورد نظرش نیاز دارد داشته باشد. هوش مصنوعی در این زمینه چالشی افزوده است زیرا برای انعطاف‌پذیری آن، ممکن است تعریف دقیق دسترسی‌های مورد نیاز چالش‌برانگیز باشد.

### خطرات 
- اعطای دسترسی‌های بیش از حد می‌تواند به استخراج یا اصلاح داده‌هایی که سرور MCP برای دسترسی به آن‌ها در نظر گرفته نشده بود، منجر شود. این می‌تواند یک مسئله حریم خصوصی باشد اگر داده‌ها شامل اطلاعات شخصی قابل شناسایی (PII) باشند.

### کنترل‌های کاهش‌دهنده
- **اعمال اصل کمترین امتیاز:** به سرور MCP فقط حداقل دسترسی‌های لازم برای انجام وظایف مورد نیازش را اعطا کنید. به طور منظم این دسترسی‌ها را بازبینی و به‌روزرسانی کنید تا اطمینان حاصل شود که بیش از نیاز نیستند. برای راهنمایی دقیق، به [Secure least-privileged access](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access) مراجعه کنید.
- **استفاده از کنترل دسترسی مبتنی بر نقش (RBAC):** نقش‌هایی را به سرور MCP اختصاص دهید که به طور دقیق به منابع و اقدامات خاص محدود شده‌اند، از دسترسی‌های گسترده یا غیرضروری خودداری کنید.
- **نظارت و ممیزی دسترسی‌ها:** به طور مداوم استفاده از دسترسی‌ها را نظارت کنید و لاگ‌های دسترسی را ممیزی کنید تا دسترسی‌های بیش از حد یا استفاده نشده را به موقع شناسایی و اصلاح کنید.

# حملات تزریق دستورات غیرمستقیم

### بیان مشکل

سرورهای MCP مخرب یا به خطر افتاده می‌توانند خطرات قابل توجهی را با افشای داده‌های مشتری یا فعال‌سازی اقدامات ناخواسته معرفی کنند. این خطرات به ویژه در بارهای کاری مبتنی بر هوش مصنوعی و MCP مرتبط هستند، جایی که:

- **حملات تزریق دستورات:** مهاجمان دستورات مخرب را در دستورات یا محتوای خارجی جاسازی می‌کنند، که باعث می‌شود سیستم هوش مصنوعی اقدامات ناخواسته‌ای انجام دهد یا داده‌های حساس را افشا کند. بیشتر بدانید: [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **مسمومیت ابزار:** مهاجمان متادیتای ابزار (مانند توضیحات یا پارامترها) را تغییر می‌دهند تا رفتار هوش مصنوعی را تحت تأثیر قرار دهند، که ممکن است کنترل‌های امنیتی را دور بزند یا داده‌ها را استخراج کند. جزئیات: [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **تزریق دستورات در حوزه‌های مختلف:** دستورات مخرب در اسناد، صفحات وب یا ایمیل‌ها جاسازی می‌شوند، که سپس توسط هوش مصنوعی پردازش می‌شوند و منجر به افشای داده‌ها یا دستکاری می‌شوند.
- **تغییرات پویا در ابزار (Rug Pulls):** تعاریف ابزار پس از تأیید کاربر می‌توانند تغییر کنند و رفتارهای مخرب جدیدی را بدون آگاهی کاربر معرفی کنند.

این آسیب‌پذیری‌ها نیاز به اعتبارسنجی قوی، نظارت و کنترل‌های امنیتی هنگام ادغام سرورها و ابزارهای MCP در محیط شما را برجسته می‌کنند. برای بررسی عمیق‌تر، به منابع پیوند داده شده در بالا مراجعه کنید.

**تزریق دستورات غیرمستقیم** (همچنین به عنوان تزریق دستورات در حوزه‌های مختلف یا XPIA شناخته می‌شود) یک آسیب‌پذیری بحرانی در سیستم‌های هوش مصنوعی مولد است، از جمله آن‌هایی که از پروتکل مدل کانتکست (MCP) استفاده می‌کنند. در این حمله، دستورات مخرب در محتوای خارجی - مانند اسناد، صفحات وب یا ایمیل‌ها - پنهان می‌شوند. هنگامی که سیستم هوش مصنوعی این محتوا را پردازش می‌کند، ممکن است دستورات جاسازی شده را به عنوان دستورات کاربر قانونی تفسیر کند، که منجر به اقدامات ناخواسته مانند افشای داده‌ها، تولید محتوای مضر یا دستکاری تعاملات کاربر می‌شود. برای توضیح دقیق و مثال‌های دنیای واقعی، به [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/) مراجعه کنید.

شکلی به ویژه خطرناک از این حمله **مسمومیت ابزار** است. در اینجا، مهاجمان دستورات مخرب را در متادیتای ابزارهای MCP (مانند توضیحات یا پارامترهای ابزار) تزریق می‌کنند. از آنجا که مدل‌های زبانی بزرگ (LLMs) به این متادیتا برای تصمیم‌گیری در مورد اینکه کدام ابزارها را فراخوانی کنند، متکی هستند، توضیحات به خطر افتاده می‌توانند مدل را به اجرای تماس‌های ابزار غیرمجاز یا دور زدن کنترل‌های امنیتی فریب دهند. این دستکاری‌ها اغلب برای کاربران نهایی نامرئی هستند اما می‌توانند توسط سیستم هوش مصنوعی تفسیر و اجرا شوند. این خطر در محیط‌های سرور MCP میزبانی شده افزایش می‌یابد، جایی که تعاریف ابزار می‌توانند پس از تأیید کاربر به‌روزرسانی شوند - سناریویی که گاهی به عنوان "[rug pull](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)" نامیده می‌شود. در چنین مواردی، ابزاری که قبلاً ایمن بود ممکن است بعداً برای انجام اقدامات مخرب، مانند استخراج داده‌ها یا تغییر رفتار سیستم، بدون آگاهی کاربر تغییر یابد. برای اطلاعات بیشتر در مورد این بردار حمله، به [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks) مراجعه کنید.

## خطرات
اقدامات ناخواسته هوش مصنوعی مجموعه‌ای از خطرات امنیتی را شامل می‌شود که شامل استخراج داده‌ها و نقض حریم خصوصی می‌شوند.

### کنترل‌های کاهش‌دهنده
### استفاده از سپرهای دستورات برای محافظت در برابر حملات تزریق دستورات غیرمستقیم
-----------------------------------------------------------------------------

**سپرهای دستورات هوش مصنوعی** یک راه‌حل توسعه یافته توسط مایکروسافت برای دفاع در برابر حملات تزریق دستورات مستقیم و غیرمستقیم هستند. آن‌ها از طریق:

1.  **تشخیص و فیلتر کردن**: سپرهای دستورات از الگوریتم‌های پیشرفته یادگیری ماشین و پردازش زبان طبیعی برای تشخیص و فیلتر کردن دستورات مخرب جاسازی شده در محتوای خارجی، مانند اسناد، صفحات وب یا ایمیل‌ها استفاده می‌کنند.
    
2.  **نورافشانی**: این تکنیک به سیستم هوش مصنوعی کمک می‌کند تا بین دستورات سیستم معتبر و ورودی‌های خارجی غیرقابل اعتماد تمایز قائل شود. با تغییر متن ورودی به گونه‌ای که برای مدل مرتبط‌تر باشد، نورافشانی اطمینان حاصل می‌کند که هوش مصنوعی می‌تواند بهتر دستورات مخرب را شناسایی و نادیده بگیرد.
    
3.  **جداکننده‌ها و نشانه‌گذاری داده‌ها**: شامل جداکننده‌ها در پیام سیستم به صراحت مکان متن ورودی را مشخص می‌کند و به سیستم هوش مصنوعی کمک می‌کند تا ورودی‌های کاربر را از محتوای خارجی بالقوه مضر تشخیص دهد و جدا کند. نشانه‌گذاری داده‌ها این مفهوم را با استفاده از نشانگرهای خاص برای برجسته کردن مرزهای داده‌های معتبر و غیرمعتبر گسترش می‌دهد.
    
4.  **نظارت و به‌روزرسانی‌های مداوم**: مایکروسافت به طور مداوم سپرهای دستورات را نظارت و به‌روزرسانی می‌کند تا به تهدیدهای جدید و در حال تکامل پاسخ دهد. این رویکرد پیشگیرانه اطمینان حاصل می‌کند که دفاع‌ها در برابر تکنیک‌های حمله جدید موثر باقی می‌مانند.
    
5. **ادغام با Azure Content Safety:** سپرهای دستورات بخشی از مجموعه گسترده‌تر Azure AI Content Safety هستند که ابزارهای اضافی برای تشخیص تلاش‌های فرار، محتوای مضر و سایر خطرات امنیتی در برنامه‌های هوش مصنوعی فراهم می‌کنند.

می‌توانید اطلاعات بیشتری درباره سپرهای دستورات هوش مصنوعی در [مستندات سپرهای دستورات](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection) بخوانید.

### امنیت زنجیره تامین

امنیت زنجیره تامین در عصر هوش مصنوعی همچنان اساسی است، اما دامنه آنچه زنجیره تامین شما را تشکیل می‌دهد گسترش یافته است. علاوه بر بسته‌های کد سنتی، اکنون باید به طور دقیق تمام اجزای مرتبط با هوش مصنوعی، از جمله مدل‌های پایه، خدمات جاسازی، ارائه‌دهندگان کانتکست و APIهای شخص ثالث را تأیید و نظارت کنید. هر یک از این‌ها می‌توانند آسیب‌پذیری‌ها یا خطراتی را معرفی کنند اگر به درستی مدیریت نشوند.

**روش‌های کلیدی امنیت زنجیره تامین برای هوش مصنوعی و MCP:**
- **تمام اجزا را قبل از ادغام تأیید کنید:** این شامل نه تنها کتابخانه‌های متن‌باز، بلکه مدل‌های هوش مصنوعی، منابع داده و APIهای خارجی نیز می‌شود. همیشه منبع، مجوز و آسیب‌پذیری‌های شناخته شده را بررسی کنید.
- **پایپ‌لاین‌های استقرار امن را حفظ کنید:** از پایپ‌لاین‌های CI/CD خودکار با اسکن امنیتی یکپارچه برای شناسایی مسائل در مراحل اولیه استفاده کنید. اطمینان حاصل کنید که تنها مصنوعات مورد اعتماد به تولید منتقل می‌شوند.
- **به طور مداوم نظارت و ممیزی کنید:** نظارت مداوم بر تمام وابستگی‌ها، از جمله مدل‌ها و خدمات داده، برای شناسایی آسیب‌پذیری‌های جدید یا حملات زنجیره تامین را اجرا کنید.
- **اعمال کمترین امتیاز و کنترل‌های دسترسی:** دسترسی به مدل‌ها، داده‌ها و خدمات را به آنچه که برای عملکرد سرور MCP شما ضروری است محدود کنید.
- **به تهدیدات سریع پاسخ دهید:** فرآیندی برای اصلاح یا جایگزینی اجزای به خطر افتاده و برای چرخش اسرار یا اعتبارنامه‌ها در صورت شناسایی نقض داشته باشید.

[GitHub Advanced Security](https://github.com/security/advanced-security) ویژگی‌هایی مانند اسکن اسرار، اسکن وابستگی و تجزیه و تحلیل CodeQL را ارائه می‌دهد. این ابزارها با [Azure DevOps](https://azure.microsoft.com/en-us/products/devops) و [Azure Repos](https://azure.microsoft.com/en-us/products/devops/repos/) یکپارچه می‌شوند تا
- [ده مورد برتر OWASP برای LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [امنیت پیشرفته GitHub](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [سفر به سوی تأمین امنیت زنجیره تأمین نرم‌افزار در مایکروسافت](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [دسترسی کم‌امتیاز امن (مایکروسافت)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [بهترین روش‌ها برای اعتبارسنجی و عمر نشانه](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [استفاده از ذخیره‌سازی امن نشانه و رمزنگاری نشانه‌ها (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [مدیریت API Azure به عنوان دروازه احراز هویت برای MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [استفاده از Microsoft Entra ID برای احراز هویت با سرورهای MCP](https://den.dev/blog/mcp-server-auth-entra-id-session/)

### بعدی

بعدی: [فصل ۳: شروع به کار](/03-GettingStarted/README.md)

**سلب مسئولیت**:  
این سند با استفاده از خدمات ترجمه هوش مصنوعی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما برای دقت تلاش می‌کنیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است حاوی اشتباهات یا نادقیق‌ها باشند. سند اصلی به زبان اصلی آن باید به عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حیاتی، ترجمه انسانی حرفه‌ای توصیه می‌شود. ما مسئولیتی در قبال هرگونه سوء تفاهم یا تفسیر نادرست ناشی از استفاده از این ترجمه نداریم.
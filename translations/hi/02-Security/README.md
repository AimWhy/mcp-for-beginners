<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "382fddb4ee4d9c1bdc806e2ee99b70c8",
  "translation_date": "2025-07-16T22:52:46+00:00",
  "source_file": "02-Security/README.md",
  "language_code": "hi"
}
-->
# सुरक्षा सर्वोत्तम प्रथाएँ

Model Context Protocol (MCP) को अपनाने से AI-संचालित अनुप्रयोगों में शक्तिशाली नई क्षमताएँ आती हैं, लेकिन इसके साथ ही पारंपरिक सॉफ़्टवेयर जोखिमों से परे अनोखी सुरक्षा चुनौतियाँ भी उत्पन्न होती हैं। सुरक्षित कोडिंग, न्यूनतम विशेषाधिकार, और सप्लाई चेन सुरक्षा जैसे स्थापित मुद्दों के अलावा, MCP और AI वर्कलोड्स को नए खतरों का सामना करना पड़ता है जैसे कि प्रॉम्प्ट इंजेक्शन, टूल पॉइज़निंग, डायनामिक टूल संशोधन, सेशन हाईजैकिंग, कन्फ्यूज्ड डिप्टी हमले, और टोकन पासथ्रू कमजोरियाँ। यदि इन्हें सही ढंग से प्रबंधित न किया जाए तो ये जोखिम डेटा चोरी, गोपनीयता उल्लंघन, और अनचाहे सिस्टम व्यवहार का कारण बन सकते हैं।

यह पाठ MCP से जुड़े सबसे महत्वपूर्ण सुरक्षा जोखिमों का पता लगाता है—जिसमें प्रमाणीकरण, प्राधिकरण, अत्यधिक अनुमतियाँ, अप्रत्यक्ष प्रॉम्प्ट इंजेक्शन, सेशन सुरक्षा, कन्फ्यूज्ड डिप्टी समस्याएँ, टोकन पासथ्रू कमजोरियाँ, और सप्लाई चेन कमजोरियाँ शामिल हैं—और इन्हें कम करने के लिए व्यावहारिक नियंत्रण और सर्वोत्तम प्रथाएँ प्रदान करता है। आप Microsoft के समाधान जैसे Prompt Shields, Azure Content Safety, और GitHub Advanced Security का उपयोग करके अपने MCP कार्यान्वयन को मजबूत करना भी सीखेंगे। इन नियंत्रणों को समझकर और लागू करके, आप सुरक्षा उल्लंघन की संभावना को काफी हद तक कम कर सकते हैं और सुनिश्चित कर सकते हैं कि आपके AI सिस्टम मजबूत और विश्वसनीय बने रहें।

# सीखने के उद्देश्य

इस पाठ के अंत तक, आप सक्षम होंगे:

- Model Context Protocol (MCP) द्वारा प्रस्तुत अनोखे सुरक्षा जोखिमों की पहचान और व्याख्या करना, जिनमें प्रॉम्प्ट इंजेक्शन, टूल पॉइज़निंग, अत्यधिक अनुमतियाँ, सेशन हाईजैकिंग, कन्फ्यूज्ड डिप्टी समस्याएँ, टोकन पासथ्रू कमजोरियाँ, और सप्लाई चेन कमजोरियाँ शामिल हैं।
- MCP सुरक्षा जोखिमों के लिए प्रभावी निवारक नियंत्रणों का वर्णन और उपयोग करना, जैसे मजबूत प्रमाणीकरण, न्यूनतम विशेषाधिकार, सुरक्षित टोकन प्रबंधन, सेशन सुरक्षा नियंत्रण, और सप्लाई चेन सत्यापन।
- Microsoft के समाधान जैसे Prompt Shields, Azure Content Safety, और GitHub Advanced Security का उपयोग करके MCP और AI वर्कलोड्स की सुरक्षा करना।
- टूल मेटाडेटा की वैधता की पुष्टि करने, डायनामिक परिवर्तनों की निगरानी करने, अप्रत्यक्ष प्रॉम्प्ट इंजेक्शन हमलों से बचाव करने, और सेशन हाईजैकिंग को रोकने के महत्व को समझना।
- स्थापित सुरक्षा सर्वोत्तम प्रथाओं—जैसे सुरक्षित कोडिंग, सर्वर हार्डनिंग, और ज़ीरो ट्रस्ट आर्किटेक्चर—को अपने MCP कार्यान्वयन में शामिल करना ताकि सुरक्षा उल्लंघनों की संभावना और प्रभाव को कम किया जा सके।

# MCP सुरक्षा नियंत्रण

कोई भी सिस्टम जिसे महत्वपूर्ण संसाधनों तक पहुंच है, उसके साथ सुरक्षा चुनौतियाँ जुड़ी होती हैं। सुरक्षा चुनौतियों को आमतौर पर मौलिक सुरक्षा नियंत्रणों और अवधारणाओं के सही अनुप्रयोग के माध्यम से संबोधित किया जा सकता है। चूंकि MCP अभी हाल ही में परिभाषित हुआ है, इसकी विशिष्टता तेजी से बदल रही है और जैसे-जैसे प्रोटोकॉल विकसित होता है, अंततः इसके भीतर सुरक्षा नियंत्रण परिपक्व होंगे, जिससे इसे उद्यम और स्थापित सुरक्षा आर्किटेक्चर और सर्वोत्तम प्रथाओं के साथ बेहतर एकीकरण मिलेगा।

[Microsoft Digital Defense Report](https://aka.ms/mddr) में प्रकाशित शोध के अनुसार, रिपोर्ट किए गए 98% उल्लंघनों को मजबूत सुरक्षा स्वच्छता द्वारा रोका जा सकता है और किसी भी प्रकार के उल्लंघन के खिलाफ सबसे अच्छी सुरक्षा यह है कि आपकी बुनियादी सुरक्षा स्वच्छता, सुरक्षित कोडिंग सर्वोत्तम प्रथाएँ, और सप्लाई चेन सुरक्षा सही हो — ये आजमाई हुई और सिद्ध प्रथाएँ सुरक्षा जोखिम को कम करने में सबसे अधिक प्रभावी हैं।

आइए देखें कि MCP को अपनाते समय आप सुरक्षा जोखिमों को कैसे संबोधित करना शुरू कर सकते हैं।

> **Note:** निम्नलिखित जानकारी **29 मई 2025** तक सही है। MCP प्रोटोकॉल लगातार विकसित हो रहा है, और भविष्य के कार्यान्वयन नए प्रमाणीकरण पैटर्न और नियंत्रण पेश कर सकते हैं। नवीनतम अपडेट और मार्गदर्शन के लिए हमेशा [MCP Specification](https://spec.modelcontextprotocol.io/) और आधिकारिक [MCP GitHub repository](https://github.com/modelcontextprotocol) तथा [security best practice page](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices) देखें।

### समस्या विवरण  
मूल MCP विशिष्टता ने यह मान लिया था कि डेवलपर्स अपना स्वयं का प्रमाणीकरण सर्वर लिखेंगे। इसके लिए OAuth और संबंधित सुरक्षा प्रतिबंधों का ज्ञान आवश्यक था। MCP सर्वर OAuth 2.0 प्राधिकरण सर्वर के रूप में कार्य करते थे, जो आवश्यक उपयोगकर्ता प्रमाणीकरण को सीधे प्रबंधित करते थे, बजाय इसके कि इसे Microsoft Entra ID जैसे बाहरी सेवा को सौंपा जाए। **26 अप्रैल 2025** से, MCP विशिष्टता के एक अपडेट ने MCP सर्वरों को उपयोगकर्ता प्रमाणीकरण को बाहरी सेवा को सौंपने की अनुमति दी है।

### जोखिम
- MCP सर्वर में गलत कॉन्फ़िगर की गई प्राधिकरण लॉजिक संवेदनशील डेटा के खुलासे और गलत तरीके से लागू किए गए एक्सेस नियंत्रणों का कारण बन सकती है।
- स्थानीय MCP सर्वर पर OAuth टोकन चोरी। यदि टोकन चोरी हो जाता है, तो इसका उपयोग MCP सर्वर की नकल करने और उस सेवा से संसाधनों और डेटा तक पहुंचने के लिए किया जा सकता है जिसके लिए OAuth टोकन है।

#### टोकन पासथ्रू
टोकन पासथ्रू प्राधिकरण विशिष्टता में स्पष्ट रूप से निषिद्ध है क्योंकि यह कई सुरक्षा जोखिम लाता है, जिनमें शामिल हैं:

#### सुरक्षा नियंत्रणों की परहेज़
MCP सर्वर या डाउनस्ट्रीम API महत्वपूर्ण सुरक्षा नियंत्रण लागू कर सकते हैं जैसे कि रेट लिमिटिंग, अनुरोध सत्यापन, या ट्रैफ़िक निगरानी, जो टोकन ऑडियंस या अन्य क्रेडेंशियल प्रतिबंधों पर निर्भर करते हैं। यदि क्लाइंट सीधे डाउनस्ट्रीम API के साथ टोकन प्राप्त कर सकते हैं और उनका उपयोग कर सकते हैं बिना MCP सर्वर द्वारा उचित सत्यापन के, तो वे इन नियंत्रणों को बायपास कर देते हैं।

#### जवाबदेही और ऑडिट ट्रेल समस्याएँ
जब क्लाइंट अपस्ट्रीम-इश्यूड एक्सेस टोकन के साथ कॉल करते हैं जो MCP सर्वर के लिए अस्पष्ट हो सकता है, तो MCP सर्वर MCP क्लाइंट्स की पहचान या भेद नहीं कर पाएगा।  
डाउनस्ट्रीम रिसोर्स सर्वर के लॉग ऐसे अनुरोध दिखा सकते हैं जो किसी अलग स्रोत या पहचान से आते प्रतीत होते हैं, बजाय उस MCP सर्वर के जो वास्तव में टोकन अग्रेषित कर रहा है।  
ये दोनों कारक घटना जांच, नियंत्रण, और ऑडिटिंग को कठिन बनाते हैं।  
यदि MCP सर्वर टोकन के दावों (जैसे भूमिकाएँ, विशेषाधिकार, या ऑडियंस) या अन्य मेटाडेटा का सत्यापन किए बिना टोकन पास करता है, तो चोरी किए गए टोकन के साथ एक दुर्भावनापूर्ण व्यक्ति सर्वर का उपयोग डेटा चोरी के लिए प्रॉक्सी के रूप में कर सकता है।

#### ट्रस्ट सीमा समस्याएँ
डाउनस्ट्रीम रिसोर्स सर्वर विशिष्ट संस्थाओं को ट्रस्ट प्रदान करता है। यह ट्रस्ट उत्पत्ति या क्लाइंट व्यवहार पैटर्न के बारे में मान्यताएँ शामिल कर सकता है। इस ट्रस्ट सीमा को तोड़ना अप्रत्याशित समस्याओं का कारण बन सकता है।  
यदि टोकन कई सेवाओं द्वारा बिना उचित सत्यापन के स्वीकार किया जाता है, तो एक सेवा के समझौता होने पर हमलावर उस टोकन का उपयोग अन्य जुड़े हुए सेवाओं तक पहुंचने के लिए कर सकता है।

#### भविष्य की संगतता जोखिम
यदि आज कोई MCP सर्वर "शुद्ध प्रॉक्सी" के रूप में शुरू होता है, तो उसे बाद में सुरक्षा नियंत्रण जोड़ने की आवश्यकता हो सकती है। उचित टोकन ऑडियंस पृथक्करण के साथ शुरू करना सुरक्षा मॉडल को विकसित करना आसान बनाता है।

### निवारक नियंत्रण

**MCP सर्वर को किसी भी ऐसे टोकन को स्वीकार नहीं करना चाहिए जो स्पष्ट रूप से MCP सर्वर के लिए जारी नहीं किए गए हों।**

- **प्राधिकरण लॉजिक की समीक्षा और कड़ा करना:** अपने MCP सर्वर के प्राधिकरण कार्यान्वयन का सावधानीपूर्वक ऑडिट करें ताकि केवल इच्छित उपयोगकर्ता और क्लाइंट संवेदनशील संसाधनों तक पहुंच सकें। व्यावहारिक मार्गदर्शन के लिए देखें [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) और [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/)।
- **सुरक्षित टोकन प्रथाओं को लागू करें:** [Microsoft के टोकन सत्यापन और जीवनकाल के सर्वोत्तम अभ्यास](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens) का पालन करें ताकि एक्सेस टोकन के दुरुपयोग और टोकन रिप्ले या चोरी के जोखिम को कम किया जा सके।
- **टोकन भंडारण की सुरक्षा करें:** हमेशा टोकन को सुरक्षित रूप से संग्रहित करें और उन्हें स्थिर और ट्रांज़िट में एन्क्रिप्ट करें। कार्यान्वयन सुझावों के लिए देखें [Use secure token storage and encrypt tokens](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)।

# MCP सर्वरों के लिए अत्यधिक अनुमतियाँ

### समस्या विवरण  
MCP सर्वरों को उस सेवा/संसाधन के लिए अत्यधिक अनुमतियाँ दी गई हो सकती हैं जिसे वे एक्सेस कर रहे हैं। उदाहरण के लिए, एक AI बिक्री अनुप्रयोग का हिस्सा होने वाला MCP सर्वर जो एक उद्यम डेटा स्टोर से जुड़ा है, उसे केवल बिक्री डेटा तक पहुंच होनी चाहिए, न कि स्टोर की सभी फाइलों तक। न्यूनतम विशेषाधिकार के सिद्धांत (जो सबसे पुराना सुरक्षा सिद्धांतों में से एक है) के अनुसार, किसी भी संसाधन को केवल उतनी ही अनुमतियाँ मिलनी चाहिए जितनी उसे अपने कार्यों को पूरा करने के लिए आवश्यक हों। AI इस क्षेत्र में एक चुनौती प्रस्तुत करता है क्योंकि इसे लचीला बनाने के लिए आवश्यक सटीक अनुमतियों को परिभाषित करना कठिन हो सकता है।

### जोखिम  
- अत्यधिक अनुमतियाँ देने से MCP सर्वर को ऐसे डेटा को निकालने या संशोधित करने की अनुमति मिल सकती है जिसे वह एक्सेस करने के लिए अभिप्रेत नहीं था। यदि डेटा व्यक्तिगत पहचान योग्य जानकारी (PII) है, तो यह गोपनीयता का मुद्दा भी हो सकता है।

### निवारक नियंत्रण  
- **न्यूनतम विशेषाधिकार का सिद्धांत लागू करें:** MCP सर्वर को केवल आवश्यक कार्यों को करने के लिए न्यूनतम अनुमतियाँ दें। नियमित रूप से इन अनुमतियों की समीक्षा और अद्यतन करें ताकि वे आवश्यक से अधिक न हों। विस्तृत मार्गदर्शन के लिए देखें [Secure least-privileged access](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)।
- **भूमिका-आधारित एक्सेस नियंत्रण (RBAC) का उपयोग करें:** MCP सर्वर को ऐसे रोल असाइन करें जो विशिष्ट संसाधनों और क्रियाओं तक सीमित हों, व्यापक या अनावश्यक अनुमतियों से बचें।
- **अनुमतियों की निगरानी और ऑडिट करें:** अनुमतियों के उपयोग की निरंतर निगरानी करें और एक्सेस लॉग का ऑडिट करें ताकि अत्यधिक या अप्रयुक्त विशेषाधिकारों का शीघ्र पता लगाकर सुधार किया जा सके।

# अप्रत्यक्ष प्रॉम्प्ट इंजेक्शन हमले

### समस्या विवरण

दुर्भावनापूर्ण या समझौता किए गए MCP सर्वर ग्राहक डेटा को उजागर करके या अनचाहे कार्यों को सक्षम करके महत्वपूर्ण जोखिम पैदा कर सकते हैं। ये जोखिम विशेष रूप से AI और MCP-आधारित वर्कलोड्स में प्रासंगिक हैं, जहाँ:

- **प्रॉम्प्ट इंजेक्शन हमले**: हमलावर प्रॉम्प्ट या बाहरी सामग्री में दुर्भावनापूर्ण निर्देश छिपाते हैं, जिससे AI सिस्टम अनचाहे कार्य करता है या संवेदनशील डेटा लीक करता है। अधिक जानें: [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **टूल पॉइज़निंग**: हमलावर टूल मेटाडेटा (जैसे विवरण या पैरामीटर) को प्रभावित करते हैं ताकि AI के व्यवहार को प्रभावित किया जा सके, संभवतः सुरक्षा नियंत्रणों को बायपास किया जा सके या डेटा चोरी की जा सके। विवरण: [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **क्रॉस-डोमेन प्रॉम्प्ट इंजेक्शन**: दुर्भावनापूर्ण निर्देश दस्तावेज़ों, वेब पेजों, या ईमेल में छिपाए जाते हैं, जिन्हें AI संसाधित करता है, जिससे डेटा लीक या हेरफेर होता है।
- **डायनामिक टूल संशोधन (रग पुल्स)**: उपयोगकर्ता की स्वीकृति के बाद टूल परिभाषाओं को बदला जा सकता है, जिससे नए दुर्भावनापूर्ण व्यवहार बिना उपयोगकर्ता की जानकारी के आ सकते हैं।

ये कमजोरियाँ MCP सर्वरों और टूल्स को आपके वातावरण में एकीकृत करते समय मजबूत सत्यापन, निगरानी, और सुरक्षा नियंत्रणों की आवश्यकता को उजागर करती हैं। गहराई से जानने के लिए ऊपर दिए गए संदर्भ देखें।

![prompt-injection-lg-2048x1034](../../../translated_images/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.hi.png)

**अप्रत्यक्ष प्रॉम्प्ट इंजेक्शन** (जिसे क्रॉस-डोमेन प्रॉम्प्ट इंजेक्शन या XPIA भी कहा जाता है) जनरेटिव AI सिस्टम में एक गंभीर कमजोरी है, जिसमें Model Context Protocol (MCP) का उपयोग होता है। इस हमले में, दुर्भावनापूर्ण निर्देश बाहरी सामग्री—जैसे दस्तावेज़, वेब पेज, या ईमेल—में छिपाए जाते हैं। जब AI सिस्टम इस सामग्री को संसाधित करता है, तो यह छिपे हुए निर्देशों को वैध उपयोगकर्ता कमांड के रूप में समझ सकता है, जिसके परिणामस्वरूप अनचाहे कार्य जैसे डेटा लीक, हानिकारक सामग्री का निर्माण, या उपयोगकर्ता इंटरैक्शन का हेरफेर हो सकता है। विस्तृत व्याख्या और वास्तविक उदाहरणों के लिए देखें [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)।

इस हमले का एक विशेष रूप है **टूल पॉइज़निंग**। इसमें, हमलावर MCP टूल्स के मेटाडेटा (जैसे टूल विवरण या पैरामीटर) में दुर्भावनापूर्ण निर्देश इंजेक्ट करते हैं। चूंकि बड़े भाषा मॉडल (LLMs) इस मेटाडेटा पर निर्भर करते हैं यह तय करने के लिए कि कौन से टूल कॉल करने हैं, समझौता किए गए विवरण मॉडल को अनधिकृत टूल कॉल करने या सुरक्षा नियंत्रणों को बायपास करने के लिए धोखा दे सकते हैं। ये हेरफेर अक्सर अंतिम उपयोगकर्ताओं के लिए अदृश्य होते हैं लेकिन AI सिस्टम द्वारा समझे और क्रियान्वित किए जाते हैं। यह जोखिम होस्ट किए गए MCP सर्वर वातावरण में और बढ़ जाता है, जहाँ टूल परिभाषाओं को उपयोगकर्ता की स्वीकृति के बाद अपडेट किया जा सकता है—जिसे कभी-कभी "[रग पुल](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)" कहा जाता है। ऐसे मामलों में, एक टूल जो पहले सुरक्षित था, बाद में दुर्भावनापूर्ण कार्य करने के लिए संशोधित किया जा सकता है, जैसे डेटा चोरी या सिस्टम व्यवहार में बदलाव, बिना उपयोगकर्ता की जानकारी के। इस हमले के बारे में अधिक जानने के लिए देखें [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)।

![tool-injection-lg-2048x1239 (1)](../../../translated_images/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.hi.png)

## जोखिम  
अनचाहे AI कार्य विभिन्न सुरक्षा जोखिम प्रस्तुत करते हैं जिनमें डेटा चोरी और गोपनीयता उल्लंघन शामिल हैं।

### निवारक नियंत्रण  
### अप्रत्यक्ष प्रॉम्प्ट इंजेक्शन हमलों से बचाव के लिए प्रॉम्प्ट शील्ड्स का उपयोग
-----------------------------------------------------------------------------

**AI प्रॉम्प्ट शील्ड्स** Microsoft द्वारा विकसित एक समाधान है जो सीधे और अप्रत्यक्ष दोनों प्रकार के प्रॉम्प्ट इंजेक्शन हमलों से रक्षा करता है। ये निम्नलिखित तरीकों से मदद करते हैं:

1.  **पता लगाना और फ़िल्टरिंग:** प्रॉम्प्ट शील्ड्स उन्नत मशीन लर्निंग एल्गोरिदम और प्राकृतिक भाषा प्रसंस्करण का उपयोग करके दस्तावेज़ों, वेब पेजों, या ईमेल जैसी बाहरी सामग्री में छिपे दुर्भावनापूर्ण निर्देशों का पता लगाते और उन्हें फ़िल्टर करते हैं।
    
2.  **स्पॉटलाइटिंग:** यह तकनीक AI सिस्टम को वैध सिस्टम निर्देशों और संभावित अविश्वसनीय बाहरी इनपुट के बीच अंतर करने में मदद करती है। इनपुट टेक्स्ट को इस तरह परिवर्तित करके जो मॉडल के लिए अधिक प्रासंगिक हो, स्पॉटलाइटिंग सुनिश्चित करता है कि AI दुर्भावनापूर्ण निर्देशों की बेहतर पहचान कर सके और उन्हें नजरअंदाज कर सके।
    
3.  **डिलिमीटर्स और डाटामार्किंग:** सिस्टम संदेश में डिलिमीटर्स शामिल करना स्पष्ट रूप से इनपुट टेक्स्ट के स्थान को दर्श
confused deputy समस्या एक सुरक्षा कमजोरी है जो तब होती है जब एक MCP सर्वर MCP क्लाइंट्स और थर्ड-पार्टी APIs के बीच एक प्रॉक्सी के रूप में कार्य करता है। यह कमजोरी तब उत्पन्न होती है जब MCP सर्वर एक स्थिर क्लाइंट ID का उपयोग करके थर्ड-पार्टी ऑथराइजेशन सर्वर के साथ प्रमाणित करता है, जो डायनामिक क्लाइंट रजिस्ट्रेशन का समर्थन नहीं करता।

### जोखिम

- **कुकी-आधारित सहमति बायपास**: यदि उपयोगकर्ता पहले MCP प्रॉक्सी सर्वर के माध्यम से प्रमाणित हो चुका है, तो थर्ड-पार्टी ऑथराइजेशन सर्वर उपयोगकर्ता के ब्राउज़र में एक सहमति कुकी सेट कर सकता है। एक हमलावर बाद में इसका फायदा उठाकर उपयोगकर्ता को एक दुर्भावनापूर्ण लिंक भेज सकता है जिसमें एक कस्टम ऑथराइजेशन अनुरोध होता है, जिसमें एक दुर्भावनापूर्ण रीडायरेक्ट URI शामिल होता है।
- **ऑथराइजेशन कोड चोरी**: जब उपयोगकर्ता उस दुर्भावनापूर्ण लिंक पर क्लिक करता है, तो थर्ड-पार्टी ऑथराइजेशन सर्वर मौजूदा कुकी के कारण सहमति स्क्रीन को छोड़ सकता है, और ऑथराइजेशन कोड हमलावर के सर्वर पर रीडायरेक्ट हो सकता है।
- **अनधिकृत API एक्सेस**: हमलावर चोरी किए गए ऑथराइजेशन कोड को एक्सेस टोकन में बदल सकता है और उपयोगकर्ता की नकल करके थर्ड-पार्टी API तक बिना स्पष्ट अनुमति के पहुंच सकता है।

### रोकथाम के उपाय

- **स्पष्ट सहमति आवश्यकताएं**: स्थिर क्लाइंट IDs का उपयोग करने वाले MCP प्रॉक्सी सर्वर **प्रत्येक डायनामिक रूप से रजिस्टर्ड क्लाइंट के लिए उपयोगकर्ता की सहमति प्राप्त करना अनिवार्य है** इससे पहले कि वे थर्ड-पार्टी ऑथराइजेशन सर्वर को फॉरवर्ड करें।
- **सही OAuth कार्यान्वयन**: OAuth 2.1 सुरक्षा सर्वोत्तम प्रथाओं का पालन करें, जिसमें ऑथराइजेशन अनुरोधों के लिए कोड चैलेंज (PKCE) का उपयोग शामिल है ताकि इंटरसेप्शन हमलों को रोका जा सके।
- **क्लाइंट सत्यापन**: दुर्भावनापूर्ण अभिनेताओं द्वारा शोषण को रोकने के लिए रीडायरेक्ट URI और क्लाइंट पहचानकर्ताओं का कड़ाई से सत्यापन करें।

# Token Passthrough Vulnerabilities

### समस्या विवरण

"Token passthrough" एक एंटी-पैटर्न है जहां MCP सर्वर MCP क्लाइंट से टोकन स्वीकार करता है बिना यह सत्यापित किए कि टोकन सही ढंग से MCP सर्वर के लिए जारी किए गए हैं, और फिर उन्हें डाउनस्ट्रीम APIs को "पास" कर देता है। यह अभ्यास स्पष्ट रूप से MCP ऑथराइजेशन विनिर्देशन का उल्लंघन करता है और गंभीर सुरक्षा जोखिम पैदा करता है।

### जोखिम

- **सुरक्षा नियंत्रणों की परहेज़**: यदि क्लाइंट बिना उचित सत्यापन के सीधे डाउनस्ट्रीम APIs के साथ टोकन का उपयोग कर सकते हैं, तो वे महत्वपूर्ण सुरक्षा नियंत्रण जैसे रेट लिमिटिंग, अनुरोध सत्यापन, या ट्रैफिक मॉनिटरिंग को बायपास कर सकते हैं।
- **जवाबदेही और ऑडिट ट्रेल समस्याएं**: जब क्लाइंट अपस्ट्रीम जारी किए गए एक्सेस टोकन का उपयोग करते हैं, तो MCP सर्वर क्लाइंट्स की पहचान या भेदभाव करने में असमर्थ होगा, जिससे घटना जांच और ऑडिटिंग कठिन हो जाएगी।
- **डेटा चोरी**: यदि टोकन बिना उचित क्लेम सत्यापन के पास किए जाते हैं, तो एक दुर्भावनापूर्ण अभिनेता चोरी किए गए टोकन के साथ सर्वर का उपयोग डेटा चोरी के लिए प्रॉक्सी के रूप में कर सकता है।
- **ट्रस्ट बाउंड्री उल्लंघन**: डाउनस्ट्रीम रिसोर्स सर्वर विशिष्ट संस्थाओं को उनके मूल या व्यवहार पैटर्न के आधार पर ट्रस्ट देते हैं। इस ट्रस्ट बाउंड्री को तोड़ना अप्रत्याशित सुरक्षा समस्याओं को जन्म दे सकता है।
- **मल्टी-सर्विस टोकन दुरुपयोग**: यदि टोकन कई सेवाओं द्वारा बिना उचित सत्यापन के स्वीकार किए जाते हैं, तो एक हमलावर जो एक सेवा को समझौता करता है, वह टोकन का उपयोग अन्य कनेक्टेड सेवाओं तक पहुंचने के लिए कर सकता है।

### रोकथाम के उपाय

- **टोकन सत्यापन**: MCP सर्वर **कभी भी** ऐसे टोकन स्वीकार नहीं करेंगे जो स्पष्ट रूप से MCP सर्वर के लिए जारी नहीं किए गए हों।
- **ऑडियंस सत्यापन**: हमेशा सत्यापित करें कि टोकन में सही ऑडियंस क्लेम है जो MCP सर्वर की पहचान से मेल खाता हो।
- **सही टोकन जीवनचक्र प्रबंधन**: टोकन चोरी और दुरुपयोग के जोखिम को कम करने के लिए अल्पकालिक एक्सेस टोकन और उचित टोकन रोटेशन प्रथाओं को लागू करें।

# Session Hijacking

### समस्या विवरण

सेशन हाईजैकिंग एक हमला है जिसमें क्लाइंट को सर्वर द्वारा एक सेशन ID दिया जाता है, और एक अनधिकृत पार्टी उसी सेशन ID को प्राप्त करके मूल क्लाइंट की नकल करती है और उनके नाम पर अनधिकृत क्रियाएं करती है। यह विशेष रूप से स्टेटफुल HTTP सर्वरों में चिंता का विषय है जो MCP अनुरोधों को संभालते हैं।

### जोखिम

- **सेशन हाईजैक प्रॉम्प्ट इंजेक्शन**: जो हमलावर सेशन ID प्राप्त करता है, वह उस सर्वर को दुर्भावनापूर्ण इवेंट भेज सकता है जो क्लाइंट के जुड़े सर्वर के साथ सेशन स्टेट साझा करता है, जिससे हानिकारक क्रियाएं हो सकती हैं या संवेदनशील डेटा तक पहुंच हो सकती है।
- **सेशन हाईजैक नकल**: चोरी किए गए सेशन ID के साथ हमलावर सीधे MCP सर्वर को कॉल कर सकता है, प्रमाणीकरण को बायपास करते हुए और वैध उपयोगकर्ता के रूप में व्यवहार करता है।
- **समाप्त/पुनः आरंभ योग्य स्ट्रीम्स का समझौता**: जब सर्वर पुनः डिलीवरी/पुनः आरंभ योग्य स्ट्रीम्स का समर्थन करता है, तो हमलावर अनुरोध को समय से पहले समाप्त कर सकता है, जिससे इसे बाद में मूल क्लाइंट द्वारा संभावित रूप से दुर्भावनापूर्ण सामग्री के साथ पुनः आरंभ किया जा सकता है।

### रोकथाम के उपाय

- **ऑथराइजेशन सत्यापन**: जो MCP सर्वर ऑथराइजेशन लागू करते हैं, उन्हें सभी इनबाउंड अनुरोधों का सत्यापन करना चाहिए और **प्रमाणीकरण के लिए सेशन्स का उपयोग नहीं करना चाहिए**।
- **सुरक्षित सेशन IDs**: MCP सर्वर को सुरक्षित, गैर-निर्धारित सेशन IDs का उपयोग करना चाहिए जो सुरक्षित रैंडम नंबर जनरेटर से उत्पन्न हों। पूर्वानुमेय या अनुक्रमिक पहचानकर्ताओं से बचें।
- **उपयोगकर्ता-विशिष्ट सेशन बाइंडिंग**: MCP सर्वर को सेशन IDs को उपयोगकर्ता-विशिष्ट जानकारी से बांधना चाहिए, जैसे कि `<user_id>:<session_id>` फॉर्मेट में, जो अधिक सुरक्षा प्रदान करता है।
- **सेशन समाप्ति**: यदि सेशन ID समझौता हो जाता है तो जोखिम को सीमित करने के लिए उचित सेशन समाप्ति और रोटेशन लागू करें।
- **ट्रांसपोर्ट सुरक्षा**: सेशन ID इंटरसेप्शन को रोकने के लिए सभी संचार के लिए हमेशा HTTPS का उपयोग करें।

# Supply chain security

सप्लाई चेन सुरक्षा AI युग में भी मौलिक बनी हुई है, लेकिन आपकी सप्लाई चेन की परिभाषा का दायरा बढ़ गया है। पारंपरिक कोड पैकेजों के अलावा, अब आपको सभी AI-संबंधित घटकों जैसे फाउंडेशन मॉडल, एम्बेडिंग सेवाएं, कॉन्टेक्स्ट प्रोवाइडर, और थर्ड-पार्टी APIs की कड़ी जांच और निगरानी करनी होगी। यदि इन्हें सही तरीके से प्रबंधित नहीं किया गया तो ये कमजोरियां या जोखिम पैदा कर सकते हैं।

**AI और MCP के लिए प्रमुख सप्लाई चेन सुरक्षा प्रथाएं:**
- **इंटीग्रेशन से पहले सभी घटकों का सत्यापन करें:** इसमें केवल ओपन-सोर्स लाइब्रेरी ही नहीं, बल्कि AI मॉडल, डेटा स्रोत, और बाहरी APIs भी शामिल हैं। हमेशा प्रामाणिकता, लाइसेंसिंग, और ज्ञात कमजोरियों की जांच करें।
- **सुरक्षित डिप्लॉयमेंट पाइपलाइनों को बनाए रखें:** स्वचालित CI/CD पाइपलाइनों का उपयोग करें जिनमें सुरक्षा स्कैनिंग शामिल हो ताकि समस्याओं का जल्दी पता चल सके। सुनिश्चित करें कि केवल विश्वसनीय आर्टिफैक्ट्स ही प्रोडक्शन में डिप्लॉय हों।
- **लगातार निगरानी और ऑडिट करें:** सभी निर्भरताओं, मॉडल और डेटा सेवाओं सहित, के लिए निरंतर निगरानी लागू करें ताकि नई कमजोरियों या सप्लाई चेन हमलों का पता चल सके।
- **न्यूनतम विशेषाधिकार और एक्सेस नियंत्रण लागू करें:** मॉडल, डेटा, और सेवाओं तक पहुंच केवल MCP सर्वर के कामकाज के लिए आवश्यक हो, इसे सीमित करें।
- **खतरों का त्वरित जवाब दें:** समझौता किए गए घटकों को पैच करने या बदलने, और यदि उल्लंघन पाया जाए तो सीक्रेट्स या क्रेडेंशियल्स को रोटेट करने की प्रक्रिया रखें।

[GitHub Advanced Security](https://github.com/security/advanced-security) में सीक्रेट स्कैनिंग, डिपेंडेंसी स्कैनिंग, और CodeQL विश्लेषण जैसी सुविधाएं हैं। ये टूल्स [Azure DevOps](https://azure.microsoft.com/en-us/products/devops) और [Azure Repos](https://azure.microsoft.com/en-us/products/devops/repos/) के साथ इंटीग्रेट होकर कोड और AI सप्लाई चेन दोनों में कमजोरियों की पहचान और रोकथाम में मदद करते हैं।

Microsoft भी आंतरिक रूप से सभी उत्पादों के लिए व्यापक सप्लाई चेन सुरक्षा प्रथाओं को लागू करता है। अधिक जानने के लिए देखें [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)।

# Established security best practices that will uplift your MCP implementation's security posture

कोई भी MCP कार्यान्वयन उस संगठन के मौजूदा सुरक्षा ढांचे को अपनाता है जिस पर वह आधारित है, इसलिए जब आप MCP को अपने समग्र AI सिस्टम का हिस्सा मानकर उसकी सुरक्षा पर विचार करें, तो यह सलाह दी जाती है कि आप अपने मौजूदा सुरक्षा स्तर को बेहतर बनाएं। निम्नलिखित स्थापित सुरक्षा नियंत्रण विशेष रूप से प्रासंगिक हैं:

-   आपके AI एप्लिकेशन में सुरक्षित कोडिंग सर्वोत्तम प्रथाएं - [OWASP Top 10](https://owasp.org/www-project-top-ten/), [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559) के खिलाफ सुरक्षा, सीक्रेट्स और टोकन के लिए सुरक्षित वॉल्ट का उपयोग, सभी एप्लिकेशन घटकों के बीच एंड-टू-एंड सुरक्षित संचार लागू करना आदि।
-   सर्वर हार्डनिंग -- जहां संभव हो MFA का उपयोग करें, पैचिंग को अपडेट रखें, सर्वर को थर्ड पार्टी पहचान प्रदाता के साथ एकीकृत करें आदि।
-   डिवाइस, इन्फ्रास्ट्रक्चर और एप्लिकेशन को पैच के साथ अपडेट रखें।
-   सुरक्षा निगरानी -- AI एप्लिकेशन (जिसमें MCP क्लाइंट/सर्वर शामिल हैं) के लॉगिंग और मॉनिटरिंग को लागू करें और उन लॉग्स को केंद्रीय SIEM में भेजें ताकि असामान्य गतिविधियों का पता चल सके।
-   ज़ीरो ट्रस्ट आर्किटेक्चर -- नेटवर्क और पहचान नियंत्रणों के माध्यम से घटकों को तार्किक रूप से अलग करना ताकि यदि AI एप्लिकेशन समझौता हो जाए तो पार्श्वीय आंदोलन को कम किया जा सके।

# Key Takeaways

- सुरक्षा के मूल सिद्धांत महत्वपूर्ण बने हुए हैं: सुरक्षित कोडिंग, न्यूनतम विशेषाधिकार, सप्लाई चेन सत्यापन, और निरंतर निगरानी MCP और AI वर्कलोड के लिए आवश्यक हैं।
- MCP नए जोखिम लाता है—जैसे प्रॉम्प्ट इंजेक्शन, टूल पॉइज़निंग, सेशन हाईजैकिंग, confused deputy समस्याएं, टोकन पासथ्रू कमजोरियां, और अत्यधिक अनुमतियां—जो पारंपरिक और AI-विशिष्ट नियंत्रण दोनों की मांग करते हैं।
- मजबूत प्रमाणीकरण, प्राधिकरण, और टोकन प्रबंधन प्रथाओं का उपयोग करें, जहां संभव हो Microsoft Entra ID जैसे बाहरी पहचान प्रदाताओं का लाभ उठाएं।
- अप्रत्यक्ष प्रॉम्प्ट इंजेक्शन और टूल पॉइज़निंग से बचाव के लिए टूल मेटाडेटा का सत्यापन करें, डायनामिक परिवर्तनों की निगरानी करें, और Microsoft Prompt Shields जैसे समाधान का उपयोग करें।
- सुरक्षित सेशन प्रबंधन लागू करें, जिसमें गैर-निर्धारित सेशन IDs का उपयोग, सेशन्स को उपयोगकर्ता पहचान से बांधना, और प्रमाणीकरण के लिए सेशन्स का कभी उपयोग न करना शामिल है।
- confused deputy हमलों को रोकने के लिए प्रत्येक डायनामिक रूप से रजिस्टर्ड क्लाइंट के लिए स्पष्ट उपयोगकर्ता सहमति आवश्यक करें और उचित OAuth सुरक्षा प्रथाओं को लागू करें।
- टोकन पासथ्रू कमजोरियों से बचें, सुनिश्चित करें कि MCP सर्वर केवल उनके लिए स्पष्ट रूप से जारी किए गए टोकन स्वीकार करें और टोकन क्लेम्स का उचित सत्यापन करें।
- अपने AI सप्लाई चेन के सभी घटकों—मॉडल, एम्बेडिंग्स, और कॉन्टेक्स्ट प्रोवाइडर्स सहित—को कोड निर्भरताओं के समान कठोरता से देखें।
- विकसित हो रहे MCP विनिर्देशों के साथ अद्यतित रहें और सुरक्षित मानकों के निर्माण में समुदाय में योगदान दें।

# Additional Resources

## External Resources
- [Microsoft Digital Defense Report](https://aka.ms/mddr)
- [MCP Specification](https://spec.modelcontextprotocol.io/)
- [MCP Security Best Practices](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices)
- [MCP Authorization Specification](https://modelcontextprotocol.io/specification/draft/basic/authorization)
- [OAuth 2.0 Security Best Practices (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)
- [Prompt Injection in MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- [Tool Poisoning Attacks (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- [Rug Pulls in MCP (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)
- [Prompt Shields Documentation (Microsoft)](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [GitHub Advanced Security](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [Secure Least-Privileged Access (Microsoft)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Best Practices for Token Validation and Lifetime](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [Use Secure Token Storage and Encrypt Tokens (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [Azure API Management as Auth Gateway for MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Using Microsoft Entra ID to Authenticate with MCP Servers](https://den.dev/blog/mcp-server-auth-entra-id-session/)

## Additional Security Documents

अधिक विस्तृत सुरक्षा मार्गदर्शन के लिए, कृपया इन दस्तावेज़ों को देखें:

- [MCP Security Best Practices 2025](./mcp-security-best-practices-2025.md) - MCP कार्यान्वयन के लिए व्यापक सुरक्षा सर्वोत्तम प्रथाओं की सूची
- [Azure Content Safety Implementation](./azure-content-safety-implementation.md) - MCP सर्वरों के साथ Azure Content Safety को एकीकृत करने के उदाहरण
- [MCP Security Controls 2025](./mcp-security-controls-2025.md) - MCP तैनाती की सुरक्षा के लिए नवीनतम नियंत्रण और तकनीकें
- [MCP Best Practices](./mcp-best-practices.md) - MCP सुरक्षा के लिए त्वरित संदर्भ गाइड

### Next 

Next: [Chapter 3: Getting Started](../03-GettingStarted/README.md)

**अस्वीकरण**:  
यह दस्तावेज़ AI अनुवाद सेवा [Co-op Translator](https://github.com/Azure/co-op-translator) का उपयोग करके अनुवादित किया गया है। जबकि हम सटीकता के लिए प्रयासरत हैं, कृपया ध्यान दें कि स्वचालित अनुवादों में त्रुटियाँ या अशुद्धियाँ हो सकती हैं। मूल दस्तावेज़ अपनी मूल भाषा में ही अधिकारिक स्रोत माना जाना चाहिए। महत्वपूर्ण जानकारी के लिए, पेशेवर मानव अनुवाद की सलाह दी जाती है। इस अनुवाद के उपयोग से उत्पन्न किसी भी गलतफहमी या गलत व्याख्या के लिए हम जिम्मेदार नहीं हैं।
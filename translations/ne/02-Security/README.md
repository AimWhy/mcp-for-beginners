<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "382fddb4ee4d9c1bdc806e2ee99b70c8",
  "translation_date": "2025-07-17T00:39:52+00:00",
  "source_file": "02-Security/README.md",
  "language_code": "ne"
}
-->
# सुरक्षा सर्वोत्तम अभ्यासहरू

Model Context Protocol (MCP) अपनाउँदा AI-चालित अनुप्रयोगहरूमा शक्तिशाली नयाँ क्षमताहरू आउँछन्, तर यसले परम्परागत सफ्टवेयर जोखिमहरू भन्दा फरक र अनौठा सुरक्षा चुनौतीहरू पनि ल्याउँछ। सुरक्षित कोडिङ, न्यूनतम अधिकार, र आपूर्ति श्रृंखला सुरक्षा जस्ता स्थापित चिन्ताहरूका साथै, MCP र AI कार्यभारहरूले नयाँ खतराहरू जस्तै prompt injection, tool poisoning, dynamic tool modification, session hijacking, confused deputy आक्रमणहरू, र token passthrough कमजोरीहरू सामना गर्छन्। यी जोखिमहरू उचित रूपमा व्यवस्थापन नगरिएमा डेटा चोरी, गोपनीयता उल्लंघन, र अनपेक्षित प्रणाली व्यवहार निम्त्याउन सक्छन्।

यस पाठले MCP सँग सम्बन्धित सबैभन्दा महत्वपूर्ण सुरक्षा जोखिमहरू — प्रमाणीकरण, प्राधिकरण, अत्यधिक अनुमति, अप्रत्यक्ष prompt injection, सत्र सुरक्षा, confused deputy समस्या, token passthrough कमजोरीहरू, र आपूर्ति श्रृंखला कमजोरीहरू — को अन्वेषण गर्दछ र तिनीहरूलाई कम गर्नका लागि कार्यान्वयन योग्य नियन्त्रणहरू र सर्वोत्तम अभ्यासहरू प्रदान गर्दछ। तपाईंले Microsoft का समाधानहरू जस्तै Prompt Shields, Azure Content Safety, र GitHub Advanced Security कसरी प्रयोग गर्ने सिक्नुहुनेछ जसले तपाईंको MCP कार्यान्वयनलाई बलियो बनाउँछ। यी नियन्त्रणहरू बुझेर र लागू गरेर, तपाईं सुरक्षा उल्लंघनको सम्भावना उल्लेखनीय रूपमा घटाउन सक्नुहुन्छ र तपाईंका AI प्रणालीहरूलाई बलियो र भरपर्दो बनाउन सक्नुहुन्छ।

# सिकाइ उद्देश्यहरू

यस पाठको अन्त्यसम्म, तपाईं सक्षम हुनुहुनेछ:

- Model Context Protocol (MCP) द्वारा ल्याइएका अनौठा सुरक्षा जोखिमहरू पहिचान र व्याख्या गर्न, जस्तै prompt injection, tool poisoning, अत्यधिक अनुमति, session hijacking, confused deputy समस्या, token passthrough कमजोरीहरू, र आपूर्ति श्रृंखला कमजोरीहरू।
- MCP सुरक्षा जोखिमहरूका लागि प्रभावकारी नियन्त्रणहरू लागू गर्न, जस्तै बलियो प्रमाणीकरण, न्यूनतम अधिकार, सुरक्षित token व्यवस्थापन, सत्र सुरक्षा नियन्त्रणहरू, र आपूर्ति श्रृंखला प्रमाणीकरण।
- Microsoft का समाधानहरू जस्तै Prompt Shields, Azure Content Safety, र GitHub Advanced Security लाई MCP र AI कार्यभारहरूको सुरक्षा गर्न कसरी प्रयोग गर्ने बुझ्न र उपयोग गर्न।
- उपकरण मेटाडाटा प्रमाणीकरणको महत्त्व, गतिशील परिवर्तनहरूको अनुगमन, अप्रत्यक्ष prompt injection आक्रमणहरू विरुद्ध सुरक्षा, र session hijacking रोकथामको महत्त्व बुझ्न।
- स्थापित सुरक्षा सर्वोत्तम अभ्यासहरू — जस्तै सुरक्षित कोडिङ, सर्भर कडा बनाउने, र zero trust वास्तुकला — लाई तपाईंको MCP कार्यान्वयनमा समावेश गरेर सुरक्षा उल्लंघनको सम्भावना र प्रभाव कम गर्न।

# MCP सुरक्षा नियन्त्रणहरू

कुनै पनि प्रणाली जसले महत्वपूर्ण स्रोतहरूमा पहुँच राख्छ, त्यसमा सुरक्षा चुनौतीहरू हुन्छन्। सुरक्षा चुनौतीहरू सामान्यतया आधारभूत सुरक्षा नियन्त्रण र अवधारणाहरूको सही प्रयोगबाट समाधान गर्न सकिन्छ। MCP नयाँ परिभाषित भएकोले, यसको विशिष्टता छिटो परिवर्तन हुँदैछ र प्रोटोकल विकास हुँदैछ। अन्ततः यसमा रहेका सुरक्षा नियन्त्रणहरू परिपक्व हुनेछन्, जसले उद्यम र स्थापित सुरक्षा वास्तुकला र सर्वोत्तम अभ्यासहरूसँग राम्रो एकीकरण सक्षम पार्नेछ।

[Microsoft Digital Defense Report](https://aka.ms/mddr) मा प्रकाशित अनुसन्धानले देखाउँछ कि ९८% रिपोर्ट गरिएका उल्लंघनहरू बलियो सुरक्षा स्वच्छता द्वारा रोक्न सकिन्छ र कुनै पनि प्रकारको उल्लंघन विरुद्धको सबैभन्दा राम्रो सुरक्षा भनेको आधारभूत सुरक्षा स्वच्छता, सुरक्षित कोडिङ सर्वोत्तम अभ्यासहरू, र आपूर्ति श्रृंखला सुरक्षा सही तरिकाले लागू गर्नु हो — ती परीक्षण गरिएका अभ्यासहरूले अझै पनि सुरक्षा जोखिम घटाउन सबैभन्दा ठूलो प्रभाव पार्छन्।

MCP अपनाउँदा सुरक्षा जोखिमहरू कसरी सम्बोधन गर्न सकिन्छ भन्ने केही तरिकाहरू हेरौं।

> **Note:** तलको जानकारी **२९ मे २०२५** सम्म सही छ। MCP प्रोटोकल निरन्तर विकास हुँदैछ, र भविष्यका कार्यान्वयनहरूले नयाँ प्रमाणीकरण ढाँचा र नियन्त्रणहरू ल्याउन सक्छन्। नवीनतम अपडेट र मार्गनिर्देशनका लागि सधैं [MCP Specification](https://spec.modelcontextprotocol.io/) र आधिकारिक [MCP GitHub repository](https://github.com/modelcontextprotocol) र [security best practice page](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices) हेर्नुहोस्।

### समस्या विवरण  
मूल MCP विशिष्टताले विकासकर्ताहरूले आफ्नै प्रमाणीकरण सर्भर लेख्ने अपेक्षा गरेको थियो। यसका लागि OAuth र सम्बन्धित सुरक्षा प्रतिबन्धहरूको ज्ञान आवश्यक थियो। MCP सर्भरहरूले OAuth 2.0 Authorization Server को रूपमा काम गर्थे, आवश्यक प्रयोगकर्ता प्रमाणीकरण सिधै व्यवस्थापन गर्थे, बाह्य सेवा जस्तै Microsoft Entra ID लाई जिम्मा नदिई। **२६ अप्रिल २०२५** देखि, MCP विशिष्टतामा अपडेटले MCP सर्भरहरूलाई प्रयोगकर्ता प्रमाणीकरण बाह्य सेवामा सुम्पन अनुमति दिन्छ।

### जोखिमहरू
- MCP सर्भरमा गलत कन्फिगर गरिएको प्राधिकरण तर्कले संवेदनशील डेटा खुलासा र गलत पहुँच नियन्त्रणहरू लागू हुन सक्छन्।
- स्थानीय MCP सर्भरमा OAuth token चोरी। चोरी भएमा, त्यो token प्रयोग गरेर MCP सर्भरको नक्कली परिचय बनाएर सेवा र स्रोतहरूमा पहुँच गर्न सकिन्छ।

#### Token Passthrough
Token passthrough प्राधिकरण विशिष्टतामा स्पष्ट रूपमा निषेध गरिएको छ किनभने यसले धेरै सुरक्षा जोखिमहरू ल्याउँछ, जसमध्ये:

#### सुरक्षा नियन्त्रण बाइपास
MCP सर्भर वा डाउनस्ट्रीम API हरूले token audience वा अन्य प्रमाणपत्र प्रतिबन्धहरूमा निर्भर गर्दै rate limiting, अनुरोध प्रमाणीकरण, वा ट्राफिक अनुगमन जस्ता महत्वपूर्ण सुरक्षा नियन्त्रणहरू लागू गर्न सक्छन्। यदि क्लाइन्टहरूले MCP सर्भरले सही रूपमा प्रमाणीकरण नगरेका token हरू सिधै डाउनस्ट्रीम API हरूमा प्रयोग गर्न सक्छन् भने, तिनीहरूले यी नियन्त्रणहरूलाई बाइपास गर्छन्।

#### जवाफदेहिता र अडिट ट्रेल समस्या
जब क्लाइन्टहरूले upstream-इश्यू गरिएको access token प्रयोग गरेर कल गर्छन् जुन MCP सर्भरका लागि अस्पष्ट हुन सक्छ, MCP सर्भरले क्लाइन्टहरूलाई छुट्याउन सक्दैन।
डाउनस्ट्रीम Resource Server का लगहरूमा अनुरोधहरू फरक स्रोत वा पहिचानबाट आएको देखिन सक्छ, जुन वास्तवमा token फर्वार्ड गर्ने MCP सर्भर होइन।
यी दुबै पक्षले घटना अनुसन्धान, नियन्त्रण, र अडिटिङलाई कठिन बनाउँछ।
यदि MCP सर्भरले token का दाबीहरू (जस्तै भूमिका, अधिकार, वा audience) वा अन्य मेटाडाटा प्रमाणीकरण नगरी token पास गर्छ भने, चोरी गरिएको token भएको दुष्टले सर्भरलाई डेटा चोरीको प्रोक्सीको रूपमा प्रयोग गर्न सक्छ।

#### विश्वास सीमा समस्या
डाउनस्ट्रीम Resource Server ले विशिष्ट संस्थाहरूलाई विश्वास दिन्छ। यो विश्वासले उत्पत्ति वा क्लाइन्ट व्यवहारको अनुमान समावेश गर्न सक्छ। यो विश्वास सीमा भंग हुँदा अनपेक्षित समस्या आउन सक्छ।
यदि token धेरै सेवाहरूले उचित प्रमाणीकरण बिना स्वीकार्छ भने, एक सेवा भंग गर्ने आक्रमणकारीले त्यो token प्रयोग गरेर अन्य जडित सेवाहरूमा पहुँच गर्न सक्छ।

#### भविष्यको अनुकूलता जोखिम
आज MCP सर्भर "शुद्ध प्रोक्सी" को रूपमा सुरु भए पनि, पछि सुरक्षा नियन्त्रणहरू थप्न आवश्यक पर्न सक्छ। उचित token audience पृथक्करणले सुरक्षा मोडेल विकास गर्न सजिलो बनाउँछ।

### नियन्त्रणहरू

**MCP सर्भरहरूले त्यस्ता token हरू स्वीकार गर्नु हुँदैन जुन स्पष्ट रूपमा MCP सर्भरका लागि जारी गरिएको छैनन्**

- **प्राधिकरण तर्क समीक्षा र कडा बनाउने:** तपाईंको MCP सर्भरको प्राधिकरण कार्यान्वयन सावधानीपूर्वक अडिट गर्नुहोस् ताकि मात्र इच्छित प्रयोगकर्ता र क्लाइन्टहरूले संवेदनशील स्रोतहरूमा पहुँच पाउन सकून्। व्यवहारिक मार्गनिर्देशनका लागि [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) र [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/) हेर्नुहोस्।
- **सुरक्षित token अभ्यासहरू लागू गर्ने:** पहुँच token को दुरुपयोग रोक्न र token replay वा चोरीको जोखिम घटाउन [Microsoft का token प्रमाणीकरण र अवधि सम्बन्धी सर्वोत्तम अभ्यासहरू](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens) पालना गर्नुहोस्।
- **Token भण्डारण सुरक्षा गर्ने:** token हरूलाई सधैं सुरक्षित रूपमा भण्डारण गर्नुहोस् र विश्राम र ट्रान्जिटमा इन्क्रिप्सन प्रयोग गर्नुहोस्। कार्यान्वयन सुझावका लागि [Use secure token storage and encrypt tokens](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2) हेर्नुहोस्।

# MCP सर्भरहरूको लागि अत्यधिक अनुमति

### समस्या विवरण
MCP सर्भरहरूलाई सेवा/स्रोतमा अत्यधिक अनुमति दिइएको हुन सक्छ। उदाहरणका लागि, AI बिक्री अनुप्रयोगको भाग भएको MCP सर्भरले उद्यम डेटा स्टोरमा पहुँच गर्दा केवल बिक्री डेटा पहुँच गर्न पाउनु पर्छ, स्टोरका सबै फाइलहरूमा होइन। न्यूनतम अधिकारको सिद्धान्त (सबैभन्दा पुरानो सुरक्षा सिद्धान्तहरूमध्ये एक) अनुसार, कुनै स्रोतले आवश्यक भन्दा बढी अनुमति पाउनु हुँदैन। AI ले यो क्षेत्रमा चुनौती थप्छ किनभने यसलाई लचिलो बनाउन आवश्यक अनुमति ठ्याक्कै निर्धारण गर्न गाह्रो हुन्छ।

### जोखिमहरू
- अत्यधिक अनुमति दिँदा MCP सर्भरले पहुँच नपाउनु पर्ने डेटा चोरी वा संशोधन गर्न सक्छ। यदि डेटा व्यक्तिगत पहिचानयोग्य जानकारी (PII) हो भने यो गोपनीयता समस्या पनि हुन सक्छ।

### नियन्त्रणहरू
- **न्यूनतम अधिकारको सिद्धान्त लागू गर्ने:** MCP सर्भरलाई आवश्यक कार्यहरू गर्नका लागि मात्र न्यूनतम अनुमति दिनुहोस्। यी अनुमतिहरू नियमित रूपमा समीक्षा र अपडेट गर्नुहोस् ताकि आवश्यक भन्दा बढी नहोस्। विस्तृत मार्गनिर्देशनका लागि [Secure least-privileged access](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access) हेर्नुहोस्।
- **Role-Based Access Control (RBAC) प्रयोग गर्ने:** MCP सर्भरलाई विशिष्ट स्रोत र कार्यहरूमा कडा रूपमा सीमित भूमिका दिनुहोस्, व्यापक वा अनावश्यक अनुमति नदिनुहोस्।
- **अनुमति अनुगमन र अडिट गर्ने:** अनुमति प्रयोग निरन्तर अनुगमन गर्नुहोस् र पहुँच लगहरू अडिट गरेर अत्यधिक वा प्रयोग नगरिएका अधिकारहरू छिटो पत्ता लगाएर सुधार गर्नुहोस्।

# अप्रत्यक्ष prompt injection आक्रमणहरू

### समस्या विवरण

दुष्ट वा कम्प्रोमाइज्ड MCP सर्भरहरूले ग्राहक डेटा खुलासा गर्ने वा अनपेक्षित कार्यहरू गर्न सक्ने जोखिमहरू ल्याउँछन्। यी जोखिमहरू विशेष गरी AI र MCP-आधारित कार्यभारहरूमा सान्दर्भिक छन्, जहाँ:

- **Prompt Injection आक्रमणहरू**: आक्रमणकारीहरूले prompts वा बाह्य सामग्रीमा दुष्ट निर्देशनहरू समावेश गर्छन्, जसले AI प्रणालीलाई अनपेक्षित कार्यहरू गर्न वा संवेदनशील डेटा चुहाउन बाध्य पार्छ। थप जानकारी: [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **Tool Poisoning**: आक्रमणकारीहरूले उपकरण मेटाडाटा (जस्तै विवरण वा प्यारामिटरहरू) मा हेरफेर गर्छन् जसले AI को व्यवहारलाई प्रभाव पार्छ, सम्भावित रूपमा सुरक्षा नियन्त्रणहरू बाइपास गर्ने वा डेटा चोरी गर्ने। विवरण: [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **Cross-Domain Prompt Injection**: दुष्ट निर्देशनहरू कागजातहरू, वेब पृष्ठहरू, वा इमेलहरूमा समावेश हुन्छन्, जुन AI द्वारा प्रशोधन गर्दा डेटा चुहावट वा हेरफेर हुन्छ।
- **Dynamic Tool Modification (Rug Pulls)**: प्रयोगकर्ताको स्वीकृतिपछि उपकरण परिभाषाहरू परिवर्तन गर्न सकिन्छ, जसले नयाँ दुष्ट व्यवहारहरू परिचय गराउँछ।

यी कमजोरीहरूले MCP सर्भर र उपकरणहरूलाई तपाईंको वातावरणमा एकीकृत गर्दा बलियो प्रमाणीकरण, अनुगमन, र सुरक्षा नियन्त्रणहरूको आवश्यकता देखाउँछन्। थप जानकारीका लागि माथिका लिंकहरू हेर्नुहोस्।

![prompt-injection-lg-2048x1034](../../../translated_images/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.ne.png)

**अप्रत्यक्ष Prompt Injection** (जसलाई cross-domain prompt injection वा XPIA पनि भनिन्छ) जेनेरेटिभ AI प्रणालीहरूमा एक गम्भीर कमजोरी हो, जसमा Model Context Protocol (MCP) पनि समावेश छ। यस आक्रमणमा, दुष्ट निर्देशनहरू बाह्य सामग्रीमा लुकेका हुन्छन् — जस्तै कागजातहरू, वेब पृष्ठहरू, वा इमेलहरू। जब AI प्रणालीले यो सामग्री प्रशोधन गर्छ, तब यसले लुकेको निर्देशनहरूलाई वैध प्रयोगकर्ता आदेशको रूपमा व्याख्या गर्न सक्छ, जसले अनपेक्षित कार्यहरू जस्तै डेटा चुहावट, हानिकारक सामग्री उत्पादन, वा प्रयोगकर्ता अन्तरक्रियाको हेरफेर निम्त्याउन सक्छ। विस्तृत व्याख्या र वास्तविक उदाहरणहरूका लागि [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/) हेर्नुहोस्।

यस आक्रमणको विशेष खतरनाक रूप हो **Tool Poisoning**। यसमा, आक्रमणकारीहरूले MCP उपकरणहरूको मेटाडाटामा (जस्तै उपकरण विवरण वा प्यारामिटरहरू) दुष्ट निर्देशनहरू इन्जेक्ट गर्छन्। ठूलो भाषा मोडेलहरू (LLMs) यी मेटाडाटामा आधारित भएर कुन उपकरण कल गर्ने निर्णय गर्छन्, त्यसैले कम्प्रोमाइज्ड विवरणहरूले मोडेललाई अनधिकृत उपकरण कल गर्न वा सुरक्षा नियन्त्रणहरू बाइपास गर्न प्रलोभन दिन सक्छ। यी हेरफेरहरू प्रायः अन्त प्रयोगकर्तालाई देखिँदैनन् तर AI प्रणालीले व्याख्या गरी कार्यान्वयन गर्न सक्छ। यो जोखिम होस्ट गरिएको MCP सर्भर वातावरणहरूमा अझ बढी हुन्छ, जहाँ उपकरण परिभाषाहरू प्रयोगकर्ताको स्वीकृतिपछि परिवर्तन गर्न सकिन्छ — जसलाई कहिलेकाहीं "[rug pull](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)" भनिन्छ। यस्तो अवस्थामा, पहिले सुरक्षित रहेको उपकरण पछि दुष्ट कार्यहरू गर्न परिवर्तन हुन सक्छ, जस्तै डेटा चोरी वा प्रणाली व्यवहार परिवर्तन, प्रयोगकर्ताको जानकारी बिना। यस आक्रमण विधिको बारेमा थप जान्न [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks) हेर्नुहोस्।

![tool-injection-lg-2048x1239 (1)](../../../translated_images/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.ne.png)

## जोखिमहरू
अनपेक्षित AI कार्यहरूले डेटा चुहावट र गोपनीयता उल्लंघन जस्ता विभिन्न सुरक्षा जोखिमहरू निम्त्याउँछन्।

### नियन्त्रणहरू
### अप्रत्यक्ष Prompt Injection आक्रमणहरू विरुद्ध Prompt Shields प्रयोग गर्ने
-----------------------------------------------------------------------------

**AI Prompt Shields** Microsoft द्वारा विकास गरिएको समाधान हो जसले प्रत्यक्ष र अप्रत्यक्ष prompt injection आक्रमणहरू विरुद्ध सुरक्षा गर्दछ। यसले निम्न तरिकाले मद्दत गर्छ:

1.  **पत्ता लगाउने र फिल्टर गर्ने:** Prompt Shields ले उन्नत मेसिन लर्निङ एल्गोरिदम र प्राकृतिक भाषा प्रशोधन प्रयोग गरेर कागजातहरू, वेब पृष्ठहरू, वा इमेलहरूमा लुकेका दुष्ट निर्देशनहरू पत्ता लगाउँछ र फिल्टर गर्छ।
    
2.  **Spotlighting:** यस प्रविधिले AI प्रणालीलाई वैध प्रणाली निर्देशनहरू र सम्भावित अविश्वसनीय बाह्य इनपुटहरू छुट्याउन मद्दत गर्छ। इनपुट टेक्स्टलाई मोडेलसँग बढी सान्दर्भिक बनाउन परिवर्तन गरेर, Spotlighting ले AI लाई दुष्ट निर्देशनहरू पहिचान गरी बेवास्ता गर्न सक्षम बनाउँछ।
    
3.  **Delimiters र Datamarking:** प्रणाली सन्देशमा delimiters समावेश गरेर इनपुट टेक्स्टको स्थान स्पष्ट पारिन्छ, जसले AI प्रणालीलाई प्रयोगकर्ता इनपुट र सम्भावित हानिकारक बाह्य सामग्री छुट्याउन मद्दत गर्छ। Datamarking ले यो अवधारणा विस्तार गर्दै विश्वासयोग्य र अविश्वसनीय डाटाको सीमाना विशेष मार्करहरू प्रयोग गरेर देखाउँछ।
    
4.  **निरन्तर अनुगमन र अपडेटहरू:** Microsoft ले नयाँ र विकासशील खतराहरूलाई सम्बोधन गर्न Prompt Shields लाई निरन्तर अनुगमन र अपडेट गर्दछ। यस सक्रिय दृष्टिकोणले सुरक्षा उपायहरूलाई नवीनतम आक्रमण प्रविधिहरू विरुद्ध प्रभावकारी राख्छ।
    
5. **Azure Content Safety सँग एकीकरण:** Prompt Shields Azure AI Content Safety सूटको भाग हो, जसले AI अनुप्रयोगहरूमा jailbreak प्रयास, हानिकारक सामग्री, र अन्य सुरक्षा जोखिमहरू पत्ता लगाउन थप उपकरणहरू प्रदान गर्दछ।

AI prompt shields को बारेमा थप पढ्न [Prompt Shields documentation](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection) हेर्नुहोस्।

![prompt-shield-lg-2048x1328](../../../translated_images/prompt-shield.ff5b95be76e9c78c6ec0888206a4a6a0a5ab4bb787832a9eceef7a62fe0138d1.ne.png)

# Confused Deputy समस्या

### समस्या विवरण
भ्रमित डिप्युटी समस्या एउटा सुरक्षा कमजोरी हो जुन तब हुन्छ जब MCP सर्भर MCP क्लाइन्टहरू र तेस्रो-पक्ष API हरूको बीचमा प्रोक्सीको रूपमा काम गर्छ। यो कमजोरी तब दुरुपयोग गर्न सकिन्छ जब MCP सर्भरले तेस्रो-पक्ष प्राधिकरण सर्भरसँग प्रमाणिकरण गर्न स्थिर क्लाइन्ट ID प्रयोग गर्छ जुन गतिशील क्लाइन्ट दर्ता समर्थन गर्दैन।

### जोखिमहरू

- **कुकी-आधारित सहमति बाइपास**: यदि प्रयोगकर्ताले पहिले MCP प्रोक्सी सर्भर मार्फत प्रमाणिकरण गरिसकेको छ भने, तेस्रो-पक्ष प्राधिकरण सर्भरले प्रयोगकर्ताको ब्राउजरमा सहमति कुकी सेट गर्न सक्छ। आक्रमणकारीले पछि यसलाई दुरुपयोग गरेर प्रयोगकर्तालाई दुर्भावनापूर्ण लिंक पठाउन सक्छ जसमा दुर्भावनापूर्ण रिडिरेक्ट URI सहितको प्राधिकरण अनुरोध हुन्छ।
- **प्राधिकरण कोड चोरी**: जब प्रयोगकर्ताले दुर्भावनापूर्ण लिंकमा क्लिक गर्छ, तेस्रो-पक्ष प्राधिकरण सर्भरले अवस्थित कुकीका कारण सहमति स्क्रिन छोड्न सक्छ, र प्राधिकरण कोड आक्रमणकारीको सर्भरमा रिडिरेक्ट हुन सक्छ।
- **अनधिकृत API पहुँच**: आक्रमणकारीले चोरी गरिएको प्राधिकरण कोडलाई एक्सेस टोकनमा परिवर्तन गरी प्रयोगकर्ताको रूपमा नक्कली परिचय बनाएर तेस्रो-पक्ष API मा पहुँच गर्न सक्छ।

### न्यूनीकरण नियन्त्रणहरू

- **स्पष्ट सहमति आवश्यकताहरू**: स्थिर क्लाइन्ट ID प्रयोग गर्ने MCP प्रोक्सी सर्भरहरूले प्रत्येक गतिशील रूपमा दर्ता गरिएको क्लाइन्टका लागि तेस्रो-पक्ष प्राधिकरण सर्भरमा अग्रेषण गर्नु अघि प्रयोगकर्ताको सहमति लिनै पर्छ।
- **उचित OAuth कार्यान्वयन**: OAuth 2.1 सुरक्षा सर्वोत्तम अभ्यासहरू पालना गर्नुहोस्, जसमा प्राधिकरण अनुरोधहरूको लागि कोड चुनौतीहरू (PKCE) प्रयोग गरेर अवरोध आक्रमणहरू रोक्नु समावेश छ।
- **क्लाइन्ट प्रमाणीकरण**: दुर्भावनापूर्ण व्यक्तिहरूबाट दुरुपयोग रोक्न रिडिरेक्ट URI र क्लाइन्ट पहिचानकर्ताहरूको कडाइका साथ प्रमाणीकरण गर्नुहोस्।

# टोकन पासथ्रू कमजोरीहरू

### समस्या विवरण

"टोकन पासथ्रू" एउटा एन्टी-प्याटर्न हो जहाँ MCP सर्भरले MCP क्लाइन्टबाट टोकनहरू स्वीकार्छ तर ती टोकनहरू MCP सर्भरलाई सही रूपमा जारी गरिएको हो कि होइन भनेर प्रमाणीकरण गर्दैन, र त्यसपछि ती टोकनहरूलाई डाउनस्ट्रीम API हरूमा "पास" गर्छ। यो अभ्यासले स्पष्ट रूपमा MCP प्राधिकरण विनिर्देशनको उल्लंघन गर्छ र गम्भीर सुरक्षा जोखिमहरू ल्याउँछ।

### जोखिमहरू

- **सुरक्षा नियन्त्रण बाइपास**: क्लाइन्टहरूले उचित प्रमाणीकरण बिना टोकनहरू सिधै डाउनस्ट्रीम API हरूमा प्रयोग गर्न सक्ने हुँदा महत्वपूर्ण सुरक्षा नियन्त्रणहरू जस्तै दर सीमितीकरण, अनुरोध प्रमाणीकरण, वा ट्राफिक अनुगमन बाइपास गर्न सक्छन्।
- **जवाफदेहिता र अडिट ट्रेल समस्या**: जब क्लाइन्टहरूले माथिल्लो तहबाट जारी गरिएको एक्सेस टोकनहरू प्रयोग गर्छन्, MCP सर्भरले क्लाइन्टहरूलाई छुट्याउन सक्दैन, जसले घटना अनुसन्धान र अडिटलाई कठिन बनाउँछ।
- **डेटा चोरी**: यदि टोकनहरू उचित दाबी प्रमाणीकरण बिना पास गरिन्छ भने, चोरी गरिएको टोकन भएको दुर्भावनापूर्ण व्यक्तिले सर्भरलाई डेटा चोरीको प्रोक्सीको रूपमा प्रयोग गर्न सक्छ।
- **विश्वास सीमा उल्लंघन**: डाउनस्ट्रीम स्रोत सर्भरहरूले विशिष्ट संस्थाहरूलाई उत्पत्ति वा व्यवहारको आधारमा विश्वास दिन्छन्। यो विश्वास सीमा भत्किँदा अप्रत्याशित सुरक्षा समस्या आउन सक्छ।
- **बहु-सेवा टोकन दुरुपयोग**: यदि टोकनहरू धेरै सेवाहरूले बिना प्रमाणीकरण स्वीकार गर्छन् भने, एक सेवा कम्प्रोमाइज हुँदा आक्रमणकारीले त्यो टोकन प्रयोग गरेर अन्य सेवाहरूमा पहुँच गर्न सक्छ।

### न्यूनीकरण नियन्त्रणहरू

- **टोकन प्रमाणीकरण**: MCP सर्भरहरूले केवल ती टोकनहरू स्वीकार्नुपर्छ जुन स्पष्ट रूपमा MCP सर्भरका लागि जारी गरिएको हो।
- **दर्शक प्रमाणीकरण**: टोकनहरूमा सही दर्शक दाबी छ कि छैन भन्ने सधैं प्रमाणीकरण गर्नुहोस् जुन MCP सर्भरको पहिचानसँग मेल खान्छ।
- **उचित टोकन जीवनचक्र व्यवस्थापन**: छोटो अवधिका एक्सेस टोकनहरू र उचित टोकन रोटेशन अभ्यासहरू लागू गरेर टोकन चोरी र दुरुपयोगको जोखिम कम गर्नुहोस्।

# सेसन हाइज्याकिङ

### समस्या विवरण

सेसन हाइज्याकिङ एउटा आक्रमण विधि हो जहाँ सर्भरले क्लाइन्टलाई सेसन ID प्रदान गर्छ, र अनधिकृत पक्षले त्यो सेसन ID प्राप्त गरी प्रयोगकर्ताको रूपमा नक्कली परिचय बनाएर अनधिकृत कार्यहरू गर्न सक्छ। यो विशेष गरी राज्यपूर्ण HTTP सर्भरहरूमा जुन MCP अनुरोधहरू ह्यान्डल गर्छन्, चिन्ताजनक हुन्छ।

### जोखिमहरू

- **सेसन हाइज्याक प्रॉम्प्ट इन्जेक्शन**: सेसन ID प्राप्त आक्रमणकारीले त्यही सेसन स्थिति साझा गर्ने सर्भरमा दुर्भावनापूर्ण घटनाहरू पठाउन सक्छ, जसले हानिकारक कार्यहरू ट्रिगर गर्न वा संवेदनशील डाटा पहुँच गर्न सक्छ।
- **सेसन हाइज्याक नक्कली परिचय**: चोरी गरिएको सेसन ID भएको आक्रमणकारीले सिधै MCP सर्भरमा कल गर्न सक्छ, प्रमाणिकरण बाइपास गरेर वैध प्रयोगकर्ताको रूपमा व्यवहार गरिन्छ।
- **सम्पूर्ण पुनःसञ्चालन स्ट्रीमहरूमा समस्या**: जब सर्भरले पुनःडेलिभरी/पुनःसञ्चालन स्ट्रीमहरू समर्थन गर्छ, आक्रमणकारीले अनुरोधलाई समयभन्दा पहिले रोक्न सक्छ, जसले पछि मूल क्लाइन्टले पुनः सुरु गर्दा सम्भावित दुर्भावनापूर्ण सामग्री ल्याउन सक्छ।

### न्यूनीकरण नियन्त्रणहरू

- **प्राधिकरण प्रमाणीकरण**: प्राधिकरण लागू गर्ने MCP सर्भरहरूले सबै इनबाउन्ड अनुरोधहरू प्रमाणीकरण गर्नुपर्छ र प्रमाणिकरणका लागि सेसनहरू प्रयोग गर्नु हुँदैन।
- **सुरक्षित सेसन ID**: MCP सर्भरहरूले सुरक्षित, गैर-निर्धारित सेसन ID हरू प्रयोग गर्नुपर्छ जुन सुरक्षित र्यान्डम नम्बर जेनेरेटरबाट उत्पन्न हुन्छ। पूर्वानुमानयोग्य वा अनुक्रमिक पहिचानकर्ताहरूबाट बच्नुपर्छ।
- **प्रयोगकर्ता-विशिष्ट सेसन बाइन्डिङ**: MCP सर्भरहरूले सेसन ID लाई प्रयोगकर्ता-विशिष्ट जानकारीसँग बाँध्नुपर्छ, जस्तै `<user_id>:<session_id>` ढाँचामा, जसले अधिक सुरक्षा दिन्छ।
- **सेसन समाप्ति**: सेसन ID कम्प्रोमाइज भएमा जोखिम सीमित गर्न उचित सेसन समाप्ति र रोटेशन लागू गर्नुहोस्।
- **ट्रान्सपोर्ट सुरक्षा**: सेसन ID चोरी रोक्न सबै सञ्चारमा HTTPS प्रयोग गर्नुहोस्।

# सप्लाई चेन सुरक्षा

AI युगमा सप्लाई चेन सुरक्षा अझै पनि आधारभूत छ, तर तपाईंको सप्लाई चेनको दायरा विस्तार भएको छ। परम्परागत कोड प्याकेजहरू बाहेक, अब तपाईंले सबै AI सम्बन्धित कम्पोनेन्टहरू, जस्तै फाउन्डेशन मोडेलहरू, एम्बेडिङ सेवा, सन्दर्भ प्रदायकहरू, र तेस्रो-पक्ष API हरूलाई कडाइका साथ प्रमाणित र अनुगमन गर्नुपर्छ। यी मध्ये कुनै पनि उचित व्यवस्थापन नगरेमा कमजोरी वा जोखिम ल्याउन सक्छ।

**AI र MCP का लागि मुख्य सप्लाई चेन सुरक्षा अभ्यासहरू:**
- **एकीकरण अघि सबै कम्पोनेन्टहरू प्रमाणित गर्नुहोस्:** यसमा खुला स्रोत पुस्तकालयहरू मात्र होइन, AI मोडेलहरू, डाटा स्रोतहरू, र बाह्य API हरू पनि समावेश छन्। सधैं उत्पत्ति, लाइसेन्स, र ज्ञात कमजोरीहरूको जाँच गर्नुहोस्।
- **सुरक्षित डिप्लोयमेन्ट पाइपलाइनहरू कायम राख्नुहोस्:** स्वचालित CI/CD पाइपलाइनहरू प्रयोग गरेर सुरक्षात्मक स्क्यानिङ समावेश गर्नुहोस् ताकि समस्याहरू छिटो पत्ता लागून्। केवल विश्वसनीय आर्टिफ्याक्टहरू उत्पादनमा पठाउनुहोस्।
- **लगातार अनुगमन र अडिट गर्नुहोस्:** सबै निर्भरता, मोडेलहरू र डाटा सेवाहरू सहित, नयाँ कमजोरी वा सप्लाई चेन आक्रमण पत्ता लगाउन निरन्तर अनुगमन लागू गर्नुहोस्।
- **कम्तिमा अधिकार र पहुँच नियन्त्रण लागू गर्नुहोस्:** मोडेलहरू, डाटा, र सेवाहरूमा केवल आवश्यक पहुँच मात्र MCP सर्भरलाई दिनुहोस्।
- **खतरा आएमा छिटो प्रतिक्रिया दिनुहोस्:** कम्प्रोमाइज भएका कम्पोनेन्टहरू मर्मत वा प्रतिस्थापन गर्ने प्रक्रिया राख्नुहोस्, र यदि उल्लंघन पत्ता लाग्यो भने गोप्य जानकारी वा प्रमाणपत्रहरू रोटेट गर्नुहोस्।

[GitHub Advanced Security](https://github.com/security/advanced-security) ले गोप्य स्क्यानिङ, निर्भरता स्क्यानिङ, र CodeQL विश्लेषण जस्ता सुविधाहरू प्रदान गर्छ। यी उपकरणहरू [Azure DevOps](https://azure.microsoft.com/en-us/products/devops) र [Azure Repos](https://azure.microsoft.com/en-us/products/devops/repos/) सँग एकीकृत भएर कोड र AI सप्लाई चेन कम्पोनेन्टहरूमा कमजोरीहरू पहिचान र न्यूनीकरण गर्न मद्दत गर्छन्।

Microsoft ले पनि आफ्ना सबै उत्पादनहरूका लागि व्यापक सप्लाई चेन सुरक्षा अभ्यासहरू आन्तरिक रूपमा लागू गरेको छ। थप जान्न [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/) हेर्नुहोस्।

# स्थापित सुरक्षा सर्वोत्तम अभ्यासहरू जसले तपाईंको MCP कार्यान्वयनको सुरक्षा स्तर उकास्नेछ

कुनै पनि MCP कार्यान्वयनले तपाईंको संस्थाको वातावरणको विद्यमान सुरक्षा स्तरलाई अपनाउँछ जुन यसमा आधारित छ, त्यसैले MCP लाई तपाईंको समग्र AI प्रणालीको एक कम्पोनेन्टको रूपमा हेर्दा तपाईंले आफ्नो समग्र सुरक्षा स्तर उकास्न विचार गर्नु राम्रो हुन्छ। तलका स्थापित सुरक्षा नियन्त्रणहरू विशेष गरी सान्दर्भिक छन्:

- तपाईंको AI अनुप्रयोगमा सुरक्षित कोडिङ सर्वोत्तम अभ्यासहरू - [OWASP Top 10](https://owasp.org/www-project-top-ten/), [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559) विरुद्ध सुरक्षा, गोप्य सूचना र टोकनहरूको लागि सुरक्षित भल्ट प्रयोग, सबै अनुप्रयोग कम्पोनेन्टहरूबीच अन्त्यदेखि अन्त्यसम्म सुरक्षित सञ्चार कार्यान्वयन आदि।
- सर्भर कडा बनाउने - जहाँ सम्भव MFA प्रयोग गर्नुहोस्, प्याचहरू अपडेट राख्नुहोस्, तेस्रो-पक्ष पहिचान प्रदायकसँग सर्भर एकीकृत गर्नुहोस्।
- उपकरणहरू, पूर्वाधार र अनुप्रयोगहरूलाई प्याचहरूसँग अपडेट राख्नुहोस्।
- सुरक्षा अनुगमन - AI अनुप्रयोग (MCP क्लाइन्ट/सर्भरहरू सहित) को लगिङ र अनुगमन कार्यान्वयन गरी ती लगहरूलाई केन्द्रीय SIEM मा पठाएर असामान्य गतिविधिहरू पत्ता लगाउनुहोस्।
- शून्य विश्वास वास्तुकला - नेटवर्क र पहिचान नियन्त्रणमार्फत कम्पोनेन्टहरूलाई तार्किक रूपमा अलग राखेर AI अनुप्रयोग कम्प्रोमाइज भएमा पार्श्वगत आन्दोलन कम गर्नुहोस्।

# मुख्य निष्कर्षहरू

- सुरक्षा आधारभूत कुरा अझै पनि महत्वपूर्ण छन्: सुरक्षित कोडिङ, न्यूनतम अधिकार, सप्लाई चेन प्रमाणीकरण, र निरन्तर अनुगमन MCP र AI कार्यभारका लागि आवश्यक छन्।
- MCP ले नयाँ जोखिमहरू ल्याउँछ—जस्तै प्रॉम्प्ट इन्जेक्शन, उपकरण विषाक्तता, सेसन हाइज्याकिङ, भ्रमित डिप्युटी समस्या, टोकन पासथ्रू कमजोरीहरू, र अत्यधिक अनुमति—जसका लागि परम्परागत र AI-विशिष्ट नियन्त्रणहरू आवश्यक छन्।
- बलियो प्रमाणीकरण, प्राधिकरण, र टोकन व्यवस्थापन अभ्यासहरू प्रयोग गर्नुहोस्, जहाँ सम्भव बाह्य पहिचान प्रदायकहरू जस्तै Microsoft Entra ID को उपयोग गर्नुहोस्।
- अप्रत्यक्ष प्रॉम्प्ट इन्जेक्शन र उपकरण विषाक्तता विरुद्ध सुरक्षा गर्न उपकरण मेटाडाटा प्रमाणीकरण गर्नुहोस्, गतिशील परिवर्तनहरूको अनुगमन गर्नुहोस्, र Microsoft Prompt Shields जस्ता समाधानहरू प्रयोग गर्नुहोस्।
- सुरक्षित सेसन व्यवस्थापन लागू गर्नुहोस् जसमा गैर-निर्धारित सेसन ID हरू प्रयोग गर्ने, सेसनहरूलाई प्रयोगकर्ता पहिचानसँग बाँध्ने, र प्रमाणिकरणका लागि सेसनहरू कहिल्यै प्रयोग नगर्ने समावेश छ।
- भ्रमित डिप्युटी आक्रमणहरू रोक्न प्रत्येक गतिशील रूपमा दर्ता गरिएको क्लाइन्टका लागि स्पष्ट प्रयोगकर्ता सहमति आवश्यक पार्नुहोस् र उचित OAuth सुरक्षा अभ्यासहरू लागू गर्नुहोस्।
- टोकन पासथ्रू कमजोरीहरूबाट बच्न MCP सर्भरहरूले केवल तिनीहरूका लागि स्पष्ट रूपमा जारी गरिएको टोकनहरू मात्र स्वीकार्नुपर्छ र टोकन दाबीहरू उचित रूपमा प्रमाणीकरण गर्नुपर्छ।
- तपाईंको AI सप्लाई चेनका सबै कम्पोनेन्टहरू—मोडेलहरू, एम्बेडिङहरू, र सन्दर्भ प्रदायकहरू सहित—लाई कोड निर्भरता जस्तै कडाइका साथ व्यवहार गर्नुहोस्।
- विकसित हुँदै गरेको MCP विनिर्देशनहरूसँग अद्यावधिक रहनुहोस् र सुरक्षित मापदण्डहरू निर्माण गर्न समुदायमा योगदान दिनुहोस्।

# थप स्रोतहरू

## बाह्य स्रोतहरू
- [Microsoft Digital Defense Report](https://aka.ms/mddr)
- [MCP Specification](https://spec.modelcontextprotocol.io/)
- [MCP Security Best Practices](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices)
- [MCP Authorization Specification](https://modelcontextprotocol.io/specification/draft/basic/authorization)
- [OAuth 2.0 Security Best Practices (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)
- [Prompt Injection in MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- [Tool Poisoning Attacks (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- [Rug Pulls in MCP (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)
- [Prompt Shields Documentation (Microsoft)](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [GitHub Advanced Security](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [Secure Least-Privileged Access (Microsoft)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Best Practices for Token Validation and Lifetime](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [Use Secure Token Storage and Encrypt Tokens (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [Azure API Management as Auth Gateway for MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Using Microsoft Entra ID to Authenticate with MCP Servers](https://den.dev/blog/mcp-server-auth-entra-id-session/)

## थप सुरक्षा कागजातहरू

थप विस्तृत सुरक्षा मार्गनिर्देशनका लागि यी कागजातहरू हेर्नुहोस्:

- [MCP Security Best Practices 2025](./mcp-security-best-practices-2025.md) - MCP कार्यान्वयनका लागि व्यापक सुरक्षा सर्वोत्तम अभ्यासहरूको सूची
- [Azure Content Safety Implementation](./azure-content-safety-implementation.md) - Azure Content Safety लाई MCP सर्भरसँग एकीकृत गर्ने कार्यान्वयन उदाहरणहरू
- [MCP Security Controls 2025](./mcp-security-controls-2025.md) - MCP डिप्लोयमेन्टहरूलाई सुरक्षित गर्न नवीनतम सुरक्षा नियन्त्रण र प्रविधिहरू
- [MCP Best Practices](./mcp-best-practices.md) - MCP सुरक्षा लागि छिटो सन्दर्भ मार्गदर्शक

### अर्को

अर्को: [अध्याय ३: सुरु गर्ने तरिका](../03-GettingStarted/README.md)

**अस्वीकरण**:  
यो दस्तावेज AI अनुवाद सेवा [Co-op Translator](https://github.com/Azure/co-op-translator) प्रयोग गरी अनुवाद गरिएको हो। हामी शुद्धताका लागि प्रयासरत छौं, तर कृपया ध्यान दिनुहोस् कि स्वचालित अनुवादमा त्रुटि वा अशुद्धता हुन सक्छ। मूल दस्तावेज यसको मूल भाषामा नै अधिकारिक स्रोत मानिनु पर्छ। महत्वपूर्ण जानकारीका लागि व्यावसायिक मानव अनुवाद सिफारिस गरिन्छ। यस अनुवादको प्रयोगबाट उत्पन्न कुनै पनि गलतफहमी वा गलत व्याख्याका लागि हामी जिम्मेवार छैनौं।
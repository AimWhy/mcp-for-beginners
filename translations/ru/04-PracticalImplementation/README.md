<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "5384bbb2a92d00d5d7e66274dbe0331d",
  "translation_date": "2025-06-20T18:20:08+00:00",
  "source_file": "04-PracticalImplementation/README.md",
  "language_code": "ru"
}
-->
# Практическая реализация

Практическая реализация — это момент, когда сила Model Context Protocol (MCP) становится ощутимой. Хотя важно понимать теорию и архитектуру MCP, настоящая ценность проявляется, когда вы применяете эти концепции для создания, тестирования и развертывания решений, которые решают реальные задачи. Эта глава соединяет теоретические знания с практической разработкой, проводя вас через процесс создания приложений на базе MCP.

Будь то разработка интеллектуальных ассистентов, интеграция ИИ в бизнес-процессы или создание специализированных инструментов для обработки данных, MCP предоставляет гибкую основу. Его языконезависимый дизайн и официальные SDK для популярных языков программирования делают его доступным для широкого круга разработчиков. Используя эти SDK, вы сможете быстро создавать прототипы, вносить изменения и масштабировать решения на разных платформах и в различных средах.

В следующих разделах вы найдете практические примеры, образцы кода и стратегии развертывания, демонстрирующие, как реализовать MCP на C#, Java, TypeScript, JavaScript и Python. Вы также узнаете, как отлаживать и тестировать MCP-серверы, управлять API и развертывать решения в облаке с помощью Azure. Эти практические материалы помогут ускорить ваше обучение и уверенно создавать надежные MCP-приложения, готовые к продакшену.

## Обзор

Этот урок посвящен практическим аспектам реализации MCP на разных языках программирования. Мы рассмотрим, как использовать MCP SDK для C#, Java, TypeScript, JavaScript и Python для создания надежных приложений, отладки и тестирования MCP-серверов, а также создания повторно используемых ресурсов, подсказок и инструментов.

## Цели обучения

К концу урока вы сможете:
- Реализовывать решения MCP с использованием официальных SDK на разных языках программирования
- Систематически отлаживать и тестировать MCP-серверы
- Создавать и использовать серверные функции (Resources, Prompts и Tools)
- Проектировать эффективные MCP-рабочие процессы для сложных задач
- Оптимизировать реализацию MCP для повышения производительности и надежности

## Официальные SDK

Model Context Protocol предлагает официальные SDK для нескольких языков:

- [C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)
- [Java SDK](https://github.com/modelcontextprotocol/java-sdk)
- [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [Kotlin SDK](https://github.com/modelcontextprotocol/kotlin-sdk)

## Работа с MCP SDK

В этом разделе приведены практические примеры реализации MCP на разных языках программирования. Образцы кода находятся в каталоге `samples`, организованном по языкам.

### Доступные примеры

Репозиторий содержит [примерные реализации](../../../04-PracticalImplementation/samples) на следующих языках:

- [C#](./samples/csharp/README.md)
- [Java](./samples/java/containerapp/README.md)
- [TypeScript](./samples/typescript/README.md)
- [JavaScript](./samples/javascript/README.md)
- [Python](./samples/python/README.md)

Каждый пример демонстрирует ключевые концепции MCP и шаблоны реализации для конкретного языка и экосистемы.

## Основные функции сервера

MCP-серверы могут реализовывать любую комбинацию следующих функций:

### Resources  
Resources предоставляют контекст и данные для пользователя или модели ИИ:
- Хранилища документов
- Базы знаний
- Структурированные источники данных
- Файловые системы

### Prompts  
Prompts — это шаблоны сообщений и рабочих процессов для пользователей:
- Предопределённые шаблоны диалогов
- Руководства по взаимодействию
- Специализированные структуры диалогов

### Tools  
Tools — это функции, которые модель ИИ может выполнять:
- Утилиты для обработки данных
- Интеграция с внешними API
- Вычислительные возможности
- Функции поиска

## Примеры реализации: C#

Официальный репозиторий C# SDK содержит несколько примеров, демонстрирующих различные аспекты MCP:

- **Basic MCP Client**: простой пример создания клиента MCP и вызова инструментов
- **Basic MCP Server**: минимальная реализация сервера с базовой регистрацией инструментов
- **Advanced MCP Server**: полнофункциональный сервер с регистрацией инструментов, аутентификацией и обработкой ошибок
- **Интеграция с ASP.NET**: примеры интеграции с ASP.NET Core
- **Шаблоны реализации инструментов**: различные подходы к созданию инструментов разной сложности

C# SDK находится в превью, и API могут изменяться. Мы будем регулярно обновлять этот блог по мере развития SDK.

### Ключевые возможности  
- [C# MCP Nuget ModelContextProtocol](https://www.nuget.org/packages/ModelContextProtocol)

- Создание [первого MCP-сервера](https://devblogs.microsoft.com/dotnet/build-a-model-context-protocol-mcp-server-in-csharp/).

Для полного набора примеров реализации на C# посетите [официальный репозиторий с примерами C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)

## Пример реализации: Java

Java SDK предлагает надежные возможности для реализации MCP с корпоративным уровнем функционала.

### Ключевые возможности

- Интеграция с Spring Framework
- Строгая типизация
- Поддержка реактивного программирования
- Полная обработка ошибок

Для полного примера реализации на Java смотрите [Java sample](samples/java/containerapp/README.md) в каталоге с примерами.

## Пример реализации: JavaScript

JavaScript SDK обеспечивает легковесный и гибкий подход к реализации MCP.

### Ключевые возможности

- Поддержка Node.js и браузеров
- API на основе Promise
- Простая интеграция с Express и другими фреймворками
- Поддержка WebSocket для потоковой передачи

Для полного примера реализации на JavaScript смотрите [JavaScript sample](samples/javascript/README.md) в каталоге с примерами.

## Пример реализации: Python

Python SDK предлагает удобный для Python подход к реализации MCP с отличной интеграцией ML-фреймворков.

### Ключевые возможности

- Поддержка async/await с asyncio
- Интеграция с Flask и FastAPI
- Простая регистрация инструментов
- Нативная интеграция с популярными ML-библиотеками

Для полного примера реализации на Python смотрите [Python sample](samples/python/README.md) в каталоге с примерами.

## Управление API

Azure API Management — отличное решение для обеспечения безопасности MCP-серверов. Идея в том, чтобы разместить Azure API Management перед вашим MCP-сервером и позволить ему обрабатывать такие функции, как:

- ограничение частоты запросов
- управление токенами
- мониторинг
- балансировка нагрузки
- безопасность

### Пример Azure

Вот пример Azure, который реализует именно это, то есть [создает MCP-сервер и защищает его с помощью Azure API Management](https://github.com/Azure-Samples/remote-mcp-apim-functions-python).

Посмотрите, как происходит процесс авторизации на следующем изображении:

![APIM-MCP](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/mcp-client-authorization.gif?raw=true)

На изображении происходит следующее:

- Аутентификация/Авторизация осуществляется с помощью Microsoft Entra.
- Azure API Management выступает в роли шлюза и использует политики для управления и маршрутизации трафика.
- Azure Monitor ведет журнал всех запросов для последующего анализа.

#### Процесс авторизации

Рассмотрим процесс авторизации подробнее:

![Sequence Diagram](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/infra/app/apim-oauth/diagrams/images/mcp-client-auth.png?raw=true)

#### Спецификация авторизации MCP

Подробнее о [спецификации авторизации MCP](https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization#2-10-third-party-authorization-flow)

## Развертывание удаленного MCP-сервера в Azure

Давайте попробуем развернуть упомянутый ранее пример:

1. Клонируйте репозиторий

    ```bash
    git clone https://github.com/Azure-Samples/remote-mcp-apim-functions-python.git
    cd remote-mcp-apim-functions-python
    ```

2. Зарегистрируйте `Microsoft.App`  

    ` resource provider.
    * If you are using Azure CLI, run `az provider register --namespace Microsoft.App --wait`.
    * If you are using Azure PowerShell, run `  
    Register-AzResourceProvider -ProviderNamespace Microsoft.App`. Then run `  
    (Get-AzResourceProvider -ProviderNamespace Microsoft.App).RegistrationState — через некоторое время проверьте, завершена ли регистрация.

3. Выполните команду [azd](https://aka.ms/azd) для создания сервиса управления API, function app (с кодом) и всех необходимых ресурсов Azure

    ```shell
    azd up
    ```

    Эта команда развернет все облачные ресурсы в Azure.

### Тестирование сервера с помощью MCP Inspector

1. В **новом окне терминала** установите и запустите MCP Inspector

    ```shell
    npx @modelcontextprotocol/inspector
    ```

    Вы увидите интерфейс, похожий на:

    ![Connect to Node inspector](../../../translated_images/connect.141db0b2bd05f096fb1dd91273771fd8b2469d6507656c3b0c9df4b3c5473929.ru.png)

2. Нажмите CTRL и кликните, чтобы открыть веб-приложение MCP Inspector по URL, который покажет приложение (например, http://127.0.0.1:6274/#resources)
3. Установите тип транспорта `SSE`
1. Set the URL to your running API Management SSE endpoint displayed after `azd up` и нажмите **Connect**:

    ```shell
    https://<apim-servicename-from-azd-output>.azure-api.net/mcp/sse
    ```

5. **Список инструментов**. Нажмите на инструмент и выберите **Run Tool**.

Если все прошло успешно, вы подключились к MCP-серверу и смогли вызвать инструмент.

## MCP-серверы для Azure

[Remote-mcp-functions](https://github.com/Azure-Samples/remote-mcp-functions-dotnet): набор репозиториев с шаблонами быстрого старта для создания и развертывания удаленных MCP-серверов с использованием Azure Functions на Python, C# .NET или Node/TypeScript.

Примеры предоставляют полное решение, позволяющее разработчикам:

- Разрабатывать и запускать локально: создавать и отлаживать MCP-сервер на локальной машине
- Развертывать в Azure: легко публиковать в облаке с помощью простой команды azd up
- Подключаться с клиентов: подключаться к MCP-серверу с разных клиентов, включая режим агента Copilot в VS Code и инструмент MCP Inspector

### Ключевые возможности:

- Безопасность изначально: MCP-сервер защищен с помощью ключей и HTTPS
- Варианты аутентификации: поддержка OAuth с использованием встроенной аутентификации и/или API Management
- Сетевая изоляция: поддержка изоляции сети с помощью Azure Virtual Networks (VNET)
- Безсерверная архитектура: использование Azure Functions для масштабируемого и событийно-ориентированного выполнения
- Локальная разработка: полная поддержка локальной разработки и отладки
- Простое развертывание: упрощенный процесс публикации в Azure

Репозиторий содержит все необходимые конфигурационные файлы, исходный код и определения инфраструктуры, чтобы быстро начать работу с MCP-сервером, готовым к продакшену.

- [Azure Remote MCP Functions Python](https://github.com/Azure-Samples/remote-mcp-functions-python) — пример реализации MCP с использованием Azure Functions на Python

- [Azure Remote MCP Functions .NET](https://github.com/Azure-Samples/remote-mcp-functions-dotnet) — пример реализации MCP с использованием Azure Functions на C# .NET

- [Azure Remote MCP Functions Node/Typescript](https://github.com/Azure-Samples/remote-mcp-functions-typescript) — пример реализации MCP с использованием Azure Functions на Node/TypeScript.

## Основные выводы

- MCP SDK предоставляют инструменты, ориентированные на конкретные языки, для создания надежных MCP-решений
- Процесс отладки и тестирования критически важен для стабильных MCP-приложений
- Повторно используемые шаблоны подсказок обеспечивают последовательное взаимодействие с ИИ
- Хорошо спроектированные рабочие процессы позволяют координировать выполнение сложных задач с использованием нескольких инструментов
- Реализация MCP-решений требует учета вопросов безопасности, производительности и обработки ошибок

## Задание

Спроектируйте практический MCP-рабочий процесс, решающий реальную задачу в вашей области:

1. Определите 3-4 инструмента, которые помогут решить эту задачу
2. Создайте диаграмму рабочего процесса, показывающую взаимодействие этих инструментов
3. Реализуйте базовую версию одного из инструментов на предпочитаемом языке
4. Создайте шаблон подсказки, который поможет модели эффективно использовать ваш инструмент

## Дополнительные ресурсы


---

Далее: [Продвинутые темы](../05-AdvancedTopics/README.md)

**Отказ от ответственности**:  
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на наши усилия по обеспечению точности, имейте в виду, что автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на его исходном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется использовать профессиональный перевод, выполненный человеком. Мы не несем ответственности за любые недоразумения или неверные толкования, возникшие в результате использования данного перевода.
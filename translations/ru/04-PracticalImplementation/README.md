<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "d88dbf928fa0f159b82312e9a6757ba0",
  "translation_date": "2025-06-18T08:34:20+00:00",
  "source_file": "04-PracticalImplementation/README.md",
  "language_code": "ru"
}
-->
# Практическая реализация

Практическая реализация — это момент, когда сила Model Context Protocol (MCP) становится ощутимой. Хотя понимание теории и архитектуры MCP важно, настоящая ценность проявляется, когда вы применяете эти концепции для создания, тестирования и развертывания решений, решающих реальные задачи. Эта глава помогает преодолеть разрыв между теоретическими знаниями и практической разработкой, проводя вас через процесс воплощения приложений на базе MCP.

Будь то разработка интеллектуальных ассистентов, интеграция ИИ в бизнес-процессы или создание кастомных инструментов для обработки данных, MCP предоставляет гибкую основу. Его языконезависимый дизайн и официальные SDK для популярных языков программирования делают его доступным для широкого круга разработчиков. Используя эти SDK, вы можете быстро создавать прототипы, итеративно улучшать и масштабировать свои решения на разных платформах и в различных средах.

В следующих разделах вы найдете практические примеры, образцы кода и стратегии развертывания, демонстрирующие, как реализовать MCP на C#, Java, TypeScript, JavaScript и Python. Вы также узнаете, как отлаживать и тестировать MCP-серверы, управлять API и развертывать решения в облаке с помощью Azure. Эти практические материалы помогут ускорить ваше обучение и уверенно создавать надежные MCP-приложения, готовые к продакшену.

## Обзор

Этот урок сосредоточен на практических аспектах реализации MCP на нескольких языках программирования. Мы рассмотрим, как использовать MCP SDK на C#, Java, TypeScript, JavaScript и Python для создания надежных приложений, отладки и тестирования MCP-серверов, а также создания переиспользуемых ресурсов, подсказок и инструментов.

## Цели обучения

К концу урока вы сможете:
- Реализовывать решения MCP с использованием официальных SDK на различных языках программирования
- Систематически отлаживать и тестировать MCP-серверы
- Создавать и использовать серверные функции (Ресурсы, Подсказки и Инструменты)
- Проектировать эффективные рабочие процессы MCP для сложных задач
- Оптимизировать реализации MCP с точки зрения производительности и надежности

## Официальные SDK

Model Context Protocol предлагает официальные SDK для нескольких языков:

- [C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)
- [Java SDK](https://github.com/modelcontextprotocol/java-sdk) 
- [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [Kotlin SDK](https://github.com/modelcontextprotocol/kotlin-sdk)

## Работа с MCP SDK

В этом разделе представлены практические примеры реализации MCP на разных языках программирования. Образцы кода находятся в каталоге `samples`, организованном по языкам.

### Доступные примеры

В репозитории есть [примерные реализации](../../../04-PracticalImplementation/samples) на следующих языках:

- [C#](./samples/csharp/README.md)
- [Java](./samples/java/containerapp/README.md)
- [TypeScript](./samples/typescript/README.md)
- [JavaScript](./samples/javascript/README.md)
- [Python](./samples/python/README.md)

Каждый пример демонстрирует ключевые концепции MCP и паттерны реализации для конкретного языка и экосистемы.

## Основные функции сервера

MCP-серверы могут реализовывать любую комбинацию следующих функций:

### Ресурсы
Ресурсы предоставляют контекст и данные для пользователя или модели ИИ:
- Репозитории документов
- Базы знаний
- Структурированные источники данных
- Файловые системы

### Подсказки
Подсказки — это шаблонные сообщения и сценарии для пользователей:
- Предопределённые шаблоны диалогов
- Руководства по взаимодействию
- Специализированные структуры диалогов

### Инструменты
Инструменты — это функции, которые модель ИИ может выполнять:
- Утилиты для обработки данных
- Интеграция с внешними API
- Вычислительные возможности
- Функции поиска

## Примеры реализации: C#

Официальный репозиторий C# SDK содержит несколько примеров, демонстрирующих разные аспекты MCP:

- **Базовый MCP-клиент**: простой пример создания MCP-клиента и вызова инструментов
- **Базовый MCP-сервер**: минимальная реализация сервера с базовой регистрацией инструментов
- **Продвинутый MCP-сервер**: полнофункциональный сервер с регистрацией инструментов, аутентификацией и обработкой ошибок
- **Интеграция с ASP.NET**: примеры интеграции с ASP.NET Core
- **Паттерны реализации инструментов**: разные подходы к реализации инструментов с разным уровнем сложности

C# SDK MCP находится в предварительном просмотре, и API могут изменяться. Мы будем регулярно обновлять этот блог по мере развития SDK.

### Ключевые возможности
- [C# MCP Nuget ModelContextProtocol](https://www.nuget.org/packages/ModelContextProtocol)

- Создание вашего [первого MCP-сервера](https://devblogs.microsoft.com/dotnet/build-a-model-context-protocol-mcp-server-in-csharp/).

Для полного набора примеров реализации на C# посетите [официальный репозиторий примеров C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)

## Пример реализации: Java

Java SDK предлагает надежные варианты реализации MCP с возможностями корпоративного уровня.

### Ключевые возможности

- Интеграция с Spring Framework
- Строгая типизация
- Поддержка реактивного программирования
- Полноценная обработка ошибок

Для полного примера реализации на Java смотрите [MCPSample.java](../../../04-PracticalImplementation/samples/java/MCPSample.java) в каталоге примеров.

## Пример реализации: JavaScript

JavaScript SDK предлагает легковесный и гибкий подход к реализации MCP.

### Ключевые возможности

- Поддержка Node.js и браузера
- API на основе Promise
- Легкая интеграция с Express и другими фреймворками
- Поддержка WebSocket для стриминга

Для полного примера реализации на JavaScript смотрите [mcp_sample.js](../../../04-PracticalImplementation/samples/javascript/mcp_sample.js) в каталоге примеров.

## Пример реализации: Python

Python SDK предлагает Python-ориентированный подход к реализации MCP с отличной интеграцией с ML-фреймворками.

### Ключевые возможности

- Поддержка async/await с asyncio
- Интеграция с Flask и FastAPI
- Простая регистрация инструментов
- Нативная интеграция с популярными ML-библиотеками

Для полного примера реализации на Python смотрите [mcp_sample.py](../../../04-PracticalImplementation/samples/python/mcp_sample.py) в каталоге примеров.

## Управление API

Azure API Management — отличный способ обеспечить безопасность MCP-серверов. Идея заключается в том, чтобы разместить экземпляр Azure API Management перед вашим MCP-сервером и позволить ему обрабатывать функции, которые вам скорее всего понадобятся, такие как:

- ограничение скорости запросов
- управление токенами
- мониторинг
- балансировка нагрузки
- безопасность

### Пример Azure

Вот пример Azure, который делает именно это — то есть [создает MCP-сервер и защищает его с помощью Azure API Management](https://github.com/Azure-Samples/remote-mcp-apim-functions-python).

Посмотрите, как происходит поток авторизации на изображении ниже:

![APIM-MCP](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/mcp-client-authorization.gif?raw=true) 

На изображении происходит следующее:

- Аутентификация и авторизация выполняются с помощью Microsoft Entra.
- Azure API Management выступает в роли шлюза и использует политики для маршрутизации и управления трафиком.
- Azure Monitor записывает все запросы для последующего анализа.

#### Поток авторизации

Давайте подробнее рассмотрим поток авторизации:

![Sequence Diagram](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/infra/app/apim-oauth/diagrams/images/mcp-client-auth.png?raw=true)

#### Спецификация авторизации MCP

Подробнее о [спецификации авторизации MCP](https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization#2-10-third-party-authorization-flow)

## Развертывание удалённого MCP-сервера в Azure

Давайте попробуем развернуть упомянутый ранее пример:

1. Клонируйте репозиторий

    ```bash
    git clone https://github.com/Azure-Samples/remote-mcp-apim-functions-python.git
    cd remote-mcp-apim-functions-python
    ```

2. Зарегистрируйте `Microsoft.App`  
   ` resource provider.
    * If you are using Azure CLI, run `az provider register --namespace Microsoft.App --wait`.
    * If you are using Azure PowerShell, run `  
   или  
   `. Then run `Register-AzResourceProvider -ProviderNamespace Microsoft.App` after some time to check if the registration is complete.

2. Run this [azd](https://aka.ms/azd) command to provision the api management service, function app(with code) and all other required Azure resources

    `  
   (через некоторое время проверьте состояние регистрации командой `(Get-AzResourceProvider -ProviderNamespace Microsoft.App).RegistrationState`).

3. Выполните эту команду [azd](https://aka.ms/azd), чтобы создать сервис управления API, Function App (с кодом) и все необходимые ресурсы Azure:

    ```shell
    azd up
    ```

    Эта команда развернет все облачные ресурсы в Azure.

### Тестирование сервера с MCP Inspector

1. В **новом окне терминала** установите и запустите MCP Inspector:

    ```shell
    npx @modelcontextprotocol/inspector
    ```

    Вы должны увидеть интерфейс, похожий на:

    ![Connect to Node inspector](../../../translated_images/connect.141db0b2bd05f096fb1dd91273771fd8b2469d6507656c3b0c9df4b3c5473929.ru.png) 

2. CTRL+кликните, чтобы открыть веб-приложение MCP Inspector по URL, отображаемому приложением (например, http://127.0.0.1:6274/#resources)
3. Установите тип транспорта в `SSE`
1. Set the URL to your running API Management SSE endpoint displayed after `azd up` и нажмите **Connect**:

    ```shell
    https://<apim-servicename-from-azd-output>.azure-api.net/mcp/sse
    ```

5. **Список инструментов**. Нажмите на инструмент и выберите **Run Tool**.

Если все шаги выполнены успешно, вы подключились к MCP-серверу и смогли вызвать инструмент.

## MCP-серверы для Azure

[Remote-mcp-functions](https://github.com/Azure-Samples/remote-mcp-functions-dotnet): набор репозиториев с шаблонами быстрого старта для создания и развертывания кастомных удалённых MCP (Model Context Protocol) серверов с использованием Azure Functions на Python, C# .NET или Node/TypeScript.

Примеры предоставляют комплексное решение, позволяющее разработчикам:

- Локальная разработка и запуск: разработка и отладка MCP-сервера на локальной машине
- Развертывание в Azure: простое развертывание в облаке командой azd up
- Подключение клиентов: подключение к MCP-серверу с различных клиентов, включая режим агента Copilot в VS Code и инструмент MCP Inspector

### Ключевые особенности:

- Безопасность изначально: MCP-сервер защищён с помощью ключей и HTTPS
- Варианты аутентификации: поддержка OAuth через встроенную аутентификацию и/или API Management
- Сетевой изоляция: возможность изоляции сети с помощью Azure Virtual Networks (VNET)
- Бессерверная архитектура: использование Azure Functions для масштабируемого и событийно-ориентированного исполнения
- Локальная разработка: полная поддержка локальной разработки и отладки
- Простое развертывание: упрощенный процесс развертывания в Azure

Репозиторий содержит все необходимые файлы конфигурации, исходный код и определения инфраструктуры, чтобы быстро начать работу с MCP-сервером, готовым к продакшену.

- [Azure Remote MCP Functions Python](https://github.com/Azure-Samples/remote-mcp-functions-python) — пример реализации MCP с использованием Azure Functions на Python

- [Azure Remote MCP Functions .NET](https://github.com/Azure-Samples/remote-mcp-functions-dotnet) — пример реализации MCP с использованием Azure Functions на C# .NET

- [Azure Remote MCP Functions Node/Typescript](https://github.com/Azure-Samples/remote-mcp-functions-typescript) — пример реализации MCP с использованием Azure Functions на Node/TypeScript.

## Основные выводы

- SDK MCP предоставляют языко-специфичные инструменты для реализации надежных MCP-решений
- Процесс отладки и тестирования критически важен для стабильной работы MCP-приложений
- Переиспользуемые шаблоны подсказок обеспечивают единообразие взаимодействия с ИИ
- Хорошо спроектированные рабочие процессы позволяют координировать сложные задачи с использованием нескольких инструментов
- Реализация MCP требует учёта безопасности, производительности и обработки ошибок

## Упражнение

Разработайте практический рабочий процесс MCP, решающий реальную задачу в вашей области:

1. Определите 3-4 инструмента, которые будут полезны для решения этой задачи
2. Создайте диаграмму рабочего процесса, показывающую взаимодействие этих инструментов
3. Реализуйте базовую версию одного из инструментов на предпочитаемом языке
4. Создайте шаблон подсказки, который поможет модели эффективно использовать ваш инструмент

## Дополнительные ресурсы


---

Далее: [Продвинутые темы](../05-AdvancedTopics/README.md)

**Отказ от ответственности**:  
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на наши усилия обеспечить точность, пожалуйста, имейте в виду, что автоматический перевод может содержать ошибки или неточности. Оригинальный документ на исходном языке следует считать авторитетным источником. Для критически важной информации рекомендуется профессиональный перевод человеком. Мы не несем ответственности за любые недоразумения или неверные толкования, возникшие в результате использования данного перевода.
<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "7919ce2e537f0c435c7c23fa6775b613",
  "translation_date": "2025-06-11T17:57:20+00:00",
  "source_file": "04-PracticalImplementation/README.md",
  "language_code": "ru"
}
-->
# Практическая реализация

Практическая реализация — это тот момент, когда сила Model Context Protocol (MCP) становится ощутимой. Хотя понимание теории и архитектуры MCP важно, настоящая ценность проявляется, когда вы применяете эти концепции для создания, тестирования и развертывания решений, которые решают реальные задачи. Эта глава служит мостом между теоретическими знаниями и практической разработкой, помогая вам воплотить приложения на базе MCP в жизнь.

Будь то разработка интеллектуальных ассистентов, интеграция ИИ в бизнес-процессы или создание кастомных инструментов для обработки данных, MCP предоставляет гибкую основу. Его независимый от языка дизайн и официальные SDK для популярных языков программирования делают его доступным для широкого круга разработчиков. Используя эти SDK, вы сможете быстро создавать прототипы, проводить итерации и масштабировать решения на разных платформах и в различных средах.

В следующих разделах вы найдете практические примеры, образцы кода и стратегии развертывания, демонстрирующие, как реализовать MCP на C#, Java, TypeScript, JavaScript и Python. Вы также узнаете, как отлаживать и тестировать MCP-серверы, управлять API и разворачивать решения в облаке с помощью Azure. Эти практические материалы помогут ускорить обучение и уверенно создавать надежные MCP-приложения, готовые к промышленному использованию.

## Обзор

Этот урок посвящён практическим аспектам реализации MCP на нескольких языках программирования. Мы рассмотрим, как использовать MCP SDK на C#, Java, TypeScript, JavaScript и Python для создания надежных приложений, отладки и тестирования MCP-серверов, а также создания повторно используемых ресурсов, подсказок и инструментов.

## Цели обучения

К концу урока вы сможете:
- Реализовывать решения MCP с помощью официальных SDK на разных языках программирования
- Систематически отлаживать и тестировать MCP-серверы
- Создавать и использовать функции сервера (Resources, Prompts и Tools)
- Проектировать эффективные MCP-рабочие процессы для сложных задач
- Оптимизировать реализации MCP по производительности и надежности

## Официальные SDK

Model Context Protocol предлагает официальные SDK для нескольких языков:

- [C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)
- [Java SDK](https://github.com/modelcontextprotocol/java-sdk) 
- [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [Kotlin SDK](https://github.com/modelcontextprotocol/kotlin-sdk)

## Работа с MCP SDK

В этом разделе представлены практические примеры реализации MCP на нескольких языках программирования. Образцы кода находятся в каталоге `samples`, организованном по языкам.

### Доступные образцы

Репозиторий содержит примеры реализации на следующих языках:

- C#
- Java
- TypeScript
- JavaScript
- Python

Каждый пример демонстрирует ключевые концепции MCP и шаблоны реализации для конкретного языка и экосистемы.

## Основные функции сервера

MCP-серверы могут реализовывать любую комбинацию следующих функций:

### Resources  
Resources предоставляют контекст и данные для пользователя или модели ИИ:  
- Хранилища документов  
- Базы знаний  
- Структурированные источники данных  
- Файловые системы  

### Prompts  
Prompts — это шаблоны сообщений и рабочих процессов для пользователей:  
- Предопределённые шаблоны диалогов  
- Руководства по взаимодействию  
- Специализированные структуры диалогов  

### Tools  
Tools — это функции, которые модель ИИ может выполнять:  
- Утилиты для обработки данных  
- Интеграция с внешними API  
- Вычислительные возможности  
- Функции поиска  

## Примеры реализации: C#

Официальный репозиторий C# SDK содержит несколько примеров, демонстрирующих разные аспекты MCP:

- **Basic MCP Client**: простой пример создания клиента MCP и вызова инструментов  
- **Basic MCP Server**: минимальная реализация сервера с базовой регистрацией инструментов  
- **Advanced MCP Server**: полнофункциональный сервер с регистрацией инструментов, аутентификацией и обработкой ошибок  
- **ASP.NET Integration**: примеры интеграции с ASP.NET Core  
- **Tool Implementation Patterns**: различные шаблоны реализации инструментов с разной степенью сложности  

SDK MCP для C# находится в стадии предварительного просмотра, API могут изменяться. Мы будем регулярно обновлять этот блог по мере развития SDK.

### Ключевые возможности  
- [C# MCP Nuget ModelContextProtocol](https://www.nuget.org/packages/ModelContextProtocol)  
- Создание [первого MCP-сервера](https://devblogs.microsoft.com/dotnet/build-a-model-context-protocol-mcp-server-in-csharp/).

Для полного набора примеров реализации на C# посетите [официальный репозиторий с примерами C# SDK](https://github.com/modelcontextprotocol/csharp-sdk).

## Пример реализации: Java

Java SDK предлагает надежные варианты реализации MCP с корпоративными возможностями.

### Ключевые возможности

- Интеграция с Spring Framework  
- Жёсткая типизация  
- Поддержка реактивного программирования  
- Полная обработка ошибок  

Для полного примера реализации на Java смотрите [MCPSample.java](../../../04-PracticalImplementation/samples/java/MCPSample.java) в каталоге с примерами.

## Пример реализации: JavaScript

JavaScript SDK обеспечивает легковесный и гибкий подход к реализации MCP.

### Ключевые возможности

- Поддержка Node.js и браузера  
- API на основе Promise  
- Легкая интеграция с Express и другими фреймворками  
- Поддержка WebSocket для стриминга  

Для полного примера реализации на JavaScript смотрите [mcp_sample.js](../../../04-PracticalImplementation/samples/javascript/mcp_sample.js) в каталоге с примерами.

## Пример реализации: Python

Python SDK предлагает питонический подход к реализации MCP с отличной интеграцией с ML-фреймворками.

### Ключевые возможности

- Поддержка async/await с asyncio  
- Интеграция с Flask и FastAPI  
- Простая регистрация инструментов  
- Нативная интеграция с популярными ML-библиотеками  

Для полного примера реализации на Python смотрите [mcp_sample.py](../../../04-PracticalImplementation/samples/python/mcp_sample.py) в каталоге с примерами.

## Управление API

Azure API Management — отличный способ обеспечить безопасность MCP-серверов. Идея заключается в том, чтобы разместить Azure API Management перед вашим MCP-сервером и позволить ему управлять такими функциями, как:

- ограничение скорости запросов  
- управление токенами  
- мониторинг  
- балансировка нагрузки  
- безопасность  

### Пример Azure

Вот пример Azure, который делает именно это, то есть [создаёт MCP-сервер и защищает его с помощью Azure API Management](https://github.com/Azure-Samples/remote-mcp-apim-functions-python).

Посмотрите, как происходит поток авторизации на изображении ниже:

![APIM-MCP](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/mcp-client-authorization.gif?raw=true)

На изображении происходит следующее:

- Аутентификация/авторизация выполняется с помощью Microsoft Entra.  
- Azure API Management выступает шлюзом и использует политики для направления и управления трафиком.  
- Azure Monitor ведёт логи всех запросов для дальнейшего анализа.  

#### Поток авторизации

Давайте рассмотрим процесс авторизации подробнее:

![Sequence Diagram](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/infra/app/apim-oauth/diagrams/images/mcp-client-auth.png?raw=true)

#### Спецификация авторизации MCP

Узнайте больше о [спецификации авторизации MCP](https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization#2-10-third-party-authorization-flow)

## Развёртывание удалённого MCP-сервера в Azure

Давайте попробуем развернуть пример, который мы упоминали ранее:

1. Клонируйте репозиторий

    ```bash
    git clone https://github.com/Azure-Samples/remote-mcp-apim-functions-python.git
    cd remote-mcp-apim-functions-python
    ```

2. Зарегистрируйте `Microsoft.App` resource provider.
    * If you are using Azure CLI, run `az provider register --namespace Microsoft.App --wait`.
    * If you are using Azure PowerShell, run `Register-AzResourceProvider -ProviderNamespace Microsoft.App`. Then run `(Get-AzResourceProvider -ProviderNamespace Microsoft.App).RegistrationState` и через некоторое время проверьте, завершена ли регистрация.

3. Выполните команду [azd](https://aka.ms/azd) для создания службы управления API, function app (с кодом) и всех необходимых ресурсов Azure

    ```shell
    azd up
    ```

    Эта команда должна развернуть все облачные ресурсы в Azure.

### Тестирование сервера с помощью MCP Inspector

1. В **новом окне терминала** установите и запустите MCP Inspector

    ```shell
    npx @modelcontextprotocol/inspector
    ```

    Вы увидите интерфейс, похожий на:

    ![Connect to Node inspector](../../../translated_images/connect.141db0b2bd05f096fb1dd91273771fd8b2469d6507656c3b0c9df4b3c5473929.ru.png)

2. CTRL + клик по URL, который отображается в приложении, чтобы открыть веб-приложение MCP Inspector (например, http://127.0.0.1:6274/#resources)  
3. Установите тип транспорта в `SSE`
1. Set the URL to your running API Management SSE endpoint displayed after `azd up` и нажмите **Connect**:

    ```shell
    https://<apim-servicename-from-azd-output>.azure-api.net/mcp/sse
    ```

5. **Список инструментов**. Нажмите на инструмент и выберите **Run Tool**.

Если все шаги выполнены успешно, вы подключитесь к MCP-серверу и сможете вызвать инструмент.

## MCP-серверы для Azure

[Remote-mcp-functions](https://github.com/Azure-Samples/remote-mcp-functions-dotnet): этот набор репозиториев представляет шаблон быстрого старта для создания и развертывания кастомных удалённых MCP-серверов с использованием Azure Functions на Python, C# .NET или Node/TypeScript.

Примеры предоставляют полное решение, которое позволяет разработчикам:

- Локальная разработка и запуск: разработка и отладка MCP-сервера на локальной машине  
- Развёртывание в Azure: простое развертывание в облаке с помощью команды azd up  
- Подключение клиентов: подключение к MCP-серверу с разных клиентов, включая режим агента Copilot в VS Code и инструмент MCP Inspector  

### Ключевые особенности:

- Безопасность изначально: MCP-сервер защищён с помощью ключей и HTTPS  
- Варианты аутентификации: поддержка OAuth с использованием встроенной аутентификации и/или API Management  
- Изоляция сети: поддержка изоляции с помощью виртуальных сетей Azure (VNET)  
- Безсерверная архитектура: использование Azure Functions для масштабируемого событийного выполнения  
- Локальная разработка: полная поддержка локальной разработки и отладки  
- Простое развертывание: упрощённый процесс развертывания в Azure  

Репозиторий содержит все необходимые конфигурационные файлы, исходный код и определения инфраструктуры для быстрого старта с промышленной реализацией MCP-сервера.

- [Azure Remote MCP Functions Python](https://github.com/Azure-Samples/remote-mcp-functions-python) — пример реализации MCP с использованием Azure Functions на Python  
- [Azure Remote MCP Functions .NET](https://github.com/Azure-Samples/remote-mcp-functions-dotnet) — пример реализации MCP с использованием Azure Functions на C# .NET  
- [Azure Remote MCP Functions Node/Typescript](https://github.com/Azure-Samples/remote-mcp-functions-typescript) — пример реализации MCP с использованием Azure Functions на Node/TypeScript  

## Основные выводы

- MCP SDK предоставляют языко-специфичные инструменты для реализации надежных MCP-решений  
- Процесс отладки и тестирования критически важен для надежных MCP-приложений  
- Повторно используемые шаблоны подсказок обеспечивают последовательное взаимодействие с ИИ  
- Хорошо спроектированные рабочие процессы могут оркестрировать сложные задачи с использованием множества инструментов  
- Реализация MCP требует внимания к безопасности, производительности и обработке ошибок  

## Упражнение

Спроектируйте практический MCP-рабочий процесс, который решает реальную задачу в вашей области:

1. Определите 3-4 инструмента, которые помогут решить эту задачу  
2. Создайте диаграмму рабочего процесса, показывающую взаимодействие этих инструментов  
3. Реализуйте базовую версию одного из инструментов на предпочитаемом языке  
4. Создайте шаблон подсказки, который поможет модели эффективно использовать ваш инструмент  

## Дополнительные ресурсы


---

Далее: [Продвинутые темы](../05-AdvancedTopics/README.md)

**Отказ от ответственности**:  
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на наши усилия обеспечить точность, просим учитывать, что автоматический перевод может содержать ошибки или неточности. Оригинальный документ на его исходном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется обратиться к профессиональному переводу, выполненному человеком. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования данного перевода.
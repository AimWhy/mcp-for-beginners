<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "0e1385a3fadf16bacd2f863757bcf5e0",
  "translation_date": "2025-05-17T13:41:17+00:00",
  "source_file": "04-PracticalImplementation/README.md",
  "language_code": "ru"
}
-->
# Практическая реализация

Практическая реализация — это то, где мощь Протокола Контекста Модели (MCP) становится ощутимой. Хотя понимание теории и архитектуры MCP важно, настоящая ценность проявляется, когда вы применяете эти концепции для создания, тестирования и развертывания решений, которые решают реальные проблемы. Эта глава устраняет разрыв между концептуальными знаниями и практической разработкой, направляя вас через процесс воплощения приложений на основе MCP в жизнь.

Независимо от того, разрабатываете ли вы интеллектуальных помощников, интегрируете ИИ в бизнес-процессы или создаете собственные инструменты для обработки данных, MCP предоставляет гибкую основу. Его независимый от языка дизайн и официальные SDK для популярных языков программирования делают его доступным для широкого круга разработчиков. Используя эти SDK, вы можете быстро создавать прототипы, итеративно улучшать и масштабировать свои решения на различных платформах и в разных средах.

В следующих разделах вы найдете практические примеры, образцы кода и стратегии развертывания, демонстрирующие, как реализовать MCP на C#, Java, TypeScript, JavaScript и Python. Вы также узнаете, как отлаживать и тестировать свои MCP-серверы, управлять API и развертывать решения в облаке с помощью Azure. Эти практические ресурсы предназначены для ускорения вашего обучения и помогут вам уверенно создавать надежные, готовые к производству приложения MCP.

## Обзор

Этот урок сосредоточен на практических аспектах реализации MCP на нескольких языках программирования. Мы рассмотрим, как использовать MCP SDK на C#, Java, TypeScript, JavaScript и Python для создания надежных приложений, отладки и тестирования MCP-серверов, а также создания повторно используемых ресурсов, подсказок и инструментов.

## Цели обучения

К концу этого урока вы сможете:
- Реализовывать решения MCP, используя официальные SDK на различных языках программирования
- Систематически отлаживать и тестировать MCP-серверы
- Создавать и использовать серверные функции (ресурсы, подсказки и инструменты)
- Разрабатывать эффективные рабочие процессы MCP для сложных задач
- Оптимизировать реализации MCP для производительности и надежности

## Официальные ресурсы SDK

Протокол Контекста Модели предлагает официальные SDK для нескольких языков:

- [C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)
- [Java SDK](https://github.com/modelcontextprotocol/java-sdk) 
- [TypeScript SDK](https://github.com/modelcontextprotocol/typescript-sdk)
- [Python SDK](https://github.com/modelcontextprotocol/python-sdk)
- [Kotlin SDK](https://github.com/modelcontextprotocol/kotlin-sdk)

## Работа с MCP SDK

Этот раздел предоставляет практические примеры реализации MCP на нескольких языках программирования. Вы можете найти образцы кода в каталоге `samples`, организованные по языкам.

### Доступные образцы

Репозиторий включает примеры реализации на следующих языках:

- C#
- Java
- TypeScript
- JavaScript
- Python

Каждый пример демонстрирует ключевые концепции MCP и шаблоны реализации для этого конкретного языка и экосистемы.

## Основные серверные функции

Серверы MCP могут реализовывать любую комбинацию этих функций:

### Ресурсы
Ресурсы предоставляют контекст и данные для пользователя или модели ИИ:
- Репозитории документов
- Базы знаний
- Структурированные источники данных
- Файловые системы

### Подсказки
Подсказки — это шаблонные сообщения и рабочие процессы для пользователей:
- Предопределенные шаблоны разговоров
- Шаблоны направленного взаимодействия
- Специализированные структуры диалога

### Инструменты
Инструменты — это функции, которые модель ИИ может выполнять:
- Утилиты обработки данных
- Интеграции с внешними API
- Вычислительные возможности
- Функциональность поиска

## Примеры реализации: C#

Официальный репозиторий C# SDK содержит несколько примеров реализации, демонстрирующих различные аспекты MCP:

- **Базовый MCP-клиент**: Простой пример, показывающий, как создать MCP-клиент и вызвать инструменты
- **Базовый MCP-сервер**: Минимальная реализация сервера с базовой регистрацией инструментов
- **Продвинутый MCP-сервер**: Полнофункциональный сервер с регистрацией инструментов, аутентификацией и обработкой ошибок
- **Интеграция с ASP.NET**: Примеры, демонстрирующие интеграцию с ASP.NET Core
- **Шаблоны реализации инструментов**: Различные шаблоны для реализации инструментов с различным уровнем сложности

MCP C# SDK находится в стадии предварительного просмотра, и API могут измениться. Мы будем постоянно обновлять этот блог по мере развития SDK.

### Основные функции 
- [C# MCP Nuget ModelContextProtocol](https://www.nuget.org/packages/ModelContextProtocol)

- Создание вашего [первого MCP-сервера](https://devblogs.microsoft.com/dotnet/build-a-model-context-protocol-mcp-server-in-csharp/).

Для полного примера реализации на C# посетите [официальный репозиторий образцов C# SDK](https://github.com/modelcontextprotocol/csharp-sdk)

## Пример реализации: Java Implementation

Java SDK предлагает надежные возможности реализации MCP с корпоративными функциями.

### Основные функции

- Интеграция с Spring Framework
- Сильная безопасность типов
- Поддержка реактивного программирования
- Всесторонняя обработка ошибок

Для полного примера реализации на Java см. [MCPSample.java](../../../04-PracticalImplementation/samples/java/MCPSample.java) в каталоге образцов.

## Пример реализации: JavaScript Implementation

JavaScript SDK предоставляет легкий и гибкий подход к реализации MCP.

### Основные функции

- Поддержка Node.js и браузеров
- API на основе промисов
- Легкая интеграция с Express и другими фреймворками
- Поддержка WebSocket для потоковой передачи

Для полного примера реализации на JavaScript см. [mcp_sample.js](../../../04-PracticalImplementation/samples/javascript/mcp_sample.js) в каталоге образцов.

## Пример реализации: Python Implementation

Python SDK предлагает подход к реализации MCP в стиле Python с отличной интеграцией с фреймворками ML.

### Основные функции

- Поддержка async/await с asyncio
- Интеграция с Flask и FastAPI
- Простая регистрация инструментов
- Нативная интеграция с популярными библиотеками ML

Для полного примера реализации на Python см. [mcp_sample.py](../../../04-PracticalImplementation/samples/python/mcp_sample.py) в каталоге образцов.

## Управление API

Azure API Management — это отличный ответ на вопрос, как мы можем защитить MCP-серверы. Идея заключается в том, чтобы разместить экземпляр Azure API Management перед вашим MCP-сервером и позволить ему обрабатывать функции, которые вы, вероятно, захотите использовать, такие как:

- ограничение скорости
- управление токенами
- мониторинг
- балансировка нагрузки
- безопасность

### Пример Azure

Вот пример Azure, делающий именно это, т.е. [создание MCP-сервера и его защита с помощью Azure API Management](https://github.com/Azure-Samples/remote-mcp-apim-functions-python).

Посмотрите, как происходит поток авторизации на изображении ниже:

![APIM-MCP](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/mcp-client-authorization.gif?raw=true)

На предыдущем изображении происходит следующее:

- Аутентификация/авторизация осуществляется с помощью Microsoft Entra.
- Azure API Management действует как шлюз и использует политики для направления и управления трафиком.
- Azure Monitor регистрирует все запросы для дальнейшего анализа.

#### Поток авторизации

Давайте подробнее рассмотрим поток авторизации:

![Диаграмма последовательности](https://github.com/Azure-Samples/remote-mcp-apim-functions-python/blob/main/infra/app/apim-oauth/diagrams/images/mcp-client-auth.png?raw=true)

#### Спецификация авторизации MCP

Узнайте больше о [спецификации авторизации MCP](https://modelcontextprotocol.io/specification/2025-03-26/basic/authorization#2-10-third-party-authorization-flow)

## Развертывание удаленного MCP-сервера в Azure

Давайте посмотрим, сможем ли мы развернуть упомянутый ранее пример:

1. Клонируйте репозиторий

    ```bash
    git clone https://github.com/Azure-Samples/remote-mcp-apim-functions-python.git
    cd remote-mcp-apim-functions-python
    ```

1. Зарегистрируйте `Microsoft.App` resource provider.
    * If you are using Azure CLI, run `az provider register --namespace Microsoft.App --wait`.
    * If you are using Azure PowerShell, run `Register-AzResourceProvider -ProviderNamespace Microsoft.App`. Then run `(Get-AzResourceProvider -ProviderNamespace Microsoft.App).RegistrationState` через некоторое время, чтобы проверить, завершена ли регистрация.

2. Запустите эту команду [azd](https://aka.ms/azd), чтобы предоставить службу управления API, функцию приложения (с кодом) и все другие необходимые ресурсы Azure

    ```shell
    azd up
    ```

    Эта команда должна развернуть все облачные ресурсы в Azure

### Тестирование вашего сервера с MCP Inspector

1. В **новом окне терминала** установите и запустите MCP Inspector

    ```shell
    npx @modelcontextprotocol/inspector
    ```

    Вы должны увидеть интерфейс, похожий на:

    ![Подключение к инспектору Node](../../../translated_images/connect.126df3a6deef0d2e0850b1a5cf0547c8fc4e2e9e0b354238d0a9dbe7893726fa.ru.png)

1. Нажмите CTRL, чтобы загрузить веб-приложение MCP Inspector с URL-адреса, отображаемого приложением (например, http://127.0.0.1:6274/#resources)
1. Установите тип транспорта на `SSE`
1. Set the URL to your running API Management SSE endpoint displayed after `azd up` и **Подключиться**:

    ```shell
    https://<apim-servicename-from-azd-output>.azure-api.net/mcp/sse
    ```

5. **Список инструментов**. Нажмите на инструмент и **Запустить инструмент**.

Если все шаги сработали, вы должны теперь быть подключены к серверу MCP и иметь возможность вызывать инструмент.

## MCP-серверы для Azure

[Remote-mcp-functions](https://github.com/Azure-Samples/remote-mcp-functions-dotnet): Этот набор репозиториев представляет собой шаблон быстрого старта для создания и развертывания пользовательских удаленных MCP (Model Context Protocol) серверов с использованием Azure Functions с Python, C# .NET или Node/TypeScript.

Образцы предоставляют полное решение, которое позволяет разработчикам:

- Создавать и запускать локально: Разрабатывать и отлаживать MCP-сервер на локальной машине
- Развертывать в Azure: Легко развертывать в облаке с помощью простой команды azd up
- Подключаться с клиентов: Подключаться к MCP-серверу с различных клиентов, включая режим агента Copilot в VS Code и инструмент MCP Inspector

### Основные функции:

- Безопасность по умолчанию: MCP-сервер защищен с помощью ключей и HTTPS
- Варианты аутентификации: Поддержка OAuth с использованием встроенной аутентификации и/или управления API
- Изоляция сети: Позволяет изоляцию сети с использованием виртуальных сетей Azure (VNET)
- Безсерверная архитектура: Использует Azure Functions для масштабируемого выполнения на основе событий
- Локальная разработка: Всеобъемлющая поддержка локальной разработки и отладки
- Простое развертывание: Упрощенный процесс развертывания в Azure

Репозиторий включает все необходимые файлы конфигурации, исходный код и определения инфраструктуры для быстрого начала работы с готовой к производству реализацией MCP-сервера.

- [Azure Remote MCP Functions Python](https://github.com/Azure-Samples/remote-mcp-functions-python) - Пример реализации MCP с использованием Azure Functions с Python

- [Azure Remote MCP Functions .NET](https://github.com/Azure-Samples/remote-mcp-functions-dotnet) - Пример реализации MCP с использованием Azure Functions с C# .NET

- [Azure Remote MCP Functions Node/Typescript](https://github.com/Azure-Samples/remote-mcp-functions-typescript) - Пример реализации MCP с использованием Azure Functions с Node/TypeScript.

## Основные выводы

- MCP SDK предоставляют инструменты, специфичные для языка, для реализации надежных решений MCP
- Процесс отладки и тестирования критически важен для надежных приложений MCP
- Повторно используемые шаблоны подсказок обеспечивают согласованное взаимодействие ИИ
- Хорошо разработанные рабочие процессы могут организовать выполнение сложных задач с использованием нескольких инструментов
- Реализация решений MCP требует учета безопасности, производительности и обработки ошибок

## Упражнение

Разработайте практический рабочий процесс MCP, который решает реальную проблему в вашей области:

1. Определите 3-4 инструмента, которые будут полезны для решения этой проблемы
2. Создайте диаграмму рабочего процесса, показывающую, как эти инструменты взаимодействуют
3. Реализуйте базовую версию одного из инструментов на предпочитаемом вами языке
4. Создайте шаблон подсказки, который поможет модели эффективно использовать ваш инструмент

## Дополнительные ресурсы

---

Далее: [Продвинутые темы](../05-AdvancedTopics/README.md)

**Отказ от ответственности**:  
Этот документ был переведен с помощью службы автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Мы стремимся к точности, однако, пожалуйста, учитывайте, что автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на его родном языке должен считаться авторитетным источником. Для получения критически важной информации рекомендуется профессиональный перевод человеком. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования этого перевода.
<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "382fddb4ee4d9c1bdc806e2ee99b70c8",
  "translation_date": "2025-07-16T23:29:33+00:00",
  "source_file": "02-Security/README.md",
  "language_code": "ru"
}
-->
# Лучшие практики безопасности

Внедрение Model Context Protocol (MCP) открывает новые возможности для приложений с искусственным интеллектом, но также приносит уникальные проблемы безопасности, выходящие за рамки традиционных рисков программного обеспечения. Помимо известных вопросов, таких как безопасное программирование, принцип наименьших привилегий и безопасность цепочки поставок, MCP и AI-нагрузки сталкиваются с новыми угрозами, такими как инъекции подсказок, отравление инструментов, динамическое изменение инструментов, перехват сессий, атаки «запутавшегося заместителя» и уязвимости при передаче токенов. Если эти риски не контролировать, они могут привести к утечке данных, нарушению конфиденциальности и непреднамеренному поведению системы.

В этом уроке рассматриваются наиболее актуальные риски безопасности, связанные с MCP — включая аутентификацию, авторизацию, избыточные права, косвенные инъекции подсказок, безопасность сессий, проблемы «запутавшегося заместителя», уязвимости при передаче токенов и уязвимости цепочки поставок — а также предлагаются практические меры и лучшие практики для их снижения. Вы также узнаете, как использовать решения Microsoft, такие как Prompt Shields, Azure Content Safety и GitHub Advanced Security, чтобы усилить вашу реализацию MCP. Понимая и применяя эти меры, вы значительно снизите вероятность нарушения безопасности и обеспечите надежность и доверие к вашим AI-системам.

# Цели обучения

К концу этого урока вы сможете:

- Определять и объяснять уникальные риски безопасности, связанные с Model Context Protocol (MCP), включая инъекции подсказок, отравление инструментов, избыточные права, перехват сессий, проблемы «запутавшегося заместителя», уязвимости при передаче токенов и уязвимости цепочки поставок.
- Описывать и применять эффективные меры по снижению рисков безопасности MCP, такие как надежная аутентификация, принцип наименьших привилегий, безопасное управление токенами, контроль безопасности сессий и проверка цепочки поставок.
- Понимать и использовать решения Microsoft, такие как Prompt Shields, Azure Content Safety и GitHub Advanced Security, для защиты MCP и AI-нагрузок.
- Осознавать важность проверки метаданных инструментов, мониторинга динамических изменений, защиты от косвенных инъекций подсказок и предотвращения перехвата сессий.
- Интегрировать проверенные лучшие практики безопасности — такие как безопасное программирование, усиление серверов и архитектура нулевого доверия — в вашу реализацию MCP для снижения вероятности и последствий нарушений безопасности.

# Контроль безопасности MCP

Любая система, имеющая доступ к важным ресурсам, сталкивается с определёнными проблемами безопасности. Обычно эти проблемы решаются правильным применением базовых мер и концепций безопасности. Поскольку MCP — это относительно новая спецификация, она быстро развивается и меняется. Со временем меры безопасности в ней станут более зрелыми, что позволит лучше интегрировать MCP с корпоративными и проверенными архитектурами и лучшими практиками безопасности.

Исследование, опубликованное в [Microsoft Digital Defense Report](https://aka.ms/mddr), показывает, что 98% зарегистрированных нарушений можно было бы предотвратить при условии соблюдения базовых правил гигиены безопасности. Лучшей защитой от любых нарушений является правильное применение базовых мер безопасности, безопасного программирования и обеспечения безопасности цепочки поставок — проверенные временем практики, которые по-прежнему оказывают наибольшее влияние на снижение рисков.

Давайте рассмотрим некоторые способы, с помощью которых вы можете начать решать проблемы безопасности при внедрении MCP.

> **Note:** Следующая информация актуальна на **29 мая 2025 года**. Протокол MCP постоянно развивается, и будущие реализации могут вводить новые схемы аутентификации и меры контроля. Для получения последних обновлений и рекомендаций всегда обращайтесь к [спецификации MCP](https://spec.modelcontextprotocol.io/), официальному [репозиторию MCP на GitHub](https://github.com/modelcontextprotocol) и [странице лучших практик безопасности](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices).

### Постановка проблемы  
Изначальная спецификация MCP предполагала, что разработчики будут создавать собственный сервер аутентификации. Это требовало знаний OAuth и связанных с ним ограничений безопасности. MCP-серверы выступали в роли OAuth 2.0 Authorization Servers, управляя аутентификацией пользователей напрямую, а не делегируя её внешним сервисам, таким как Microsoft Entra ID. С **26 апреля 2025 года** обновление спецификации MCP позволяет MCP-серверам делегировать аутентификацию пользователей внешним сервисам.

### Риски
- Неправильно настроенная логика авторизации на MCP-сервере может привести к раскрытию конфиденциальных данных и неправильному применению контроля доступа.
- Кража OAuth-токена на локальном MCP-сервере. Если токен украден, злоумышленник может использовать его для выдачи себя за MCP-сервер и доступа к ресурсам и данным, защищённым этим токеном.

#### Передача токенов (Token Passthrough)
Передача токенов явно запрещена в спецификации авторизации, так как она влечёт за собой ряд рисков безопасности, включая:

#### Обход мер безопасности
MCP-сервер или нижестоящие API могут реализовывать важные меры безопасности, такие как ограничение частоты запросов, проверка запросов или мониторинг трафика, которые зависят от аудитории токена или других ограничений учётных данных. Если клиенты могут получать и использовать токены напрямую с нижестоящими API без надлежащей проверки MCP-сервером или без гарантии, что токены выданы для нужного сервиса, они обходят эти меры.

#### Проблемы с ответственностью и аудитом
MCP-сервер не сможет идентифицировать или различать MCP-клиентов, если клиенты вызывают сервис с токеном доступа, выданным на верхнем уровне, который может быть непрозрачным для MCP-сервера. Логи нижестоящего Resource Server могут показывать запросы, которые выглядят как исходящие от другого источника с другой идентичностью, а не от MCP-сервера, который фактически пересылает токены. Это усложняет расследование инцидентов, контроль и аудит. Если MCP-сервер передаёт токены без проверки их утверждений (например, ролей, привилегий или аудитории) или другой метадаты, злоумышленник с украденным токеном может использовать сервер как прокси для утечки данных.

#### Проблемы с границами доверия
Нижестоящий Resource Server доверяет определённым субъектам. Это доверие может включать предположения о происхождении или поведении клиента. Нарушение этой границы доверия может привести к непредвиденным проблемам. Если токен принимается несколькими сервисами без надлежащей проверки, злоумышленник, скомпрометировавший один сервис, может использовать токен для доступа к другим связанным сервисам.

#### Риск совместимости в будущем
Даже если MCP-сервер сегодня работает как «чистый прокси», ему возможно придётся добавить меры безопасности позже. Начало с правильного разделения аудитории токенов облегчает развитие модели безопасности.

### Меры по снижению рисков

**MCP-серверы НЕ ДОЛЖНЫ принимать токены, которые явно не выданы для MCP-сервера**

- **Проверьте и усилите логику авторизации:** Тщательно проверьте реализацию авторизации на вашем MCP-сервере, чтобы гарантировать доступ к конфиденциальным ресурсам только для нужных пользователей и клиентов. Для практических рекомендаций смотрите [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) и [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/).
- **Соблюдайте безопасные практики работы с токенами:** Следуйте [лучшим практикам Microsoft по проверке и срокам действия токенов](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens), чтобы предотвратить неправильное использование токенов доступа и снизить риск их повторного использования или кражи.
- **Защищайте хранение токенов:** Всегда храните токены в безопасном виде и используйте шифрование для защиты данных в покое и при передаче. Советы по реализации смотрите в [Use secure token storage and encrypt tokens](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2).

# Избыточные права для MCP-серверов

### Постановка проблемы
MCP-серверам могли быть предоставлены избыточные права на сервис или ресурс, к которому они обращаются. Например, MCP-сервер, являющийся частью AI-приложения для продаж и подключающийся к корпоративному хранилищу данных, должен иметь доступ только к данным о продажах, а не ко всем файлам в хранилище. Возвращаясь к принципу наименьших привилегий (одному из старейших принципов безопасности), ни один ресурс не должен иметь прав, превышающих необходимые для выполнения своих задач. AI создаёт дополнительные сложности, так как для обеспечения гибкости сложно точно определить необходимые права.

### Риски  
- Предоставление избыточных прав может позволить злоумышленнику вывести или изменить данные, к которым MCP-сервер не должен иметь доступ. Это также может стать проблемой конфиденциальности, если данные содержат персональную информацию (PII).

### Меры по снижению рисков
- **Применяйте принцип наименьших привилегий:** Предоставляйте MCP-серверу только минимально необходимые права для выполнения его задач. Регулярно пересматривайте и обновляйте эти права, чтобы они не превышали необходимого уровня. Для подробных рекомендаций смотрите [Secure least-privileged access](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access).
- **Используйте ролевой контроль доступа (RBAC):** Назначайте MCP-серверу роли, строго ограниченные конкретными ресурсами и действиями, избегая широких или ненужных прав.
- **Мониторьте и аудируйте права:** Постоянно отслеживайте использование прав и проверяйте логи доступа, чтобы своевременно выявлять и устранять избыточные или неиспользуемые привилегии.

# Косвенные инъекции подсказок

### Постановка проблемы

Злоумышленные или скомпрометированные MCP-серверы могут представлять серьёзные риски, раскрывая данные клиентов или вызывая непреднамеренные действия. Эти риски особенно актуальны для AI и MCP-нагрузок, где:

- **Атаки инъекций подсказок:** Злоумышленники внедряют вредоносные инструкции в подсказки или внешний контент, заставляя AI-систему выполнять нежелательные действия или раскрывать конфиденциальные данные. Подробнее: [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **Отравление инструментов:** Злоумышленники манипулируют метаданными инструментов (например, описаниями или параметрами), чтобы повлиять на поведение AI, потенциально обходя меры безопасности или выводя данные. Подробнее: [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **Междоменные инъекции подсказок:** Вредоносные инструкции внедряются в документы, веб-страницы или письма, которые затем обрабатываются AI, что приводит к утечке или манипуляции данными.
- **Динамическое изменение инструментов (Rug Pulls):** Определения инструментов могут изменяться после одобрения пользователем, вводя новые вредоносные действия без ведома пользователя.

Эти уязвимости подчёркивают необходимость надёжной проверки, мониторинга и мер безопасности при интеграции MCP-серверов и инструментов в вашу среду. Для более глубокого изучения смотрите ссылки выше.

![prompt-injection-lg-2048x1034](../../../translated_images/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.ru.png)

**Косвенная инъекция подсказок** (также известная как междоменная инъекция подсказок или XPIA) — критическая уязвимость в генеративных AI-системах, включая те, что используют Model Context Protocol (MCP). В этой атаке вредоносные инструкции скрываются во внешнем контенте — таких как документы, веб-страницы или письма. Когда AI обрабатывает этот контент, он может интерпретировать встроенные инструкции как легитимные команды пользователя, что приводит к непреднамеренным действиям, таким как утечка данных, генерация вредоносного контента или манипуляция взаимодействиями с пользователем. Для подробного объяснения и реальных примеров смотрите [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/).

Особенно опасной формой этой атаки является **Отравление инструментов**. Здесь злоумышленники внедряют вредоносные инструкции в метаданные MCP-инструментов (например, описания или параметры). Поскольку большие языковые модели (LLM) полагаются на эти метаданные при выборе инструментов для вызова, скомпрометированные описания могут обмануть модель, заставив её выполнять несанкционированные вызовы инструментов или обходить меры безопасности. Эти манипуляции часто незаметны для конечных пользователей, но могут быть интерпретированы и выполнены AI-системой. Риск усиливается в хостинговых средах MCP-серверов, где определения инструментов могут обновляться после одобрения пользователем — такой сценарий иногда называют «[rug pull](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)». В таких случаях инструмент, ранее безопасный, может быть изменён для выполнения вредоносных действий, таких как утечка данных или изменение поведения системы, без ведома пользователя. Подробнее об этом в [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks).

![tool-injection-lg-2048x1239 (1)](../../../translated_images/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.ru.png)

## Риски
Непреднамеренные действия AI несут различные риски безопасности, включая утечку данных и нарушение конфиденциальности.

### Меры по снижению рисков
### Использование Prompt Shields для защиты от косвенных инъекций подсказок
-----------------------------------------------------------------------------

**AI Prompt Shields** — решение Microsoft для защиты от прямых и косвенных атак инъекций подсказок. Они помогают за счёт:

1.  **Обнаружения и фильтрации:** Prompt Shields используют продвинутые алгоритмы машинного обучения и обработку естественного языка для выявления и фильтрации вредоносных инструкций, встроенных во внешний контент, такой как документы, веб-страницы или письма.
    
2.  **Spotlighting:** Эта техника помогает AI-системе отличать легитимные системные инструкции от потенциально ненадёжных внешних данных. Преобразуя входной текст так, чтобы он был более релевантен модели, Spotlighting обеспечивает лучшее распознавание и игнорирование вредоносных инструкций.
    
3.  **Разделители и маркировка данных:** Включение разделителей в системное сообщение явно указывает расположение входного текста, помогая AI-системе распознавать и отделять пользовательский ввод от потенциально опасного внешнего контента. Маркировка данных расширяет эту концепцию, используя специальные метки для выделения границ доверенных и недоверенных данных.
    
4.  **Постоянный мониторинг и обновления:** Microsoft непрерывно отслеживает и обновляет Prompt Shields для борьбы с новыми и развивающимися угрозами. Такой проактивный подход обеспечивает эффективность защиты против последних методов атак.
    
5. **Интеграция с Azure Content Safety:** Prompt Shields являются частью более широкой платформы Azure AI Content Safety, которая предоставляет дополнительные инструменты для обнаружения попыток обхода защиты, вредоносного контента и других рисков безопасности в AI-приложениях.

Подробнее о AI Prompt Shields можно узнать в [документации Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection).

![prompt-shield-lg-2048x1328](../../../translated_images/prompt-shield.ff5b95be76e9c78c6ec0888206a4a6a0a5ab4bb787832a9eceef7a62fe0138d1.ru.png)

# Проблема «запутавшегося заместителя»

### Постановка проблемы
Проблема «запутавшегося заместителя» — это уязвимость безопасности, которая возникает, когда сервер MCP выступает в роли прокси между клиентами MCP и сторонними API. Эту уязвимость можно использовать, если сервер MCP использует статический client ID для аутентификации на стороннем сервере авторизации, который не поддерживает динамическую регистрацию клиентов.

### Риски

- **Обход согласия на основе cookie**: Если пользователь ранее аутентифицировался через прокси-сервер MCP, сторонний сервер авторизации может установить cookie с согласием в браузере пользователя. Злоумышленник может позже воспользоваться этим, отправив пользователю вредоносную ссылку с поддельным запросом авторизации, содержащим вредоносный redirect URI.
- **Кража кода авторизации**: При клике по вредоносной ссылке сторонний сервер авторизации может пропустить экран согласия из-за существующего cookie, и код авторизации будет перенаправлен на сервер злоумышленника.
- **Несанкционированный доступ к API**: Злоумышленник может обменять украденный код авторизации на токены доступа и выдать себя за пользователя для доступа к стороннему API без явного разрешения.

### Меры по снижению рисков

- **Требование явного согласия**: Прокси-серверы MCP, использующие статические client ID, **ДОЛЖНЫ** получать согласие пользователя для каждого динамически зарегистрированного клиента перед пересылкой на сторонние серверы авторизации.
- **Правильная реализация OAuth**: Следуйте лучшим практикам безопасности OAuth 2.1, включая использование code challenges (PKCE) для запросов авторизации, чтобы предотвратить атаки перехвата.
- **Валидация клиентов**: Реализуйте строгую проверку redirect URI и идентификаторов клиентов, чтобы предотвратить эксплуатацию уязвимостей злоумышленниками.


# Уязвимости при передаче токенов

### Описание проблемы

«Передача токенов» — это антипаттерн, при котором сервер MCP принимает токены от клиента MCP без проверки того, что токены были выданы именно серверу MCP, и затем «передаёт» их дальше в downstream API. Такая практика явно нарушает спецификацию авторизации MCP и создаёт серьёзные риски безопасности.

### Риски

- **Обход мер безопасности**: Клиенты могут обходить важные меры безопасности, такие как ограничение частоты запросов, проверка запросов или мониторинг трафика, если они могут использовать токены напрямую с downstream API без надлежащей проверки.
- **Проблемы с ответственностью и аудитом**: Сервер MCP не сможет идентифицировать или различать клиентов MCP, если они используют токены доступа, выданные upstream, что усложняет расследование инцидентов и аудит.
- **Экфильтрация данных**: Если токены передаются без проверки утверждений (claims), злоумышленник с украденным токеном может использовать сервер как прокси для вывода данных.
- **Нарушение границ доверия**: Downstream серверы ресурсов могут доверять определённым субъектам, исходя из предположений о происхождении или поведении. Нарушение этой границы доверия может привести к неожиданным проблемам безопасности.
- **Неправильное использование токенов в нескольких сервисах**: Если токены принимаются несколькими сервисами без проверки, злоумышленник, скомпрометировавший один сервис, может использовать токен для доступа к другим связанным сервисам.

### Меры по снижению рисков

- **Проверка токенов**: MCP серверы **НЕ ДОЛЖНЫ** принимать токены, которые явно не были выданы для самого MCP сервера.
- **Проверка аудитории**: Всегда проверяйте, что токены содержат правильное утверждение audience, соответствующее идентичности MCP сервера.
- **Правильное управление жизненным циклом токенов**: Используйте короткоживущие токены доступа и практики ротации токенов, чтобы снизить риск кражи и неправильного использования токенов.


# Перехват сессии

### Описание проблемы

Перехват сессии — это вектор атаки, при котором клиенту сервер выдаёт идентификатор сессии, а неавторизованная сторона получает и использует этот же идентификатор для выдачи себя за оригинального клиента и выполнения несанкционированных действий от его имени. Это особенно опасно для stateful HTTP серверов, обрабатывающих запросы MCP.

### Риски

- **Внедрение вредоносных событий при перехвате сессии**: Злоумышленник, получивший идентификатор сессии, может отправлять вредоносные события на сервер, который разделяет состояние сессии с сервером, к которому подключён клиент, что может привести к вредоносным действиям или доступу к конфиденциальным данным.
- **Имитация пользователя при перехвате сессии**: Злоумышленник с украденным идентификатором сессии может напрямую обращаться к серверу MCP, обходя аутентификацию и получая доступ как легитимный пользователь.
- **Скомпрометированные возобновляемые потоки**: Если сервер поддерживает повторную доставку или возобновляемые потоки, злоумышленник может преждевременно завершить запрос, который затем будет возобновлён оригинальным клиентом с потенциально вредоносным содержимым.

### Меры по снижению рисков

- **Проверка авторизации**: MCP серверы, реализующие авторизацию, **ДОЛЖНЫ** проверять все входящие запросы и **НЕ ДОЛЖНЫ** использовать сессии для аутентификации.
- **Безопасные идентификаторы сессий**: MCP серверы **ДОЛЖНЫ** использовать безопасные, недетерминированные идентификаторы сессий, сгенерированные с помощью криптографически стойких генераторов случайных чисел. Избегайте предсказуемых или последовательных идентификаторов.
- **Привязка сессии к пользователю**: MCP серверы **ДОЛЖНЫ СТАРАТЬСЯ** привязывать идентификаторы сессий к информации, уникальной для пользователя, например, объединяя идентификатор сессии с внутренним user_id в формате `<user_id>:<session_id>`.
- **Истечение срока действия сессии**: Реализуйте корректное истечение срока действия и ротацию сессий, чтобы ограничить окно уязвимости при компрометации идентификатора сессии.
- **Безопасность транспортного уровня**: Всегда используйте HTTPS для всей коммуникации, чтобы предотвратить перехват идентификаторов сессий.


# Безопасность цепочки поставок

Безопасность цепочки поставок остаётся фундаментальной в эпоху ИИ, но теперь объём того, что считается вашей цепочкой поставок, расширился. Помимо традиционных пакетов кода, необходимо тщательно проверять и контролировать все компоненты, связанные с ИИ, включая базовые модели, сервисы эмбеддингов, провайдеров контекста и сторонние API. Каждый из этих компонентов может стать источником уязвимостей или рисков при неправильном управлении.

**Ключевые практики безопасности цепочки поставок для ИИ и MCP:**
- **Проверяйте все компоненты перед интеграцией:** Это касается не только open-source библиотек, но и ИИ-моделей, источников данных и внешних API. Всегда проверяйте происхождение, лицензии и известные уязвимости.
- **Поддерживайте безопасные конвейеры развертывания:** Используйте автоматизированные CI/CD конвейеры с интегрированным сканированием безопасности для раннего обнаружения проблем. Убедитесь, что в продакшен попадают только доверенные артефакты.
- **Постоянный мониторинг и аудит:** Внедрите непрерывный мониторинг всех зависимостей, включая модели и сервисы данных, чтобы выявлять новые уязвимости или атаки на цепочку поставок.
- **Применяйте принцип наименьших привилегий и контроль доступа:** Ограничьте доступ к моделям, данным и сервисам только тем, что необходимо для работы вашего MCP сервера.
- **Быстро реагируйте на угрозы:** Имейте процесс для патчей или замены скомпрометированных компонентов, а также для ротации секретов и учётных данных при обнаружении нарушений.

[GitHub Advanced Security](https://github.com/security/advanced-security) предоставляет функции, такие как сканирование секретов, сканирование зависимостей и анализ CodeQL. Эти инструменты интегрируются с [Azure DevOps](https://azure.microsoft.com/en-us/products/devops) и [Azure Repos](https://azure.microsoft.com/en-us/products/devops/repos/), помогая командам выявлять и устранять уязвимости как в коде, так и в компонентах цепочки поставок ИИ.

Microsoft также внедряет обширные практики безопасности цепочки поставок внутри компании для всех продуктов. Подробнее в статье [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/).


# Установленные лучшие практики безопасности, которые повысят уровень защиты вашей реализации MCP

Любая реализация MCP наследует существующий уровень безопасности среды вашей организации, на которой она построена, поэтому при рассмотрении безопасности MCP как компонента ваших общих ИИ-систем рекомендуется улучшать общий уровень безопасности. Следующие проверенные меры безопасности особенно актуальны:

- Лучшие практики безопасного кодирования в вашем ИИ-приложении — защита от [OWASP Top 10](https://owasp.org/www-project-top-ten/), [OWASP Top 10 для LLM](https://genai.owasp.org/download/43299/?tmstv=1731900559), использование безопасных хранилищ для секретов и токенов, реализация сквозного шифрования между всеми компонентами приложения и т.д.
- Усиление серверов — использование MFA, своевременное обновление патчей, интеграция сервера с внешним провайдером идентификации для доступа и т.п.
- Поддержание устройств, инфраструктуры и приложений в актуальном состоянии с последними патчами
- Мониторинг безопасности — внедрение логирования и мониторинга ИИ-приложения (включая MCP клиент/серверы) с отправкой логов в централизованную SIEM для обнаружения аномалий
- Архитектура с нулевым доверием — логическая изоляция компонентов с помощью сетевых и идентификационных контролей для минимизации латерального перемещения в случае компрометации ИИ-приложения.

# Основные выводы

- Основы безопасности остаются критически важными: безопасное кодирование, принцип наименьших привилегий, проверка цепочки поставок и непрерывный мониторинг необходимы для MCP и ИИ-нагрузок.
- MCP вводит новые риски — такие как внедрение вредоносных подсказок, отравление инструментов, перехват сессий, проблема «запутавшегося заместителя», уязвимости при передаче токенов и избыточные разрешения — которые требуют как традиционных, так и специфичных для ИИ мер контроля.
- Используйте надёжные практики аутентификации, авторизации и управления токенами, по возможности опираясь на внешних провайдеров идентификации, таких как Microsoft Entra ID.
- Защищайтесь от косвенного внедрения подсказок и отравления инструментов, проверяя метаданные инструментов, отслеживая динамические изменения и используя решения вроде Microsoft Prompt Shields.
- Реализуйте безопасное управление сессиями, используя недетерминированные идентификаторы сессий, привязывая сессии к идентичности пользователя и никогда не используя сессии для аутентификации.
- Предотвращайте атаки «запутавшегося заместителя», требуя явного согласия пользователя для каждого динамически зарегистрированного клиента и внедряя правильные практики безопасности OAuth.
- Избегайте уязвимостей при передаче токенов, гарантируя, что MCP серверы принимают только токены, явно выданные для них, и корректно проверяют утверждения токенов.
- Относитесь ко всем компонентам вашей цепочки поставок ИИ — включая модели, эмбеддинги и провайдеров контекста — с той же тщательностью, что и к зависимостям кода.
- Следите за обновлениями спецификаций MCP и вносите свой вклад в сообщество для формирования безопасных стандартов.

# Дополнительные ресурсы

## Внешние ресурсы
- [Microsoft Digital Defense Report](https://aka.ms/mddr)
- [MCP Specification](https://spec.modelcontextprotocol.io/)
- [MCP Security Best Practices](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices)
- [MCP Authorization Specification](https://modelcontextprotocol.io/specification/draft/basic/authorization)
- [OAuth 2.0 Security Best Practices (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)
- [Prompt Injection in MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- [Tool Poisoning Attacks (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- [Rug Pulls in MCP (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)
- [Prompt Shields Documentation (Microsoft)](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [GitHub Advanced Security](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [Secure Least-Privileged Access (Microsoft)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Best Practices for Token Validation and Lifetime](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [Use Secure Token Storage and Encrypt Tokens (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [Azure API Management as Auth Gateway for MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Using Microsoft Entra ID to Authenticate with MCP Servers](https://den.dev/blog/mcp-server-auth-entra-id-session/)

## Дополнительные документы по безопасности

Для более подробных рекомендаций по безопасности обратитесь к следующим документам:

- [MCP Security Best Practices 2025](./mcp-security-best-practices-2025.md) — Полный список лучших практик безопасности для реализаций MCP
- [Azure Content Safety Implementation](./azure-content-safety-implementation.md) — Примеры интеграции Azure Content Safety с MCP серверами
- [MCP Security Controls 2025](./mcp-security-controls-2025.md) — Последние меры и техники безопасности для защиты MCP-развёртываний
- [MCP Best Practices](./mcp-best-practices.md) — Краткое руководство по безопасности MCP

### Далее

Далее: [Глава 3: Начало работы](../03-GettingStarted/README.md)

**Отказ от ответственности**:  
Этот документ был переведен с помощью сервиса автоматического перевода [Co-op Translator](https://github.com/Azure/co-op-translator). Несмотря на наши усилия по обеспечению точности, просим учитывать, что автоматический перевод может содержать ошибки или неточности. Оригинальный документ на его исходном языке следует считать авторитетным источником. Для получения критически важной информации рекомендуется обращаться к профессиональному переводу, выполненному человеком. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникшие в результате использования данного перевода.
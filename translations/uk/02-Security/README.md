<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "f00aedb7b1d11b7eaacb0618d8791c65",
  "translation_date": "2025-06-17T17:02:55+00:00",
  "source_file": "02-Security/README.md",
  "language_code": "uk"
}
-->
# Найкращі практики безпеки

Впровадження протоколу Model Context Protocol (MCP) відкриває потужні нові можливості для застосунків на базі штучного інтелекту, але водночас створює унікальні виклики в галузі безпеки, які виходять за межі традиційних ризиків програмного забезпечення. Окрім уже відомих питань, таких як безпечне кодування, принцип найменших привілеїв та безпека ланцюга постачання, MCP і робочі навантаження AI стикаються з новими загрозами, такими як ін’єкція підказок, отруєння інструментів і динамічне модифікування інструментів. Ці ризики можуть призвести до витоку даних, порушення конфіденційності та непередбачуваної поведінки системи, якщо їх не контролювати належним чином.

У цьому уроці розглядаються найбільш актуальні ризики безпеки, пов’язані з MCP — включно з автентифікацією, авторизацією, надмірними правами, непрямою ін’єкцією підказок і вразливостями ланцюга постачання — а також пропонуються практичні заходи та найкращі практики для їх мінімізації. Ви також дізнаєтесь, як використовувати рішення Microsoft, такі як Prompt Shields, Azure Content Safety і GitHub Advanced Security, щоб посилити реалізацію MCP. Розуміючи і застосовуючи ці заходи, ви зможете суттєво знизити ймовірність порушення безпеки та забезпечити надійність і довіру до ваших AI-систем.

# Цілі навчання

До кінця цього уроку ви зможете:

- Визначати та пояснювати унікальні ризики безпеки, які виникають через Model Context Protocol (MCP), зокрема ін’єкцію підказок, отруєння інструментів, надмірні права та вразливості ланцюга постачання.
- Описувати та застосовувати ефективні заходи для мінімізації ризиків безпеки MCP, такі як надійна автентифікація, принцип найменших привілеїв, безпечне управління токенами та перевірка ланцюга постачання.
- Розуміти та використовувати рішення Microsoft, такі як Prompt Shields, Azure Content Safety і GitHub Advanced Security, для захисту MCP і AI-робочих навантажень.
- Усвідомлювати важливість перевірки метаданих інструментів, моніторингу динамічних змін і захисту від непрямих атак ін’єкції підказок.
- Інтегрувати встановлені найкращі практики безпеки — такі як безпечне кодування, зміцнення серверів і архітектуру нульової довіри — у вашу реалізацію MCP для зменшення ймовірності та наслідків порушень безпеки.

# Заходи безпеки MCP

Будь-яка система, що має доступ до важливих ресурсів, стикається з певними викликами безпеки. Зазвичай ці виклики можна подолати за допомогою правильного застосування базових заходів та концепцій безпеки. Оскільки MCP лише нещодавно визначено, специфікація швидко змінюється та розвивається. З часом заходи безпеки в рамках протоколу дозріють, що дозволить краще інтегрувати їх у корпоративні та усталені архітектури безпеки й найкращі практики.

Дослідження, опубліковане у [Microsoft Digital Defense Report](https://aka.ms/mddr), свідчить, що 98% зафіксованих порушень можна було б запобігти за умови дотримання належної гігієни безпеки. Найкращий захист від будь-яких порушень — це правильно налаштована базова гігієна безпеки, найкращі практики безпечного кодування та безпека ланцюга постачання — ці перевірені підходи все ще мають найбільший вплив на зниження ризиків безпеки.

Розглянемо деякі способи, як ви можете почати вирішувати питання безпеки при впровадженні MCP.

> **Note:** Наступна інформація актуальна станом на **29 травня 2025 року**. Протокол MCP постійно розвивається, і майбутні реалізації можуть впроваджувати нові схеми автентифікації та заходи контролю. Для останніх оновлень і рекомендацій завжди звертайтесь до [MCP Specification](https://spec.modelcontextprotocol.io/), офіційного [репозиторію MCP на GitHub](https://github.com/modelcontextprotocol) та сторінки з [найкращими практиками безпеки](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices).

### Постановка проблеми  
Початкова специфікація MCP передбачала, що розробники створюватимуть власний сервер автентифікації. Це вимагало знань про OAuth і пов’язані з ним обмеження безпеки. Сервери MCP діяли як OAuth 2.0 Authorization Servers, безпосередньо керуючи автентифікацією користувачів, а не делегуючи її зовнішнім сервісам, таким як Microsoft Entra ID. Станом на **26 квітня 2025 року** оновлення специфікації MCP дозволяє MCP серверам делегувати автентифікацію користувачів зовнішнім сервісам.

### Ризики
- Некоректно налаштована логіка авторизації на MCP сервері може призвести до розкриття конфіденційних даних та неправильного застосування контролю доступу.
- Крадіжка OAuth токена на локальному MCP сервері. У разі викрадення токен може бути використаний для імітації MCP сервера та доступу до ресурсів і даних сервісу, для якого видано цей токен.

#### Пряме передавання токена
Пряме передавання токена категорично заборонено у специфікації авторизації, оскільки це створює низку ризиків безпеки, зокрема:

#### Обхід заходів безпеки
MCP сервер або нижчестоячі API можуть реалізовувати важливі заходи безпеки, такі як обмеження швидкості запитів, валідація запитів або моніторинг трафіку, які залежать від аудиторії токена або інших обмежень облікових даних. Якщо клієнти можуть отримувати та використовувати токени безпосередньо з нижчестоячих API без належної валідації MCP сервером або без перевірки, що токени видані для правильного сервісу, вони обходять ці заходи контролю.

#### Проблеми з відповідальністю та аудиторією
MCP сервер не зможе ідентифікувати або розрізнити MCP клієнтів, коли ті звертаються з токеном доступу, виданим зовнішнім сервісом, який може бути непрозорим для MCP сервера. Логи ресурсного сервера нижчого рівня можуть показувати запити, які, здається, надходять від іншого джерела з іншою ідентичністю, а не від MCP сервера, який фактично пересилає токени. Обидва фактори ускладнюють розслідування інцидентів, контроль і аудит. Якщо MCP сервер передає токени без перевірки їхніх претензій (наприклад, ролей, привілеїв чи аудиторії) або інших метаданих, зловмисник, що має викрадений токен, може використовувати сервер як проксі для витоку даних.

#### Проблеми меж довіри
Ресурсний сервер нижчого рівня надає довіру конкретним суб’єктам. Ця довіра може базуватися на припущеннях про походження або поведінкові патерни клієнта. Порушення цієї межі довіри може призвести до непередбачуваних проблем. Якщо токен приймається кількома сервісами без належної валідації, атакуючий, який скомпрометував один сервіс, може використовувати токен для доступу до інших пов’язаних сервісів.

#### Ризик сумісності в майбутньому
Навіть якщо MCP сервер сьогодні починає як «чистий проксі», йому може знадобитися додати заходи безпеки пізніше. Початок з правильної сегрегації аудиторії токенів полегшує еволюцію моделі безпеки.

### Заходи мінімізації

**MCP сервери НЕ ПОВИННІ приймати токени, які не були явно видані для цього MCP сервера**

- **Перегляньте та зміцніть логіку авторизації:** Ретельно перевірте реалізацію авторизації на вашому MCP сервері, щоб гарантувати доступ лише для передбачених користувачів і клієнтів до конфіденційних ресурсів. Для практичних порад див. [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) та [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/).
- **Дотримуйтесь безпечних практик роботи з токенами:** Виконуйте рекомендації [Microsoft щодо валідації токенів і терміну їх дії](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens), щоб запобігти зловживанню токенами доступу і знизити ризик повторного використання або викрадення токенів.
- **Захищайте зберігання токенів:** Завжди зберігайте токени безпечно, використовуйте шифрування для захисту їх у спокої та під час передачі. Для порад щодо впровадження див. [Use secure token storage and encrypt tokens](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2).

# Надмірні права для MCP серверів

### Постановка проблеми
MCP сервери можуть мати надмірні права на сервіс або ресурс, до яких вони звертаються. Наприклад, MCP сервер, що є частиною AI-застосунку для продажів і підключається до корпоративного сховища даних, повинен мати доступ лише до даних продажів, а не до всіх файлів у сховищі. Звертаючись до принципу найменших привілеїв (одного з найстаріших принципів безпеки), жоден ресурс не повинен мати більше прав, ніж потрібно для виконання своїх завдань. AI створює додаткові виклики в цій сфері, оскільки для забезпечення гнучкості складно точно визначити необхідні права.

### Ризики  
- Надмірні права можуть дозволити витік або зміну даних, до яких MCP сервер не повинен мати доступ. Це також може бути проблемою конфіденційності, якщо дані містять персональну інформацію (PII).

### Заходи мінімізації
- **Застосовуйте принцип найменших привілеїв:** Надавайте MCP серверу лише мінімальні права, необхідні для виконання його завдань. Регулярно переглядайте і оновлюйте ці права, щоб вони не перевищували необхідного рівня. Для детальних рекомендацій див. [Secure least-privileged access](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access).
- **Використовуйте контроль доступу на основі ролей (RBAC):** Призначайте MCP серверу ролі, чітко обмежені певними ресурсами та діями, уникаючи широких або непотрібних прав.
- **Моніторинг і аудит прав:** Постійно відстежуйте використання прав і перевіряйте журнали доступу, щоб оперативно виявляти та усувати надмірні або невикористовувані привілеї.

# Непрямі атаки ін’єкції підказок

### Постановка проблеми

Зловмисні або скомпрометовані MCP сервери можуть створювати серйозні ризики, розкриваючи дані клієнтів або виконуючи небажані дії. Ці ризики особливо актуальні для AI і MCP-орієнтованих робочих навантажень, де:

- **Атаки ін’єкції підказок:** Зловмисники вбудовують шкідливі інструкції у підказки або зовнішній контент, змушуючи AI-систему виконувати небажані дії або розкривати конфіденційні дані. Детальніше: [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **Отруєння інструментів:** Зловмисники маніпулюють метаданими інструментів (наприклад, описами або параметрами), щоб впливати на поведінку AI, потенційно обходячи заходи безпеки або виводячи дані. Деталі: [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **Крос-доменна ін’єкція підказок:** Шкідливі інструкції вбудовуються в документи, веб-сторінки або електронні листи, які потім обробляються AI, що призводить до витоку або маніпуляції даними.
- **Динамічне модифікування інструментів (Rug Pulls):** Визначення інструментів можуть змінюватися після схвалення користувачем, вводячи нові шкідливі функції без відома користувача.

Ці вразливості підкреслюють необхідність надійної перевірки, моніторингу та заходів безпеки при інтеграції MCP серверів і інструментів у ваше середовище. Для детальнішого ознайомлення див. наведені посилання.

![prompt-injection-lg-2048x1034](../../../translated_images/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.uk.png)

**Непряма ін’єкція підказок** (також відома як крос-доменна ін’єкція підказок або XPIA) є критичною вразливістю в генеративних AI-системах, включно з тими, що використовують Model Context Protocol (MCP). У цій атаці шкідливі інструкції ховаються у зовнішньому контенті — таких як документи, веб-сторінки або електронні листи. Коли AI обробляє цей контент, він може сприймати вбудовані інструкції як легітимні команди користувача, що призводить до небажаних дій, таких як витік даних, генерація шкідливого контенту або маніпуляція взаємодією з користувачем. Для детального пояснення і прикладів із реального життя див. [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/).

Особливо небезпечною формою цієї атаки є **Отруєння інструментів**. Тут зловмисники вводять шкідливі інструкції у метадані MCP інструментів (наприклад, описи чи параметри). Оскільки великі мовні моделі (LLM) використовують ці метадані для вибору інструментів, скомпрометовані описи можуть обманути модель, змусивши її виконати несанкціоновані виклики інструментів або обійти заходи безпеки. Ці маніпуляції часто непомітні для кінцевих користувачів, але можуть бути інтерпретовані та виконані AI-системою. Цей ризик посилюється в хостингових середовищах MCP серверів, де визначення інструментів можуть оновлюватися після схвалення користувачем — сценарій, відомий як "[rug pull](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)". У таких випадках інструмент, який раніше був безпечним, може бути змінений для виконання шкідливих дій, таких як витік даних або зміна поведінки системи, без відома користувача. Детальніше про цей вектор атаки див. [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks).

![tool-injection-lg-2048x1239 (1)](../../../translated_images/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.uk.png)

## Ризики
Небажані дії AI створюють різноманітні ризики безпеки, включно з витоком даних та порушенням конфіденційності.

### Заход
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [GitHub Advanced Security](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [Подорож до забезпечення безпеки ланцюжка постачання програмного забезпечення в Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [Забезпечення мінімально необхідного доступу (Microsoft)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Кращі практики перевірки токенів та їх терміну дії](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [Використання безпечного зберігання токенів та їх шифрування (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [Azure API Management як шлюз автентифікації для MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Кращі практики безпеки MCP](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices)
- [Використання Microsoft Entra ID для автентифікації на MCP серверах](https://den.dev/blog/mcp-server-auth-entra-id-session/)

### Далі

Далі: [Розділ 3: Початок роботи](/03-GettingStarted/README.md)

**Відмова від відповідальності**:  
Цей документ був перекладений за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ рідною мовою слід вважати авторитетним джерелом. Для критично важливої інформації рекомендується звертатися до професійного людського перекладу. Ми не несемо відповідальності за будь-які непорозуміння або неправильні тлумачення, що виникли внаслідок використання цього перекладу.
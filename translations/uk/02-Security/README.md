<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "c69f9df7f3215dac8d056020539bac36",
  "translation_date": "2025-07-13T17:09:58+00:00",
  "source_file": "02-Security/README.md",
  "language_code": "uk"
}
-->
# Кращі практики безпеки

Впровадження Model Context Protocol (MCP) відкриває нові потужні можливості для додатків на основі штучного інтелекту, але також створює унікальні виклики в галузі безпеки, які виходять за межі традиційних ризиків програмного забезпечення. Окрім відомих питань, таких як безпечне кодування, принцип найменших привілеїв і безпека ланцюга постачання, MCP і робочі навантаження AI стикаються з новими загрозами, такими як ін’єкція підказок, отруєння інструментів і динамічна модифікація інструментів. Ці ризики можуть призвести до витоку даних, порушення конфіденційності та небажаної поведінки системи, якщо їх належним чином не контролювати.

У цьому уроці розглядаються найактуальніші ризики безпеки, пов’язані з MCP — включно з автентифікацією, авторизацією, надмірними правами, непрямою ін’єкцією підказок і вразливостями ланцюга постачання — а також надаються практичні заходи контролю та кращі практики для їх пом’якшення. Ви також дізнаєтеся, як використовувати рішення Microsoft, такі як Prompt Shields, Azure Content Safety і GitHub Advanced Security, щоб посилити реалізацію MCP. Розуміючи та застосовуючи ці заходи контролю, ви зможете значно знизити ймовірність порушення безпеки та забезпечити надійність і довіру до ваших AI-систем.

# Цілі навчання

До кінця цього уроку ви зможете:

- Визначати та пояснювати унікальні ризики безпеки, які виникають через Model Context Protocol (MCP), включно з ін’єкцією підказок, отруєнням інструментів, надмірними правами та вразливостями ланцюга постачання.
- Описувати та застосовувати ефективні заходи пом’якшення ризиків безпеки MCP, такі як надійна автентифікація, принцип найменших привілеїв, безпечне управління токенами та перевірка ланцюга постачання.
- Розуміти та використовувати рішення Microsoft, такі як Prompt Shields, Azure Content Safety і GitHub Advanced Security, для захисту MCP і AI-робочих навантажень.
- Усвідомлювати важливість перевірки метаданих інструментів, моніторингу динамічних змін і захисту від непрямих атак ін’єкції підказок.
- Інтегрувати встановлені кращі практики безпеки — такі як безпечне кодування, захист серверів і архітектура нульової довіри — у вашу реалізацію MCP, щоб зменшити ймовірність і наслідки порушень безпеки.

# Заходи контролю безпеки MCP

Будь-яка система, що має доступ до важливих ресурсів, стикається з певними викликами безпеки. Зазвичай ці виклики можна вирішити шляхом правильного застосування базових заходів контролю безпеки та концепцій. Оскільки MCP є новим протоколом, його специфікація швидко змінюється і розвивається. З часом заходи контролю безпеки в ньому вдосконаляться, що дозволить краще інтегрувати MCP з корпоративними та встановленими архітектурами безпеки і кращими практиками.

Дослідження, опубліковане в [Microsoft Digital Defense Report](https://aka.ms/mddr), свідчить, що 98% зафіксованих порушень можна було б запобігти завдяки дотриманню надійної гігієни безпеки. Найкращий захист від будь-яких порушень — це правильне впровадження базових практик безпеки, безпечного кодування та безпеки ланцюга постачання — ті перевірені часом підходи, які й досі мають найбільший вплив на зниження ризиків.

Розглянемо деякі способи, як можна почати вирішувати ризики безпеки при впровадженні MCP.

> **Note:** Наведена інформація актуальна станом на **29 травня 2025 року**. Протокол MCP постійно розвивається, і майбутні реалізації можуть вводити нові схеми автентифікації та заходи контролю. Для останніх оновлень і рекомендацій завжди звертайтеся до [MCP Specification](https://spec.modelcontextprotocol.io/), офіційного [репозиторію MCP на GitHub](https://github.com/modelcontextprotocol) та [сторінки кращих практик безпеки](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices).

### Постановка проблеми  
Початкова специфікація MCP передбачала, що розробники самостійно створюватимуть сервер автентифікації. Це вимагало знань про OAuth та пов’язані обмеження безпеки. Сервери MCP діяли як OAuth 2.0 Authorization Servers, безпосередньо керуючи автентифікацією користувачів, а не делегуючи її зовнішнім сервісам, таким як Microsoft Entra ID. Станом на **26 квітня 2025 року** оновлення специфікації MCP дозволяє MCP-серверам делегувати автентифікацію користувачів зовнішньому сервісу.

### Ризики
- Неправильно налаштована логіка авторизації на сервері MCP може призвести до витоку конфіденційних даних і неправильного застосування контролю доступу.
- Крадіжка OAuth-токенів на локальному сервері MCP. Якщо токен викрадений, його можна використати для імітації сервера MCP і доступу до ресурсів і даних сервісу, для якого цей токен призначений.

#### Передача токенів (Token Passthrough)
Передача токенів прямо заборонена в специфікації авторизації, оскільки вона створює низку ризиків безпеки, зокрема:

#### Обхід заходів контролю безпеки
Сервер MCP або нижчі API можуть реалізовувати важливі заходи контролю безпеки, такі як обмеження частоти запитів, валідація запитів або моніторинг трафіку, які залежать від аудиторії токена або інших обмежень облікових даних. Якщо клієнти можуть отримувати і використовувати токени безпосередньо з нижчих API без належної перевірки сервером MCP або без гарантії, що токени видані для правильного сервісу, вони обходять ці заходи контролю.

#### Проблеми з відповідальністю та аудитом
Сервер MCP не зможе ідентифікувати або розрізнити клієнтів MCP, якщо ті викликають сервер із токеном доступу, виданим зовнішнім сервісом, який може бути непрозорим для MCP-сервера. Логи нижчого Resource Server можуть показувати запити, які здаються такими, що походять від іншого джерела з іншим ідентифікатором, а не від MCP-сервера, який фактично пересилає токени. Обидва ці фактори ускладнюють розслідування інцидентів, контроль і аудит. Якщо MCP-сервер передає токени без перевірки їхніх атрибутів (наприклад, ролей, привілеїв або аудиторії) чи інших метаданих, зловмисник, який має викрадений токен, може використовувати сервер як проксі для витоку даних.

#### Проблеми з межами довіри
Нижчий Resource Server надає довіру певним сутностям. Ця довіра може включати припущення про походження або поведінку клієнта. Порушення цієї межі довіри може призвести до непередбачуваних проблем. Якщо токен приймається кількома сервісами без належної перевірки, зловмисник, який скомпрометував один сервіс, може використовувати токен для доступу до інших пов’язаних сервісів.

#### Ризик сумісності в майбутньому
Навіть якщо MCP-сервер сьогодні починає як «чистий проксі», йому може знадобитися додати заходи контролю безпеки пізніше. Початок із правильною сегрегацією аудиторії токенів полегшує розвиток моделі безпеки.

### Заходи пом’якшення

**MCP-сервери НЕ ПОВИННІ приймати токени, які явно не були видані для цього MCP-сервера**

- **Перевірка та посилення логіки авторизації:** Ретельно перевірте реалізацію авторизації на вашому MCP-сервері, щоб гарантувати, що лише передбачені користувачі та клієнти мають доступ до конфіденційних ресурсів. Для практичних рекомендацій див. [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) та [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/).
- **Дотримання безпечних практик роботи з токенами:** Дотримуйтеся [кращих практик Microsoft щодо валідації токенів і терміну їх дії](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens), щоб запобігти зловживанню токенами доступу та знизити ризик повторного використання або крадіжки токенів.
- **Захист зберігання токенів:** Завжди зберігайте токени безпечно та використовуйте шифрування для їх захисту під час зберігання та передачі. Для порад щодо реалізації див. [Use secure token storage and encrypt tokens](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2).

# Надмірні права для MCP-серверів

### Постановка проблеми  
MCP-серверам могли надати надмірні права на сервіс або ресурс, до якого вони мають доступ. Наприклад, MCP-сервер, який є частиною AI-додатку для продажів і підключається до корпоративного сховища даних, повинен мати доступ лише до даних продажів, а не до всіх файлів у сховищі. Звертаючись до принципу найменших привілеїв (одного з найстаріших принципів безпеки), жоден ресурс не повинен мати права, що перевищують необхідні для виконання своїх завдань. AI створює додаткові виклики в цій сфері, оскільки для забезпечення гнучкості важко точно визначити необхідні права.

### Ризики  
- Надання надмірних прав може дозволити витік або зміну даних, до яких MCP-сервер не повинен мати доступ. Це також може стати проблемою конфіденційності, якщо дані містять персональну інформацію (PII).

### Заходи пом’якшення
- **Застосовуйте принцип найменших привілеїв:** Надавайте MCP-серверу лише мінімальні права, необхідні для виконання його завдань. Регулярно переглядайте та оновлюйте ці права, щоб вони не перевищували необхідний рівень. Для детальних рекомендацій див. [Secure least-privileged access](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access).
- **Використовуйте контроль доступу на основі ролей (RBAC):** Призначайте MCP-серверу ролі, які чітко обмежені конкретними ресурсами та діями, уникаючи широких або непотрібних прав.
- **Моніторинг і аудит прав:** Постійно відстежуйте використання прав і перевіряйте журнали доступу, щоб швидко виявляти та усувати надмірні або невикористані привілеї.

# Непрямі атаки ін’єкції підказок

### Постановка проблеми

Зловмисні або скомпрометовані MCP-сервери можуть створювати значні ризики, викриваючи дані клієнтів або дозволяючи небажані дії. Ці ризики особливо актуальні для AI і робочих навантажень на основі MCP, де:

- **Атаки ін’єкції підказок:** Зловмисники вставляють шкідливі інструкції у підказки або зовнішній контент, змушуючи AI-систему виконувати небажані дії або розкривати конфіденційні дані. Детальніше: [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **Отруєння інструментів:** Зловмисники маніпулюють метаданими інструментів (наприклад, описами або параметрами), щоб впливати на поведінку AI, потенційно обходячи заходи безпеки або викрадаючи дані. Деталі: [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **Крос-доменна ін’єкція підказок:** Шкідливі інструкції вбудовуються в документи, веб-сторінки або електронні листи, які потім обробляються AI, що призводить до витоку або маніпуляції даними.
- **Динамічна модифікація інструментів (Rug Pulls):** Визначення інструментів можуть змінюватися після схвалення користувачем, вводячи нову шкідливу поведінку без відома користувача.

Ці вразливості підкреслюють необхідність надійної перевірки, моніторингу та заходів безпеки при інтеграції MCP-серверів і інструментів у ваше середовище. Для детальнішого ознайомлення див. наведені посилання вище.

![prompt-injection-lg-2048x1034](../../../translated_images/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.uk.png)

**Непряма ін’єкція підказок** (також відома як крос-доменна ін’єкція підказок або XPIA) — це критична вразливість у генеративних AI-системах, включно з тими, що використовують Model Context Protocol (MCP). У цій атаці шкідливі інструкції приховані у зовнішньому контенті — наприклад, у документах, веб-сторінках або електронних листах. Коли AI-система обробляє цей контент, вона може інтерпретувати вбудовані інструкції як легітимні команди користувача, що призводить до небажаних дій, таких як витік даних, генерація шкідливого контенту або маніпуляція взаємодією з користувачем. Для детального пояснення та реальних прикладів див. [Prompt Injection](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/).

Особливо небезпечним видом цієї атаки є **Отруєння інструментів**. Зловмисники впроваджують шкідливі інструкції у метадані MCP-інструментів (наприклад, описи або параметри). Оскільки великі мовні моделі (LLM) покладаються на ці метадані, щоб вирішити, які інструменти викликати, скомпрометовані описи можуть обманути модель, змусивши її виконати несанкціоновані виклики інструментів або обійти заходи безпеки. Ці маніпуляції часто непомітні для кінцевих користувачів, але можуть бути інтерпретовані і виконані AI-системою. Цей ризик посилюється в хостингових середовищах MCP-серверів, де визначення інструментів можуть оновлюватися після схвалення користувачем — сценарій, який іноді називають "[rug pull](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)". У таких випадках інструмент, який раніше був безпечним, може пізніше бути змінений для виконання шкідливих дій, таких як витік даних або зміна поведінки системи, без відома користувача. Детальніше про цей вектор атаки див. [Tool Poisoning](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks).

![tool-injection-lg-2048x1239 (1)](../../../translated_images/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.uk.png)

## Ризики  
Небажані
Безпека ланцюга постачання залишається фундаментальною у епоху ШІ, але межі того, що вважається вашим ланцюгом постачання, розширилися. Окрім традиційних пакетів коду, тепер необхідно ретельно перевіряти та контролювати всі компоненти, пов’язані зі ШІ, включно з базовими моделями, сервісами вбудовування, провайдерами контексту та сторонніми API. Кожен із них може стати джерелом вразливостей або ризиків, якщо ним неправильно керувати.

**Ключові практики безпеки ланцюга постачання для ШІ та MCP:**
- **Перевіряйте всі компоненти перед інтеграцією:** Це стосується не лише бібліотек з відкритим кодом, а й моделей ШІ, джерел даних та зовнішніх API. Завжди перевіряйте походження, ліцензії та відомі вразливості.
- **Підтримуйте безпечні конвеєри розгортання:** Використовуйте автоматизовані CI/CD конвеєри з інтегрованим скануванням безпеки для раннього виявлення проблем. Переконайтеся, що у виробництво потрапляють лише довірені артефакти.
- **Постійно моніторте та аудитуйте:** Впровадьте безперервний моніторинг усіх залежностей, включно з моделями та сервісами даних, щоб виявляти нові вразливості або атаки на ланцюг постачання.
- **Застосовуйте принцип найменших привілеїв та контроль доступу:** Обмежуйте доступ до моделей, даних і сервісів лише тим, що необхідно для роботи вашого MCP сервера.
- **Швидко реагуйте на загрози:** Майте процес для патчування або заміни скомпрометованих компонентів, а також для ротації секретів чи облікових даних у разі виявлення порушення.

[GitHub Advanced Security](https://github.com/security/advanced-security) надає функції, такі як сканування секретів, сканування залежностей і аналіз CodeQL. Ці інструменти інтегруються з [Azure DevOps](https://azure.microsoft.com/en-us/products/devops) та [Azure Repos](https://azure.microsoft.com/en-us/products/devops/repos/), допомагаючи командам виявляти та усувати вразливості як у коді, так і в компонентах ланцюга постачання ШІ.

Microsoft також впроваджує широкі практики безпеки ланцюга постачання всередині компанії для всіх продуктів. Детальніше читайте у [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/).


# Визнані найкращі практики безпеки, які підвищать рівень безпеки вашої реалізації MCP

Будь-яка реалізація MCP успадковує існуючий рівень безпеки середовища вашої організації, на якому вона побудована, тому при розгляді безпеки MCP як компонента ваших загальних систем ШІ рекомендується підвищувати загальний рівень безпеки. Особливо актуальними є такі встановлені заходи безпеки:

-   Найкращі практики безпечного кодування у вашому ШІ-додатку — захист від [OWASP Top 10](https://owasp.org/www-project-top-ten/), [OWASP Top 10 для LLM](https://genai.owasp.org/download/43299/?tmstv=1731900559), використання безпечних сховищ для секретів і токенів, впровадження наскрізного захищеного зв’язку між усіма компонентами додатку тощо.
-   Захист серверів — використовуйте MFA, де можливо, підтримуйте оновлення патчів, інтегруйте сервер із стороннім провайдером ідентифікації для контролю доступу тощо.
-   Підтримуйте пристрої, інфраструктуру та додатки в актуальному стані з оновленнями.
-   Моніторинг безпеки — впроваджуйте логування та моніторинг ШІ-додатків (включно з клієнтами/серверами MCP) і надсилайте ці логи до центральної SIEM для виявлення аномальної активності.
-   Архітектура нульової довіри — ізолюйте компоненти за допомогою мережевих та ідентифікаційних контролів логічним чином, щоб мінімізувати можливість бокового руху у разі компрометації ШІ-додатку.

# Основні висновки

- Основи безпеки залишаються критично важливими: безпечне кодування, принцип найменших привілеїв, перевірка ланцюга постачання та безперервний моніторинг є необхідними для MCP і робочих навантажень ШІ.
- MCP вводить нові ризики — такі як ін’єкції підказок, отруєння інструментів і надмірні дозволи — які потребують як традиційних, так і специфічних для ШІ заходів контролю.
- Використовуйте надійну аутентифікацію, авторизацію та практики управління токенами, за можливості залучаючи зовнішніх провайдерів ідентифікації, таких як Microsoft Entra ID.
- Захищайтеся від непрямої ін’єкції підказок і отруєння інструментів, перевіряючи метадані інструментів, моніторячи динамічні зміни та використовуючи рішення на кшталт Microsoft Prompt Shields.
- Ставтеся до всіх компонентів вашого ланцюга постачання ШІ — включно з моделями, вбудовуваннями та провайдерами контексту — з такою ж увагою, як і до залежностей коду.
- Слідкуйте за оновленнями специфікацій MCP і долучайтеся до спільноти, щоб допомогти формувати безпечні стандарти.

# Додаткові ресурси

- [Microsoft Digital Defense Report](https://aka.ms/mddr)
- [MCP Specification](https://spec.modelcontextprotocol.io/)
- [Prompt Injection in MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- [Tool Poisoning Attacks (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- [Rug Pulls in MCP (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)
- [Prompt Shields Documentation (Microsoft)](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Top 10 for LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [GitHub Advanced Security](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [Secure Least-Privileged Access (Microsoft)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Best Practices for Token Validation and Lifetime](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [Use Secure Token Storage and Encrypt Tokens (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [Azure API Management as Auth Gateway for MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [MCP Security Best Practice](https://modelcontextprotocol.io/specification/draft/basic/security_best_practices)
- [Using Microsoft Entra ID to Authenticate with MCP Servers](https://den.dev/blog/mcp-server-auth-entra-id-session/)

### Далі

Далі: [Розділ 3: Початок роботи](../03-GettingStarted/README.md)

**Відмова від відповідальності**:  
Цей документ було перекладено за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ рідною мовою слід вважати авторитетним джерелом. Для критично важливої інформації рекомендується звертатися до професійного людського перекладу. Ми не несемо відповідальності за будь-які непорозуміння або неправильні тлумачення, що виникли внаслідок використання цього перекладу.
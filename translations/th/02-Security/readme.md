<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "98be664d3b19a81ee24fa3f920233864",
  "translation_date": "2025-05-17T07:32:04+00:00",
  "source_file": "02-Security/readme.md",
  "language_code": "th"
}
-->
# แนวปฏิบัติที่ดีที่สุดด้านความปลอดภัย

การนำ Model Context Protocol (MCP) มาใช้ช่วยเพิ่มความสามารถใหม่ที่ทรงพลังให้กับแอปพลิเคชันที่ขับเคลื่อนด้วย AI แต่ก็ยังนำมาซึ่งความท้าทายด้านความปลอดภัยที่ไม่เหมือนใคร ซึ่งนอกเหนือจากความเสี่ยงของซอฟต์แวร์แบบดั้งเดิม ในการใช้งาน MCP และภาระงาน AI ยังเผชิญกับภัยคุกคามใหม่ เช่น การฉีดคำสั่งที่ไม่พึงประสงค์ การปนเปื้อนของเครื่องมือ และการปรับเปลี่ยนเครื่องมือแบบไดนามิก ความเสี่ยงเหล่านี้สามารถนำไปสู่การรั่วไหลของข้อมูล การละเมิดความเป็นส่วนตัว และพฤติกรรมของระบบที่ไม่ตั้งใจ หากไม่ได้รับการจัดการอย่างเหมาะสม

บทเรียนนี้สำรวจความเสี่ยงด้านความปลอดภัยที่เกี่ยวข้องมากที่สุดที่เกี่ยวข้องกับ MCP รวมถึงการตรวจสอบสิทธิ์ การอนุญาต สิทธิ์ที่มากเกินไป การฉีดคำสั่งที่ไม่พึงประสงค์ทางอ้อม และช่องโหว่ของซัพพลายเชน และให้การควบคุมและแนวปฏิบัติที่ดีที่สุดที่สามารถดำเนินการได้เพื่อลดความเสี่ยง คุณจะได้เรียนรู้วิธีใช้โซลูชันของ Microsoft เช่น Prompt Shields, Azure Content Safety และ GitHub Advanced Security เพื่อเสริมสร้างการใช้งาน MCP ของคุณ โดยการทำความเข้าใจและนำการควบคุมเหล่านี้ไปใช้ คุณสามารถลดโอกาสในการละเมิดความปลอดภัยได้อย่างมากและทำให้ระบบ AI ของคุณยังคงแข็งแกร่งและน่าเชื่อถือ

# วัตถุประสงค์การเรียนรู้

เมื่อจบบทเรียนนี้ คุณจะสามารถ:

- ระบุและอธิบายความเสี่ยงด้านความปลอดภัยที่ไม่เหมือนใครที่เกิดจาก Model Context Protocol (MCP) รวมถึงการฉีดคำสั่งที่ไม่พึงประสงค์ การปนเปื้อนของเครื่องมือ สิทธิ์ที่มากเกินไป และช่องโหว่ของซัพพลายเชน
- อธิบายและใช้การควบคุมการลดความเสี่ยงที่มีประสิทธิภาพสำหรับความเสี่ยงด้านความปลอดภัยของ MCP เช่น การตรวจสอบสิทธิ์ที่แข็งแกร่ง สิทธิ์น้อยที่สุด การจัดการโทเค็นที่ปลอดภัย และการตรวจสอบซัพพลายเชน
- เข้าใจและใช้โซลูชันของ Microsoft เช่น Prompt Shields, Azure Content Safety และ GitHub Advanced Security เพื่อปกป้อง MCP และภาระงาน AI
- ตระหนักถึงความสำคัญของการตรวจสอบข้อมูลเมตาของเครื่องมือ การตรวจสอบการเปลี่ยนแปลงแบบไดนามิก และการป้องกันการโจมตีการฉีดคำสั่งที่ไม่พึงประสงค์ทางอ้อม
- ผสานรวมแนวปฏิบัติด้านความปลอดภัยที่เป็นที่ยอมรับ เช่น การเขียนโค้ดที่ปลอดภัย การทำให้เซิร์ฟเวอร์แข็งแกร่งขึ้น และสถาปัตยกรรมที่ไม่มีความไว้วางใจ เพื่อการใช้งาน MCP ของคุณเพื่อลดโอกาสและผลกระทบของการละเมิดความปลอดภัย

# การควบคุมความปลอดภัยของ MCP

ระบบใดก็ตามที่สามารถเข้าถึงทรัพยากรสำคัญมีความท้าทายด้านความปลอดภัยโดยนัย ความท้าทายด้านความปลอดภัยสามารถแก้ไขได้โดยทั่วไปผ่านการใช้การควบคุมและแนวคิดด้านความปลอดภัยพื้นฐานอย่างถูกต้อง เนื่องจาก MCP ถูกกำหนดใหม่อย่างรวดเร็ว ข้อกำหนดจึงเปลี่ยนแปลงอย่างรวดเร็วและเมื่อโปรโตคอลพัฒนาไป ในที่สุดการควบคุมความปลอดภัยภายในจะเติบโตเต็มที่ ทำให้สามารถผสานรวมกับสถาปัตยกรรมและแนวปฏิบัติด้านความปลอดภัยขององค์กรและที่เป็นที่ยอมรับได้ดียิ่งขึ้น

การวิจัยที่เผยแพร่ใน [Microsoft Digital Defense Report](https://aka.ms/mddr) ระบุว่า 98% ของการละเมิดที่รายงานจะถูกป้องกันโดยการดูแลความปลอดภัยที่แข็งแกร่ง และการป้องกันที่ดีที่สุดต่อการละเมิดใด ๆ คือการได้รับการดูแลความปลอดภัยพื้นฐานที่ถูกต้อง แนวปฏิบัติที่ดีที่สุดในการเขียนโค้ดอย่างปลอดภัยและความปลอดภัยของซัพพลายเชน — แนวปฏิบัติที่ผ่านการทดสอบแล้วที่เรารู้จักกันดีแล้ว ยังคงมีผลกระทบมากที่สุดในการลดความเสี่ยงด้านความปลอดภัย

มาดูวิธีการบางอย่างที่คุณสามารถเริ่มแก้ไขความเสี่ยงด้านความปลอดภัยเมื่อใช้ MCP

# การตรวจสอบสิทธิ์เซิร์ฟเวอร์ MCP (หากการใช้งาน MCP ของคุณเกิดขึ้นก่อนวันที่ 26 เมษายน 2025)

> **หมายเหตุ:** ข้อมูลต่อไปนี้ถูกต้อง ณ วันที่ 26 เมษายน 2025 โปรโตคอล MCP กำลังพัฒนาอย่างต่อเนื่อง และการใช้งานในอนาคตอาจแนะนำรูปแบบการตรวจสอบสิทธิ์และการควบคุมใหม่ ๆ สำหรับการอัปเดตและคำแนะนำล่าสุด โปรดดูที่ [MCP Specification](https://spec.modelcontextprotocol.io/) และ [MCP GitHub repository](https://github.com/modelcontextprotocol) อย่างเป็นทางการ

### การระบุปัญหา
ข้อกำหนด MCP ดั้งเดิมถือว่าผู้พัฒนาจะเขียนเซิร์ฟเวอร์การตรวจสอบสิทธิ์ของตนเอง สิ่งนี้ต้องการความรู้เกี่ยวกับ OAuth และข้อจำกัดด้านความปลอดภัยที่เกี่ยวข้อง เซิร์ฟเวอร์ MCP ทำหน้าที่เป็นเซิร์ฟเวอร์การอนุญาต OAuth 2.0 จัดการการตรวจสอบสิทธิ์ของผู้ใช้ที่จำเป็นโดยตรงแทนที่จะมอบหมายให้บริการภายนอกเช่น Microsoft Entra ID ตั้งแต่วันที่ 26 เมษายน 2025 การอัปเดตข้อกำหนด MCP อนุญาตให้เซิร์ฟเวอร์ MCP มอบหมายการตรวจสอบสิทธิ์ของผู้ใช้ให้กับบริการภายนอก

### ความเสี่ยง
- ตรรกะการอนุญาตที่กำหนดค่าไม่ถูกต้องในเซิร์ฟเวอร์ MCP อาจนำไปสู่การเปิดเผยข้อมูลที่ละเอียดอ่อนและการควบคุมการเข้าถึงที่ใช้ไม่ถูกต้อง
- การขโมยโทเค็น OAuth บนเซิร์ฟเวอร์ MCP ในพื้นที่ หากถูกขโมย โทเค็นสามารถใช้เพื่อปลอมแปลงเซิร์ฟเวอร์ MCP และเข้าถึงทรัพยากรและข้อมูลจากบริการที่โทเค็น OAuth นั้นมีไว้สำหรับ

### การควบคุมการลดความเสี่ยง
- **ตรวจสอบและทำให้ตรรกะการอนุญาตแข็งแกร่งขึ้น:** ตรวจสอบการใช้งานการอนุญาตของเซิร์ฟเวอร์ MCP ของคุณอย่างละเอียดเพื่อให้แน่ใจว่ามีเพียงผู้ใช้และลูกค้าที่ตั้งใจเท่านั้นที่สามารถเข้าถึงทรัพยากรที่ละเอียดอ่อนได้ สำหรับคำแนะนำที่เป็นประโยชน์ โปรดดู [Azure API Management Your Auth Gateway For MCP Servers | Microsoft Community Hub](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) และ [Using Microsoft Entra ID To Authenticate With MCP Servers Via Sessions - Den Delimarsky](https://den.dev/blog/mcp-server-auth-entra-id-session/)
- **บังคับใช้แนวปฏิบัติการใช้โทเค็นอย่างปลอดภัย:** ปฏิบัติตาม [แนวปฏิบัติที่ดีที่สุดของ Microsoft สำหรับการตรวจสอบและอายุการใช้งานโทเค็น](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens) เพื่อป้องกันการใช้โทเค็นการเข้าถึงในทางที่ผิดและลดความเสี่ยงของการเล่นซ้ำหรือการขโมยโทเค็น
- **ปกป้องการจัดเก็บโทเค็น:** เก็บโทเค็นอย่างปลอดภัยเสมอและใช้การเข้ารหัสเพื่อปกป้องโทเค็นทั้งในขณะพักและระหว่างการส่ง สำหรับเคล็ดลับการใช้งาน โปรดดู [ใช้การจัดเก็บโทเค็นอย่างปลอดภัยและเข้ารหัสโทเค็น](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

# สิทธิ์ที่มากเกินไปสำหรับเซิร์ฟเวอร์ MCP

### การระบุปัญหา
เซิร์ฟเวอร์ MCP อาจได้รับสิทธิ์ที่มากเกินไปกับบริการ/ทรัพยากรที่เข้าถึง ตัวอย่างเช่น เซิร์ฟเวอร์ MCP ที่เป็นส่วนหนึ่งของแอปพลิเคชันการขาย AI ที่เชื่อมต่อกับที่เก็บข้อมูลขององค์กรควรมีการเข้าถึงที่กำหนดขอบเขตไว้ที่ข้อมูลการขายและไม่อนุญาตให้เข้าถึงไฟล์ทั้งหมดในที่เก็บข้อมูล โดยอ้างอิงกลับไปยังหลักการของสิทธิ์น้อยที่สุด (หนึ่งในหลักการด้านความปลอดภัยที่เก่าแก่ที่สุด) ไม่มีทรัพยากรใดควรมีสิทธิ์เกินกว่าที่จำเป็นสำหรับการดำเนินงานตามงานที่ตั้งใจไว้ AI นำเสนอความท้าทายที่เพิ่มขึ้นในพื้นที่นี้เพราะเพื่อให้สามารถปรับตัวได้ อาจเป็นเรื่องท้าทายที่จะกำหนดสิทธิ์ที่แน่นอนที่จำเป็น

### ความเสี่ยง
- การให้สิทธิ์ที่มากเกินไปอาจอนุญาตให้มีการดึงข้อมูลหรือแก้ไขข้อมูลที่เซิร์ฟเวอร์ MCP ไม่ได้ตั้งใจให้สามารถเข้าถึงได้ สิ่งนี้อาจเป็นปัญหาความเป็นส่วนตัวหากข้อมูลเป็นข้อมูลที่สามารถระบุตัวบุคคลได้ (PII)

### การควบคุมการลดความเสี่ยง
- **ใช้หลักการของสิทธิ์น้อยที่สุด:** ให้สิทธิ์เซิร์ฟเวอร์ MCP เฉพาะสิทธิ์ขั้นต่ำที่จำเป็นในการดำเนินงานตามงานที่ต้องการ ตรวจสอบและอัปเดตสิทธิ์เหล่านี้อย่างสม่ำเสมอเพื่อให้แน่ใจว่าไม่เกินกว่าที่จำเป็น สำหรับคำแนะนำที่ละเอียด โปรดดู [การเข้าถึงที่ปลอดภัยน้อยที่สุด](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- **ใช้การควบคุมการเข้าถึงตามบทบาท (RBAC):** กำหนดบทบาทให้กับเซิร์ฟเวอร์ MCP ที่มีขอบเขตที่แน่นหนาไปยังทรัพยากรและการกระทำเฉพาะ หลีกเลี่ยงสิทธิ์ที่กว้างหรือไม่จำเป็น
- **ตรวจสอบและตรวจสอบสิทธิ์:** ตรวจสอบการใช้งานสิทธิ์อย่างต่อเนื่องและตรวจสอบบันทึกการเข้าถึงเพื่อค้นหาและแก้ไขสิทธิ์ที่มากเกินไปหรือไม่ได้ใช้ทันที

# การโจมตีการฉีดคำสั่งที่ไม่พึงประสงค์ทางอ้อม

### การระบุปัญหา

เซิร์ฟเวอร์ MCP ที่ถูกโจมตีหรือถูกละเมิดสามารถนำเสนอความเสี่ยงที่สำคัญโดยการเปิดเผยข้อมูลลูกค้าหรือทำให้เกิดการกระทำที่ไม่ตั้งใจ ความเสี่ยงเหล่านี้มีความเกี่ยวข้องเป็นพิเศษในภาระงานที่ใช้ AI และ MCP ซึ่ง:

- **การโจมตีการฉีดคำสั่งที่ไม่พึงประสงค์:** ผู้โจมตีฝังคำสั่งที่เป็นอันตรายในคำสั่งหรือเนื้อหาภายนอก ทำให้ระบบ AI ทำการกระทำที่ไม่ตั้งใจหรือรั่วไหลข้อมูลที่ละเอียดอ่อน เรียนรู้เพิ่มเติม: [การฉีดคำสั่งที่ไม่พึงประสงค์](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- **การปนเปื้อนเครื่องมือ:** ผู้โจมตีปรับแต่งข้อมูลเมตาของเครื่องมือ (เช่น คำอธิบายหรือพารามิเตอร์) เพื่อมีอิทธิพลต่อพฤติกรรมของ AI อาจข้ามการควบคุมความปลอดภัยหรือดึงข้อมูล รายละเอียด: [การปนเปื้อนเครื่องมือ](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- **การฉีดคำสั่งที่ไม่พึงประสงค์ข้ามโดเมน:** คำสั่งที่เป็นอันตรายถูกฝังในเอกสาร หน้าเว็บ หรืออีเมล ซึ่งถูกประมวลผลโดย AI ทำให้เกิดการรั่วไหลหรือการจัดการข้อมูล
- **การปรับเปลี่ยนเครื่องมือแบบไดนามิก (Rug Pulls):** การกำหนดเครื่องมือสามารถเปลี่ยนแปลงหลังจากการอนุมัติของผู้ใช้ ทำให้เกิดพฤติกรรมที่เป็นอันตรายใหม่โดยที่ผู้ใช้ไม่รู้ตัว

ช่องโหว่เหล่านี้เน้นถึงความจำเป็นในการตรวจสอบที่แข็งแกร่ง การตรวจสอบ และการควบคุมความปลอดภัยเมื่อรวมเซิร์ฟเวอร์และเครื่องมือ MCP เข้ากับสภาพแวดล้อมของคุณ สำหรับการศึกษาเชิงลึกเพิ่มเติม โปรดดูการอ้างอิงที่ลิงก์ไว้ด้านบน

![prompt-injection-lg-2048x1034](../../../translated_images/prompt-injection.4b2f1af239a32d46221a75c7bc5b6f392ebbacc47eccde241d4c60507232fa43.th.png)

**การฉีดคำสั่งที่ไม่พึงประสงค์ทางอ้อม** (หรือที่รู้จักกันในชื่อการฉีดคำสั่งที่ไม่พึงประสงค์ข้ามโดเมนหรือ XPIA) เป็นช่องโหว่ที่สำคัญในระบบ AI เชิงสร้างสรรค์ รวมถึงระบบที่ใช้ Model Context Protocol (MCP) ในการโจมตีนี้ คำสั่งที่เป็นอันตรายถูกซ่อนอยู่ในเนื้อหาภายนอก เช่น เอกสาร หน้าเว็บ หรืออีเมล เมื่อระบบ AI ประมวลผลเนื้อหานี้ อาจตีความคำสั่งที่ฝังไว้เป็นคำสั่งผู้ใช้ที่ถูกต้อง ส่งผลให้เกิดการกระทำที่ไม่ตั้งใจ เช่น การรั่วไหลของข้อมูล การสร้างเนื้อหาที่เป็นอันตราย หรือการจัดการปฏิสัมพันธ์ของผู้ใช้ สำหรับคำอธิบายโดยละเอียดและตัวอย่างในโลกจริง โปรดดู [การฉีดคำสั่งที่ไม่พึงประสงค์](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)

รูปแบบที่อันตรายโดยเฉพาะของการโจมตีนี้คือ **การปนเปื้อนเครื่องมือ** ที่นี่ ผู้โจมตีฉีดคำสั่งที่เป็นอันตรายลงในข้อมูลเมตาของเครื่องมือ MCP (เช่น คำอธิบายเครื่องมือหรือพารามิเตอร์) เนื่องจากโมเดลภาษาขนาดใหญ่ (LLMs) พึ่งพาข้อมูลเมตานี้ในการตัดสินใจว่าจะเรียกใช้เครื่องมือใด คำอธิบายที่ถูกโจมตีสามารถหลอกโมเดลให้ดำเนินการเรียกใช้เครื่องมือที่ไม่ได้รับอนุญาตหรือข้ามการควบคุมความปลอดภัย การปรับเปลี่ยนเหล่านี้มักจะมองไม่เห็นสำหรับผู้ใช้ปลายทาง แต่สามารถตีความและดำเนินการโดยระบบ AI ความเสี่ยงนี้มีความสูงในสภาพแวดล้อมเซิร์ฟเวอร์ MCP ที่โฮสต์ ซึ่งการกำหนดเครื่องมือสามารถอัปเดตได้หลังจากการอนุมัติของผู้ใช้ — สถานการณ์ที่บางครั้งเรียกว่า "[rug pull](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)" ในกรณีดังกล่าว เครื่องมือที่เคยปลอดภัยอาจถูกปรับเปลี่ยนให้ทำการกระทำที่เป็นอันตราย เช่น การดึงข้อมูลหรือการเปลี่ยนแปลงพฤติกรรมของระบบ โดยที่ผู้ใช้ไม่รู้ตัว สำหรับข้อมูลเพิ่มเติมเกี่ยวกับเวกเตอร์การโจมตีนี้ โปรดดู [การปนเปื้อนเครื่องมือ](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)

![tool-injection-lg-2048x1239 (1)](../../../translated_images/tool-injection.d4607023f69e16157954001ad81afd763676361f03db0a1cf24ec696b2ddcb88.th.png)

## ความเสี่ยง
การกระทำที่ไม่ตั้งใจของ AI นำเสนอความเสี่ยงด้านความปลอดภัยที่หลากหลาย ซึ่งรวมถึงการรั่วไหลของข้อมูลและการละเมิดความเป็นส่วนตัว

### การควบคุมการลดความเสี่ยง
### การใช้ prompt shields เพื่อป้องกันการโจมตีการฉีดคำสั่งที่ไม่พึงประสงค์ทางอ้อม
-----------------------------------------------------------------------------

**AI Prompt Shields** เป็นโซลูชันที่พัฒนาโดย Microsoft เพื่อป้องกันการโจมตีการฉีดคำสั่งที่ไม่พึงประสงค์ทั้งทางตรงและทางอ้อม พวกเขาช่วยผ่าน:

1.  **การตรวจจับและการกรอง:** Prompt Shields ใช้อัลกอริทึมการเรียนรู้ของเครื่องขั้นสูงและการประมวลผลภาษาธรรมชาติเพื่อตรวจจับและกรองคำสั่งที่เป็นอันตรายที่ฝังอยู่ในเนื้อหาภายนอก เช่น เอกสาร หน้าเว็บ หรืออีเมล
    
2.  **Spotlighting:** เทคนิคนี้ช่วยให้ระบบ AI แยกแยะระหว่างคำสั่งของระบบที่ถูกต้องและอินพุตภายนอกที่อาจไม่น
- [OWASP Top 10 สำหรับ LLMs](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [GitHub Advanced Security](https://github.com/security/advanced-security)
- [Azure DevOps](https://azure.microsoft.com/products/devops)
- [Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [การเดินทางเพื่อความปลอดภัยของซัพพลายเชนซอฟต์แวร์ที่ Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)
- [การเข้าถึงสิทธิ์น้อยที่สุดอย่างปลอดภัย (Microsoft)](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [แนวปฏิบัติที่ดีที่สุดสำหรับการตรวจสอบและอายุการใช้งานของโทเค็น](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [ใช้การเก็บโทเค็นอย่างปลอดภัยและเข้ารหัสโทเค็น (YouTube)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)
- [Azure API Management เป็นเกตเวย์การรับรองความถูกต้องสำหรับ MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [การใช้ Microsoft Entra ID เพื่อรับรองความถูกต้องกับเซิร์ฟเวอร์ MCP](https://den.dev/blog/mcp-server-auth-entra-id-session/)

### ถัดไป

ถัดไป: [บทที่ 3: เริ่มต้น](/03-GettingStarted/README.md)

**คำเตือน**: เอกสารนี้ได้รับการแปลโดยใช้บริการแปลภาษาด้วย AI [Co-op Translator](https://github.com/Azure/co-op-translator) แม้ว่าเราจะพยายามให้มีความถูกต้อง แต่โปรดทราบว่าการแปลโดยอัตโนมัติอาจมีข้อผิดพลาดหรือความไม่ถูกต้อง เอกสารต้นฉบับในภาษาที่เป็นต้นฉบับควรถูกพิจารณาว่าเป็นแหล่งข้อมูลที่เชื่อถือได้ สำหรับข้อมูลสำคัญ แนะนำให้ใช้บริการแปลภาษามนุษย์ที่มีความเชี่ยวชาญ เราไม่รับผิดชอบต่อความเข้าใจผิดหรือการตีความที่ผิดพลาดอันเกิดจากการใช้การแปลนี้
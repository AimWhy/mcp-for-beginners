<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8248e3491f5245ee6ab48ef724a4f65a",
  "translation_date": "2025-07-13T21:25:24+00:00",
  "source_file": "03-GettingStarted/07-aitk/README.md",
  "language_code": "ar"
}
-->
# استهلاك خادم من امتداد AI Toolkit لبرنامج Visual Studio Code

عند بناء وكيل ذكاء اصطناعي، الأمر لا يقتصر فقط على توليد ردود ذكية؛ بل يتعلق أيضًا بتمكين وكيلك من اتخاذ إجراءات. هنا يأتي دور بروتوكول سياق النموذج (MCP). يجعل MCP من السهل على الوكلاء الوصول إلى الأدوات والخدمات الخارجية بطريقة موحدة. فكر فيه كأنك توصل وكيلك إلى صندوق أدوات يمكنه *فعلاً* استخدامه.

لنفترض أنك ربطت وكيلًا بخادم MCP للحاسبة. فجأة، يمكن لوكيلك إجراء العمليات الحسابية بمجرد استلامه طلبًا مثل "كم يساوي 47 في 89؟" — دون الحاجة لكتابة منطق مبرمج أو بناء واجهات برمجة تطبيقات مخصصة.

## نظرة عامة

تغطي هذه الدرس كيفية ربط خادم MCP للحاسبة بوكيل باستخدام امتداد [AI Toolkit](https://aka.ms/AIToolkit) في Visual Studio Code، مما يمكّن وكيلك من إجراء عمليات حسابية مثل الجمع والطرح والضرب والقسمة عبر اللغة الطبيعية.

AI Toolkit هو امتداد قوي لـ Visual Studio Code يبسط تطوير الوكلاء. يمكن لمهندسي الذكاء الاصطناعي بناء تطبيقات ذكاء اصطناعي بسهولة من خلال تطوير واختبار نماذج الذكاء الاصطناعي التوليدية — محليًا أو في السحابة. يدعم الامتداد معظم النماذج التوليدية الرئيسية المتاحة اليوم.

*ملاحظة*: يدعم AI Toolkit حاليًا Python وTypeScript.

## أهداف التعلم

بنهاية هذا الدرس، ستكون قادرًا على:

- استهلاك خادم MCP عبر AI Toolkit.
- تكوين إعدادات الوكيل لتمكينه من اكتشاف واستخدام الأدوات التي يوفرها خادم MCP.
- استخدام أدوات MCP عبر اللغة الطبيعية.

## النهج

إليك كيف نحتاج إلى التعامل مع هذا على مستوى عالٍ:

- إنشاء وكيل وتحديد موجه النظام الخاص به.
- إنشاء خادم MCP مزود بأدوات الحاسبة.
- ربط منشئ الوكيل بخادم MCP.
- اختبار استدعاء أدوات الوكيل عبر اللغة الطبيعية.

رائع، الآن بعد أن فهمنا التسلسل، دعنا نكوّن وكيل ذكاء اصطناعي ليستفيد من الأدوات الخارجية عبر MCP، مما يعزز قدراته!

## المتطلبات الأساسية

- [Visual Studio Code](https://code.visualstudio.com/)
- [AI Toolkit لـ Visual Studio Code](https://aka.ms/AIToolkit)

## التمرين: استهلاك خادم

في هذا التمرين، ستقوم ببناء وتشغيل وتحسين وكيل ذكاء اصطناعي باستخدام أدوات من خادم MCP داخل Visual Studio Code باستخدام AI Toolkit.

### -0- خطوة تمهيدية، أضف نموذج OpenAI GPT-4o إلى نماذجي

يعتمد التمرين على نموذج **GPT-4o**. يجب إضافة النموذج إلى **نماذجي** قبل إنشاء الوكيل.

![لقطة شاشة لواجهة اختيار نموذج في امتداد AI Toolkit لـ Visual Studio Code. العنوان يقول "ابحث عن النموذج المناسب لحل الذكاء الاصطناعي الخاص بك" مع نص فرعي يشجع المستخدمين على اكتشاف واختبار ونشر نماذج الذكاء الاصطناعي. تحت "النماذج الشائعة"، تظهر ست بطاقات نماذج: DeepSeek-R1 (مستضاف على GitHub)، OpenAI GPT-4o، OpenAI GPT-4.1، OpenAI o1، Phi 4 Mini (CPU - صغير، سريع)، وDeepSeek-R1 (مستضاف على Ollama). كل بطاقة تتضمن خيارات "إضافة" النموذج أو "تجربة في الملعب"](../../../../translated_images/aitk-model-catalog.2acd38953bb9c119aa629fe74ef34cc56e4eed35e7f5acba7cd0a59e614ab335.ar.png)

1. افتح امتداد **AI Toolkit** من **شريط النشاط**.
1. في قسم **الكتالوج**، اختر **النماذج** لفتح **كتالوج النماذج**. اختيار **النماذج** يفتح **كتالوج النماذج** في تبويب محرر جديد.
1. في شريط البحث في **كتالوج النماذج**، اكتب **OpenAI GPT-4o**.
1. اضغط على **+ إضافة** لإضافة النموذج إلى قائمة **نماذجي**. تأكد من اختيار النموذج الذي **يستضيفه GitHub**.
1. في **شريط النشاط**، تحقق من ظهور نموذج **OpenAI GPT-4o** في القائمة.

### -1- إنشاء وكيل

يتيح لك **منشئ الوكيل (الموجه)** إنشاء وتخصيص وكلاء مدعومين بالذكاء الاصطناعي. في هذا القسم، ستنشئ وكيلًا جديدًا وتعيّن نموذجًا لتشغيل المحادثة.

![لقطة شاشة لواجهة "منشئ وكيل الحاسبة" في امتداد AI Toolkit لـ Visual Studio Code. في اللوحة اليسرى، النموذج المختار هو "OpenAI GPT-4o (عبر GitHub)." موجه النظام يقول "أنت أستاذ في الجامعة تدرس الرياضيات"، وموجه المستخدم يقول "اشرح لي معادلة فورييه بطريقة بسيطة." خيارات إضافية تشمل أزرار لإضافة أدوات، تفعيل خادم MCP، واختيار إخراج منظم. زر أزرق "تشغيل" في الأسفل. في اللوحة اليمنى، تحت "ابدأ بالأمثلة"، هناك ثلاثة وكلاء نموذج: مطور ويب (مع خادم MCP، مبسط الصف الثاني، ومفسر الأحلام، مع وصف مختصر لوظائفهم).](../../../../translated_images/aitk-agent-builder.901e3a2960c3e4774b29a23024ff5bec2d4232f57fae2a418b2aaae80f81c05f.ar.png)

1. افتح امتداد **AI Toolkit** من **شريط النشاط**.
1. في قسم **الأدوات**، اختر **منشئ الوكيل (الموجه)**. اختيار **منشئ الوكيل (الموجه)** يفتح المنشئ في تبويب محرر جديد.
1. اضغط على زر **+ وكيل جديد**. سيطلق الامتداد معالج إعداد عبر **لوحة الأوامر**.
1. أدخل الاسم **وكيل الحاسبة** واضغط **Enter**.
1. في **منشئ الوكيل (الموجه)**، في حقل **النموذج**، اختر نموذج **OpenAI GPT-4o (عبر GitHub)**.

### -2- إنشاء موجه نظام للوكيل

بعد إنشاء هيكل الوكيل، حان الوقت لتعريف شخصيته وغرضه. في هذا القسم، ستستخدم ميزة **توليد موجه النظام** لوصف سلوك الوكيل المقصود — في هذه الحالة، وكيل حاسبة — وجعل النموذج يكتب موجه النظام نيابة عنك.

![لقطة شاشة لواجهة "وكيل الحاسبة" في AI Toolkit مع نافذة منبثقة بعنوان "توليد موجه." تشرح النافذة أنه يمكن توليد قالب موجه بمشاركة تفاصيل أساسية، وتتضمن مربع نص مع موجه نظام نموذجي: "أنت مساعد رياضيات مفيد وفعال. عند إعطائك مسألة تتعلق بالحساب الأساسي، ترد بالنتيجة الصحيحة." أسفل مربع النص أزرار "إغلاق" و"توليد". في الخلفية، جزء من إعدادات الوكيل مرئي، بما في ذلك النموذج المختار "OpenAI GPT-4o (عبر GitHub)" وحقول موجه النظام والمستخدم.](../../../../translated_images/aitk-generate-prompt.ba9e69d3d2bbe2a26444d0c78775540b14196061eee32c2054e9ee68c4f51f3a.ar.png)

1. في قسم **الموجهات**، اضغط على زر **توليد موجه النظام**. يفتح هذا الزر منشئ الموجه الذي يستخدم الذكاء الاصطناعي لتوليد موجه نظام للوكيل.
1. في نافذة **توليد موجه**، أدخل النص التالي: `أنت مساعد رياضيات مفيد وفعال. عند إعطائك مسألة تتعلق بالحساب الأساسي، ترد بالنتيجة الصحيحة.`
1. اضغط على زر **توليد**. ستظهر إشعار في الزاوية اليمنى السفلى يؤكد أن موجه النظام قيد التوليد. بمجرد الانتهاء، سيظهر الموجه في حقل **موجه النظام** في **منشئ الوكيل (الموجه)**.
1. راجع **موجه النظام** وعدّله إذا لزم الأمر.

### -3- إنشاء خادم MCP

الآن بعد أن عرّفت موجه نظام الوكيل — الذي يوجه سلوكه وردوده — حان الوقت لتزويد الوكيل بقدرات عملية. في هذا القسم، ستنشئ خادم MCP للحاسبة مزودًا بأدوات لتنفيذ عمليات الجمع والطرح والضرب والقسمة. سيمكن هذا الخادم وكيلك من إجراء العمليات الحسابية في الوقت الحقيقي استجابةً لموجهات اللغة الطبيعية.

![لقطة شاشة للجزء السفلي من واجهة وكيل الحاسبة في امتداد AI Toolkit لـ Visual Studio Code. تظهر قوائم قابلة للتوسيع لـ "الأدوات" و"الإخراج المنظم"، مع قائمة منسدلة بعنوان "اختر تنسيق الإخراج" مضبوطة على "نص". إلى اليمين، يوجد زر بعنوان "+ خادم MCP" لإضافة خادم بروتوكول سياق النموذج. يظهر رمز صورة كعنصر نائب فوق قسم الأدوات.](../../../../translated_images/aitk-add-mcp-server.9742cfddfe808353c0caf9cc0a7ed3e80e13abf4d2ebde315c81c3cb02a2a449.ar.png)

AI Toolkit مزود بقوالب لتسهيل إنشاء خادم MCP خاص بك. سنستخدم قالب Python لإنشاء خادم MCP للحاسبة.

*ملاحظة*: يدعم AI Toolkit حاليًا Python وTypeScript.

1. في قسم **الأدوات** في **منشئ الوكيل (الموجه)**، اضغط على زر **+ خادم MCP**. سيطلق الامتداد معالج إعداد عبر **لوحة الأوامر**.
1. اختر **+ إضافة خادم**.
1. اختر **إنشاء خادم MCP جديد**.
1. اختر قالب **python-weather**.
1. اختر **المجلد الافتراضي** لحفظ قالب خادم MCP.
1. أدخل الاسم التالي للخادم: **Calculator**
1. سيفتح نافذة جديدة لـ Visual Studio Code. اختر **نعم، أثق بالمؤلفين**.
1. باستخدام الطرفية (**Terminal** > **New Terminal**)، أنشئ بيئة افتراضية: `python -m venv .venv`
1. باستخدام الطرفية، فعّل البيئة الافتراضية:
    1. ويندوز - `.venv\Scripts\activate`
    1. ماك/لينكس - `source venv/bin/activate`
1. باستخدام الطرفية، ثبّت التبعيات: `pip install -e .[dev]`
1. في عرض **المستكشف** في **شريط النشاط**، وسّع مجلد **src** واختر **server.py** لفتح الملف في المحرر.
1. استبدل الكود في ملف **server.py** بالكود التالي واحفظ:

    ```python
    """
    Sample MCP Calculator Server implementation in Python.

    
    This module demonstrates how to create a simple MCP server with calculator tools
    that can perform basic arithmetic operations (add, subtract, multiply, divide).
    """
    
    from mcp.server.fastmcp import FastMCP
    
    server = FastMCP("calculator")
    
    @server.tool()
    def add(a: float, b: float) -> float:
        """Add two numbers together and return the result."""
        return a + b
    
    @server.tool()
    def subtract(a: float, b: float) -> float:
        """Subtract b from a and return the result."""
        return a - b
    
    @server.tool()
    def multiply(a: float, b: float) -> float:
        """Multiply two numbers together and return the result."""
        return a * b
    
    @server.tool()
    def divide(a: float, b: float) -> float:
        """
        Divide a by b and return the result.
        
        Raises:
            ValueError: If b is zero
        """
        if b == 0:
            raise ValueError("Cannot divide by zero")
        return a / b
    ```

### -4- تشغيل الوكيل مع خادم MCP للحاسبة

الآن بعد أن أصبح لدى وكيلك أدوات، حان الوقت لاستخدامها! في هذا القسم، سترسل موجهات إلى الوكيل لاختبار والتحقق مما إذا كان الوكيل يستخدم الأداة المناسبة من خادم MCP للحاسبة.

![لقطة شاشة لواجهة وكيل الحاسبة في امتداد AI Toolkit لـ Visual Studio Code. في اللوحة اليسرى، تحت "الأدوات"، تم إضافة خادم MCP باسم local-server-calculator_server، ويعرض أربع أدوات متاحة: add، subtract، multiply، وdivide. يظهر شارة تفيد بأن أربع أدوات نشطة. أسفلها قسم "الإخراج المنظم" مطوي وزر أزرق "تشغيل". في اللوحة اليمنى، تحت "استجابة النموذج"، يستدعي الوكيل أدوات الضرب والطرح مع مدخلات {"a": 3, "b": 25} و{"a": 75, "b": 20} على التوالي. تظهر "استجابة الأداة" النهائية كـ 75.0. يظهر زر "عرض الكود" في الأسفل.](../../../../translated_images/aitk-agent-response-with-tools.e7c781869dc8041a25f9903ed4f7e8e0c7e13d7d94f6786a6c51b1e172f56866.ar.png)

ستشغل خادم MCP للحاسبة على جهاز التطوير المحلي الخاص بك عبر **منشئ الوكيل** كعميل MCP.

1. اضغط `F5` لبدء تصحيح خادم MCP. سيفتح **منشئ الوكيل (الموجه)** في تبويب محرر جديد. حالة الخادم مرئية في الطرفية.
1. في حقل **موجه المستخدم** في **منشئ الوكيل (الموجه)**، أدخل الموجه التالي: `اشتريت 3 عناصر بسعر 25 دولارًا لكل منها، ثم استخدمت خصمًا بقيمة 20 دولارًا. كم دفعت؟`
1. اضغط زر **تشغيل** لتوليد رد الوكيل.
1. راجع مخرجات الوكيل. يجب أن يستنتج النموذج أنك دفعت **55 دولارًا**.
1. إليك تفصيل ما يجب أن يحدث:
    - يختار الوكيل أدوات **الضرب** و**الطرح** للمساعدة في الحساب.
    - تُعيّن القيم `a` و`b` المناسبة لأداة **الضرب**.
    - تُعيّن القيم `a` و`b` المناسبة لأداة **الطرح**.
    - يتم تقديم استجابة كل أداة في **استجابة الأداة** الخاصة بها.
    - يتم تقديم الناتج النهائي من النموذج في **استجابة النموذج** النهائية.
1. قدّم موجهات إضافية لاختبار الوكيل أكثر. يمكنك تعديل الموجه الحالي في حقل **موجه المستخدم** بالنقر داخله واستبدال الموجه الموجود.
1. عند الانتهاء من اختبار الوكيل، يمكنك إيقاف الخادم عبر **الطرفية** بالضغط على **CTRL/CMD+C** للخروج.

## المهمة

حاول إضافة أداة إضافية إلى ملف **server.py** الخاص بك (مثلاً: إرجاع الجذر التربيعي لعدد). قدّم موجهات إضافية تتطلب من الوكيل استخدام أداتك الجديدة (أو الأدوات الموجودة). تأكد من إعادة تشغيل الخادم لتحميل الأدوات المضافة حديثًا.

## الحل

[الحل](./solution/README.md)

## النقاط الرئيسية

النقاط المستفادة من هذا الفصل هي:

- امتداد AI Toolkit هو عميل ممتاز يتيح لك استهلاك خوادم MCP وأدواتها.
- يمكنك إضافة أدوات جديدة إلى خوادم MCP، مما يوسع قدرات الوكيل لتلبية المتطلبات المتطورة.
- يتضمن AI Toolkit قوالب (مثل قوالب خادم MCP بلغة Python) لتبسيط إنشاء الأدوات المخصصة.

## موارد إضافية

- [وثائق AI Toolkit](https://aka.ms/AIToolkit/doc)

## ما التالي
- التالي: [الاختبار وتصحيح الأخطاء](../08-testing/README.md)

**إخلاء المسؤولية**:  
تمت ترجمة هذا المستند باستخدام خدمة الترجمة الآلية [Co-op Translator](https://github.com/Azure/co-op-translator). بينما نسعى لتحقيق الدقة، يرجى العلم أن الترجمات الآلية قد تحتوي على أخطاء أو عدم دقة. يجب اعتبار المستند الأصلي بلغته الأصلية المصدر الموثوق به. للمعلومات الهامة، يُنصح بالاعتماد على الترجمة البشرية المهنية. نحن غير مسؤولين عن أي سوء فهم أو تفسير ناتج عن استخدام هذه الترجمة.